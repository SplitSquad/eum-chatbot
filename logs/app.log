2025-04-22 13:22:20.148 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 13:22:20.150 | INFO     | logging:callHandlers:1762 - Started server process [15161]
2025-04-22 13:22:20.150 | INFO     | logging:callHandlers:1762 - Started server process [15161]
2025-04-22 13:22:20.150 | INFO     | logging:callHandlers:1762 - Waiting for application startup.
2025-04-22 13:22:20.150 | INFO     | logging:callHandlers:1762 - Waiting for application startup.
2025-04-22 13:22:20.150 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 13:22:20.150 | INFO     | logging:callHandlers:1762 - Application startup complete.
2025-04-22 13:22:20.151 | INFO     | logging:callHandlers:1762 - Application startup complete.
2025-04-22 13:25:16.983 | INFO     | logging:callHandlers:1762 - Shutting down
2025-04-22 13:25:16.983 | INFO     | logging:callHandlers:1762 - Shutting down
2025-04-22 13:25:17.085 | INFO     | logging:callHandlers:1762 - Waiting for application shutdown.
2025-04-22 13:25:17.085 | INFO     | logging:callHandlers:1762 - Waiting for application shutdown.
2025-04-22 13:25:17.085 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 13:25:17.085 | INFO     | logging:callHandlers:1762 - Application shutdown complete.
2025-04-22 13:25:17.085 | INFO     | logging:callHandlers:1762 - Application shutdown complete.
2025-04-22 13:25:17.085 | INFO     | logging:callHandlers:1762 - Finished server process [15161]
2025-04-22 13:25:17.086 | INFO     | logging:callHandlers:1762 - Finished server process [15161]
2025-04-22 13:25:21.064 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 13:25:21.066 | INFO     | logging:callHandlers:1762 - Started server process [15727]
2025-04-22 13:25:21.066 | INFO     | logging:callHandlers:1762 - Started server process [15727]
2025-04-22 13:25:21.066 | INFO     | logging:callHandlers:1762 - Waiting for application startup.
2025-04-22 13:25:21.066 | INFO     | logging:callHandlers:1762 - Waiting for application startup.
2025-04-22 13:25:21.066 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 13:25:21.066 | INFO     | logging:callHandlers:1762 - Application startup complete.
2025-04-22 13:25:21.066 | INFO     | logging:callHandlers:1762 - Application startup complete.
2025-04-22 13:25:40.878 | INFO     | logging:callHandlers:1762 - Shutting down
2025-04-22 13:25:40.879 | INFO     | logging:callHandlers:1762 - Shutting down
2025-04-22 13:25:40.980 | INFO     | logging:callHandlers:1762 - Waiting for application shutdown.
2025-04-22 13:25:40.982 | INFO     | logging:callHandlers:1762 - Waiting for application shutdown.
2025-04-22 13:25:40.982 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 13:25:40.983 | INFO     | logging:callHandlers:1762 - Application shutdown complete.
2025-04-22 13:25:40.983 | INFO     | logging:callHandlers:1762 - Application shutdown complete.
2025-04-22 13:25:40.983 | INFO     | logging:callHandlers:1762 - Finished server process [15727]
2025-04-22 13:25:40.984 | INFO     | logging:callHandlers:1762 - Finished server process [15727]
2025-04-22 13:25:42.936 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 13:25:42.938 | INFO     | logging:callHandlers:1762 - Started server process [15802]
2025-04-22 13:25:42.938 | INFO     | logging:callHandlers:1762 - Started server process [15802]
2025-04-22 13:25:42.938 | INFO     | logging:callHandlers:1762 - Waiting for application startup.
2025-04-22 13:25:42.938 | INFO     | logging:callHandlers:1762 - Waiting for application startup.
2025-04-22 13:25:42.938 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 13:25:42.938 | INFO     | logging:callHandlers:1762 - Application startup complete.
2025-04-22 13:25:42.938 | INFO     | logging:callHandlers:1762 - Application startup complete.
2025-04-22 13:25:44.452 | INFO     | logging:callHandlers:1762 - Shutting down
2025-04-22 13:25:44.453 | INFO     | logging:callHandlers:1762 - Shutting down
2025-04-22 13:25:44.554 | INFO     | logging:callHandlers:1762 - Waiting for application shutdown.
2025-04-22 13:25:44.554 | INFO     | logging:callHandlers:1762 - Waiting for application shutdown.
2025-04-22 13:25:44.554 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 13:25:44.554 | INFO     | logging:callHandlers:1762 - Application shutdown complete.
2025-04-22 13:25:44.554 | INFO     | logging:callHandlers:1762 - Application shutdown complete.
2025-04-22 13:25:44.554 | INFO     | logging:callHandlers:1762 - Finished server process [15802]
2025-04-22 13:25:44.554 | INFO     | logging:callHandlers:1762 - Finished server process [15802]
2025-04-22 13:25:46.467 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 13:25:46.468 | INFO     | logging:callHandlers:1762 - Started server process [15820]
2025-04-22 13:25:46.468 | INFO     | logging:callHandlers:1762 - Started server process [15820]
2025-04-22 13:25:46.469 | INFO     | logging:callHandlers:1762 - Waiting for application startup.
2025-04-22 13:25:46.469 | INFO     | logging:callHandlers:1762 - Waiting for application startup.
2025-04-22 13:25:46.469 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 13:25:46.469 | INFO     | logging:callHandlers:1762 - Application startup complete.
2025-04-22 13:25:46.469 | INFO     | logging:callHandlers:1762 - Application startup complete.
2025-04-22 13:26:01.421 | INFO     | logging:callHandlers:1762 - Shutting down
2025-04-22 13:26:01.422 | INFO     | logging:callHandlers:1762 - Shutting down
2025-04-22 13:26:01.523 | INFO     | logging:callHandlers:1762 - Waiting for application shutdown.
2025-04-22 13:26:01.523 | INFO     | logging:callHandlers:1762 - Waiting for application shutdown.
2025-04-22 13:26:01.523 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 13:26:01.523 | INFO     | logging:callHandlers:1762 - Application shutdown complete.
2025-04-22 13:26:01.523 | INFO     | logging:callHandlers:1762 - Application shutdown complete.
2025-04-22 13:26:01.523 | INFO     | logging:callHandlers:1762 - Finished server process [15820]
2025-04-22 13:26:01.524 | INFO     | logging:callHandlers:1762 - Finished server process [15820]
2025-04-22 13:26:03.478 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 13:26:03.480 | INFO     | logging:callHandlers:1762 - Started server process [15877]
2025-04-22 13:26:03.480 | INFO     | logging:callHandlers:1762 - Started server process [15877]
2025-04-22 13:26:03.480 | INFO     | logging:callHandlers:1762 - Waiting for application startup.
2025-04-22 13:26:03.480 | INFO     | logging:callHandlers:1762 - Waiting for application startup.
2025-04-22 13:26:03.480 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 13:26:03.480 | INFO     | logging:callHandlers:1762 - Application startup complete.
2025-04-22 13:26:03.480 | INFO     | logging:callHandlers:1762 - Application startup complete.
2025-04-22 13:26:24.086 | INFO     | logging:callHandlers:1762 - Shutting down
2025-04-22 13:26:24.087 | INFO     | logging:callHandlers:1762 - Shutting down
2025-04-22 13:26:24.188 | INFO     | logging:callHandlers:1762 - Waiting for application shutdown.
2025-04-22 13:26:24.188 | INFO     | logging:callHandlers:1762 - Waiting for application shutdown.
2025-04-22 13:26:24.188 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 13:26:24.189 | INFO     | logging:callHandlers:1762 - Application shutdown complete.
2025-04-22 13:26:24.189 | INFO     | logging:callHandlers:1762 - Application shutdown complete.
2025-04-22 13:26:24.189 | INFO     | logging:callHandlers:1762 - Finished server process [15877]
2025-04-22 13:26:24.189 | INFO     | logging:callHandlers:1762 - Finished server process [15877]
2025-04-22 13:26:26.138 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 13:26:26.139 | INFO     | logging:callHandlers:1762 - Started server process [15959]
2025-04-22 13:26:26.139 | INFO     | logging:callHandlers:1762 - Started server process [15959]
2025-04-22 13:26:26.139 | INFO     | logging:callHandlers:1762 - Waiting for application startup.
2025-04-22 13:26:26.139 | INFO     | logging:callHandlers:1762 - Waiting for application startup.
2025-04-22 13:26:26.140 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 13:26:26.140 | INFO     | logging:callHandlers:1762 - Application startup complete.
2025-04-22 13:26:26.140 | INFO     | logging:callHandlers:1762 - Application startup complete.
2025-04-22 13:27:13.531 | INFO     | logging:callHandlers:1762 - Shutting down
2025-04-22 13:27:13.532 | INFO     | logging:callHandlers:1762 - Shutting down
2025-04-22 13:27:13.632 | INFO     | logging:callHandlers:1762 - Waiting for application shutdown.
2025-04-22 13:27:13.632 | INFO     | logging:callHandlers:1762 - Waiting for application shutdown.
2025-04-22 13:27:13.633 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 13:27:13.633 | INFO     | logging:callHandlers:1762 - Application shutdown complete.
2025-04-22 13:27:13.633 | INFO     | logging:callHandlers:1762 - Application shutdown complete.
2025-04-22 13:27:13.633 | INFO     | logging:callHandlers:1762 - Finished server process [15959]
2025-04-22 13:27:13.633 | INFO     | logging:callHandlers:1762 - Finished server process [15959]
2025-04-22 13:27:15.808 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 13:27:15.810 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 13:27:57.545 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 13:27:59.461 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 13:27:59.463 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 13:28:37.053 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 13:28:39.275 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 13:28:39.276 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 13:29:15.854 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 13:29:18.018 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 13:29:18.019 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 13:31:24.647 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 13:31:26.933 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 13:31:26.935 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 13:31:49.935 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 13:31:49.937 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 13:31:50.457 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: llama3:8b
2025-04-22 13:31:50.457 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:31:50.469 | DEBUG    | logging:callHandlers:1762 - Starting new HTTPS connection (1): huggingface.co:443
2025-04-22 13:31:51.026 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:31:51.225 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 13:31:51.422 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 13:31:51.629 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:31:51.958 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 13:31:52.169 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 13:31:53.811 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 13:31:54.495 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6096
2025-04-22 13:31:54.532 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 13:31:54.852 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:31:54.868 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 13:31:54.935 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 13:31:54.935 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 13:31:54.935 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 13:31:54.935 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 13:31:54.935 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 13:31:54.937 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 13:31:54.938 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 13:31:54.938 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 13:31:54.942 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 13:31:54.943 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 13:31:54.943 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 13:31:54.943 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 13:31:54.944 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 13:31:54.944 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 13:31:54.944 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 13:31:54.945 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 13:31:54.945 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 13:31:54.945 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 13:31:54.946 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 13:31:54.947 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 13:31:54.947 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 13:31:54.947 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 13:31:54.947 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 13:31:54.947 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 13:31:54.947 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 13:31:54.948 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 13:31:54.948 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 13:31:54.949 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 13:31:54.949 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 13:31:54.950 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 13:31:54.951 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 13:31:54.951 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 13:31:54.951 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 13:31:54.951 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 13:31:54.951 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 13:31:54.952 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 13:31:54.952 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 13:31:54.952 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 13:31:54.952 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 13:31:54.953 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 13:31:54.954 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 13:31:54.954 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 13:31:54.954 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 13:31:54.954 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 13:31:54.954 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 13:31:54.955 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 13:31:54.955 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 13:31:54.955 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 13:31:54.956 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 13:31:54.957 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 13:31:54.957 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 13:31:54.957 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 13:31:54.957 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 13:31:54.957 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 13:31:54.957 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 13:31:54.958 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 13:31:54.958 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 13:31:54.958 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 13:31:54.959 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 13:31:54.959 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:12b
2025-04-22 13:31:54.959 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 13:31:54.959 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: llama3:8b
2025-04-22 13:31:54.959 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 13:31:54.959 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 13:31:54.959 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:31:54.959 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:31:54.959 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 13:31:54.960 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:31:54.961 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:31:54.970 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:31:54.972 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3392d67e0>
2025-04-22 13:31:54.972 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:31:54.972 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:31:54.972 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:31:54.972 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:31:54.972 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:31:54.976 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:31:54 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:31:54.976 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:31:54.976 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:31:54.976 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:31:54.976 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:31:54.977 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:31:54.977 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.01초
2025-04-22 13:31:54.977 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:31:54.977 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:31:54.977 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.02초)
2025-04-22 13:31:54.977 | ERROR    | app.services.chatbot.chatbot_classifier:_classify_rag_type:93 - RAG 유형 분류 중 오류 발생: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:31:54.977 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: none
2025-04-22 13:31:54.977 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: none
2025-04-22 13:31:54.977 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: none
2025-04-22 13:31:54.977 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 13:31:54.977 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:31:54.977 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 13:31:54.977 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: llama3:8b
2025-04-22 13:31:54.977 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:31:54.978 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:31:54.983 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:31:54.987 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318b9ee40>
2025-04-22 13:31:54.987 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 13:31:54.988 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:31:54.988 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 13:31:54.988 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:31:54.988 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 13:31:54.991 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:31:54 GMT'), (b'Content-Length', b'2028')])
2025-04-22 13:31:54.991 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 13:31:54.991 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 13:31:54.991 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:31:54.992 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:31:54.992 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:31:54.992 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.01초
2025-04-22 13:31:54.992 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:31:54.992 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:31:54.992 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.01 seconds
2025-04-22 13:31:54.992 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:31:54.992 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:31:54.997 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:31:55.000 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16c8316d0>
2025-04-22 13:31:55.000 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:31:55.000 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:31:55.000 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:31:55.000 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:31:55.000 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:31:55.002 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:31:55 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:31:55.002 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:31:55.002 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:31:55.002 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:31:55.002 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:31:55.002 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:31:55.002 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.01초
2025-04-22 13:31:55.002 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:31:55.002 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:31:55.002 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.01초)
2025-04-22 13:31:55.003 | ERROR    | app.services.common.preprocessor:translate_query:91 - [Preprocess] Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (Time elapsed: 0.03 seconds)
2025-04-22 13:31:55.003 | ERROR    | app.services.chatbot.chatbot:get_response:65 - 응답 생성 중 오류 발생: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:31:55.003 | ERROR    | app.services.chatbot.chatbot:get_response:66 - [WORKFLOW] ====== Error in chatbot workflow: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 ======
2025-04-22 13:31:55.445 | DEBUG    | logging:callHandlers:1762 - Starting new HTTPS connection (1): us.i.posthog.com:443
2025-04-22 13:31:56.077 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 13:36:26.360 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: llama3:8b
2025-04-22 13:36:26.363 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:36:26.365 | DEBUG    | logging:callHandlers:1762 - Resetting dropped connection: huggingface.co
2025-04-22 13:36:26.645 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:36:26.854 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 13:36:27.377 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 13:36:27.586 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:36:27.991 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 13:36:28.194 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 13:36:28.920 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 13:36:29.634 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6096
2025-04-22 13:36:29.639 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 13:36:30.165 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:36:30.168 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 13:36:30.170 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 13:36:30.172 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 13:36:30.174 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 13:36:30.176 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 13:36:30.177 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 13:36:30.177 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:12b
2025-04-22 13:36:30.178 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 13:36:30.178 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: llama3:8b
2025-04-22 13:36:30.178 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 13:36:30.178 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 13:36:30.178 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:36:30.178 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:36:30.178 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 13:36:30.178 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:36:30.179 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:36:30.185 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:36:30.186 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16b4f93d0>
2025-04-22 13:36:30.186 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:36:30.186 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:36:30.186 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:36:30.186 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:36:30.186 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:36:30.191 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:36:30 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:36:30.191 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:36:30.191 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:36:30.192 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:36:30.192 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:36:30.192 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:36:30.192 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.01초
2025-04-22 13:36:30.192 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:36:30.192 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:36:30.192 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.01초)
2025-04-22 13:36:30.192 | ERROR    | app.services.chatbot.chatbot_classifier:_classify_rag_type:93 - RAG 유형 분류 중 오류 발생: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:36:30.192 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: none
2025-04-22 13:36:30.192 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: none
2025-04-22 13:36:30.192 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: none
2025-04-22 13:36:30.192 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 13:36:30.192 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:36:30.193 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 13:36:30.193 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: llama3:8b
2025-04-22 13:36:30.193 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:36:30.193 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:36:30.198 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:36:30.200 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16a951d90>
2025-04-22 13:36:30.200 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 13:36:30.200 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:36:30.200 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 13:36:30.200 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:36:30.200 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 13:36:30.203 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:36:30 GMT'), (b'Content-Length', b'2028')])
2025-04-22 13:36:30.203 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 13:36:30.203 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 13:36:30.203 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:36:30.204 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:36:30.204 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:36:30.204 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.01초
2025-04-22 13:36:30.204 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:36:30.204 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:36:30.204 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.01 seconds
2025-04-22 13:36:30.204 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:36:30.204 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:36:30.209 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:36:30.210 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3167d7920>
2025-04-22 13:36:30.210 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:36:30.210 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:36:30.210 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:36:30.210 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:36:30.210 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:36:30.212 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:36:30 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:36:30.212 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:36:30.212 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:36:30.212 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:36:30.212 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:36:30.212 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:36:30.212 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.00초
2025-04-22 13:36:30.212 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:36:30.212 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:36:30.212 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.01초)
2025-04-22 13:36:30.212 | ERROR    | app.services.common.preprocessor:translate_query:91 - [Preprocess] Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (Time elapsed: 0.02 seconds)
2025-04-22 13:36:30.212 | ERROR    | app.services.chatbot.chatbot:get_response:65 - 응답 생성 중 오류 발생: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:36:30.212 | ERROR    | app.services.chatbot.chatbot:get_response:66 - [WORKFLOW] ====== Error in chatbot workflow: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 ======
2025-04-22 13:36:30.664 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 13:40:15.020 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: llama3:8b
2025-04-22 13:40:15.025 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:40:15.581 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:40:15.829 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 13:40:16.046 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 13:40:16.273 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:40:16.474 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 13:40:16.675 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 13:40:17.410 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 13:40:18.087 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6096
2025-04-22 13:40:18.091 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 13:40:18.460 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:40:18.467 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 13:40:18.469 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 13:40:18.470 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 13:40:18.472 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 13:40:18.474 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 13:40:18.475 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 13:40:18.476 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:12b
2025-04-22 13:40:18.476 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 13:40:18.476 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: llama3:8b
2025-04-22 13:40:18.476 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 13:40:18.476 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 13:40:18.476 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:40:18.476 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:40:18.476 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 13:40:18.476 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:40:18.477 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:40:18.484 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:40:18.485 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318bd2960>
2025-04-22 13:40:18.485 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:40:18.486 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:40:18.486 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:40:18.486 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:40:18.486 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:40:18.491 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:40:18 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:40:18.491 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:40:18.492 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:40:18.492 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:40:18.492 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:40:18.492 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:40:18.492 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.01초
2025-04-22 13:40:18.492 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:40:18.492 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:40:18.492 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.02초)
2025-04-22 13:40:18.492 | ERROR    | app.services.chatbot.chatbot_classifier:_classify_rag_type:93 - RAG 유형 분류 중 오류 발생: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:40:18.492 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: none
2025-04-22 13:40:18.492 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: none
2025-04-22 13:40:18.492 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: none
2025-04-22 13:40:18.492 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 13:40:18.492 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:40:18.492 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 13:40:18.492 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: llama3:8b
2025-04-22 13:40:18.493 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:40:18.493 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:40:18.498 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:40:18.500 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318b64b60>
2025-04-22 13:40:18.500 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 13:40:18.500 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:40:18.500 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 13:40:18.500 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:40:18.500 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 13:40:18.503 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:40:18 GMT'), (b'Content-Length', b'2028')])
2025-04-22 13:40:18.504 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 13:40:18.504 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 13:40:18.504 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:40:18.504 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:40:18.504 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:40:18.504 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.01초
2025-04-22 13:40:18.504 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:40:18.504 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:40:18.504 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.01 seconds
2025-04-22 13:40:18.504 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:40:18.505 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:40:18.510 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:40:18.510 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318bfa7b0>
2025-04-22 13:40:18.510 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:40:18.511 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:40:18.511 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:40:18.511 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:40:18.511 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:40:18.512 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:40:18 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:40:18.512 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:40:18.512 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:40:18.512 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:40:18.512 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:40:18.512 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:40:18.512 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.00초
2025-04-22 13:40:18.512 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:40:18.513 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:40:18.513 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.01초)
2025-04-22 13:40:18.513 | ERROR    | app.services.common.preprocessor:translate_query:91 - [Preprocess] Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (Time elapsed: 0.02 seconds)
2025-04-22 13:40:18.513 | ERROR    | app.services.chatbot.chatbot:get_response:65 - 응답 생성 중 오류 발생: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:40:18.513 | ERROR    | app.services.chatbot.chatbot:get_response:66 - [WORKFLOW] ====== Error in chatbot workflow: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 ======
2025-04-22 13:40:19.093 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 13:40:47.905 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: llama3:8b
2025-04-22 13:40:47.908 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:40:48.482 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:40:48.739 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 13:40:48.950 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 13:40:49.172 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:40:49.386 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 13:40:49.596 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 13:40:50.326 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 13:40:51.077 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6096
2025-04-22 13:40:51.083 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 13:40:51.554 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:40:51.559 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 13:40:51.561 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 13:40:51.562 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 13:40:51.564 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 13:40:51.565 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 13:40:51.568 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 13:40:51.568 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:12b
2025-04-22 13:40:51.568 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 13:40:51.568 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: llama3:8b
2025-04-22 13:40:51.568 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 13:40:51.568 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 13:40:51.568 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:40:51.569 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:40:51.569 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 13:40:51.569 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:40:51.570 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:40:51.576 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:40:51.579 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x316901bb0>
2025-04-22 13:40:51.579 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:40:51.579 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:40:51.579 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:40:51.579 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:40:51.579 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:40:51.585 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:40:51 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:40:51.585 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:40:51.585 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:40:51.585 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:40:51.585 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:40:51.585 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:40:51.585 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.01초
2025-04-22 13:40:51.585 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:40:51.586 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:40:51.586 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.02초)
2025-04-22 13:40:51.586 | ERROR    | app.services.chatbot.chatbot_classifier:_classify_rag_type:93 - RAG 유형 분류 중 오류 발생: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:40:51.586 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: none
2025-04-22 13:40:51.586 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: none
2025-04-22 13:40:51.586 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: none
2025-04-22 13:40:51.586 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 13:40:51.586 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:40:51.586 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 13:40:51.586 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: llama3:8b
2025-04-22 13:40:51.586 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:40:51.587 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:40:51.592 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:40:51.594 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16b49c290>
2025-04-22 13:40:51.594 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 13:40:51.594 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:40:51.594 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 13:40:51.594 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:40:51.594 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 13:40:51.597 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:40:51 GMT'), (b'Content-Length', b'2028')])
2025-04-22 13:40:51.597 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 13:40:51.597 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 13:40:51.598 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:40:51.598 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:40:51.598 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:40:51.598 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.01초
2025-04-22 13:40:51.598 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:40:51.598 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:40:51.598 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.01 seconds
2025-04-22 13:40:51.598 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:40:51.599 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:40:51.604 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:40:51.604 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318b9dca0>
2025-04-22 13:40:51.604 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:40:51.605 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:40:51.605 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:40:51.605 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:40:51.605 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:40:51.606 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:40:51 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:40:51.606 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:40:51.606 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:40:51.606 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:40:51.606 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:40:51.606 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:40:51.606 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.00초
2025-04-22 13:40:51.606 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:40:51.606 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:40:51.606 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.01초)
2025-04-22 13:40:51.606 | ERROR    | app.services.common.preprocessor:translate_query:91 - [Preprocess] Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (Time elapsed: 0.02 seconds)
2025-04-22 13:40:51.606 | ERROR    | app.services.chatbot.chatbot:get_response:65 - 응답 생성 중 오류 발생: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:40:51.606 | ERROR    | app.services.chatbot.chatbot:get_response:66 - [WORKFLOW] ====== Error in chatbot workflow: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 ======
2025-04-22 13:40:52.009 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 13:41:09.098 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: llama3:8b
2025-04-22 13:41:09.099 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:41:09.541 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:41:09.748 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 13:41:09.960 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 13:41:10.160 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:41:10.523 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 13:41:10.725 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 13:41:11.340 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 13:41:12.025 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 13:41:12.027 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 13:41:12.175 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:41:12.179 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 13:41:12.181 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 13:41:12.183 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 13:41:12.185 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 13:41:12.186 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 13:41:12.188 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 13:41:12.189 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:12b
2025-04-22 13:41:12.189 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 13:41:12.189 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: llama3:8b
2025-04-22 13:41:12.189 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 13:41:12.189 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 13:41:12.189 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:41:12.189 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:41:12.189 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 13:41:12.189 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:41:12.190 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:41:12.196 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:41:12.196 | DEBUG    | logging:callHandlers:1762 - connect_tcp.failed exception=ConnectError(OSError('All connection attempts failed'))
2025-04-22 13:41:12.197 | ERROR    | app.core.llm_client:generate:86 - [Ollama 경량] 요청 실패: All connection attempts failed (소요 시간: 0.01초)
2025-04-22 13:41:12.197 | ERROR    | app.services.chatbot.chatbot_classifier:_classify_rag_type:93 - RAG 유형 분류 중 오류 발생: Ollama 서버 요청 실패: All connection attempts failed
2025-04-22 13:41:12.197 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: none
2025-04-22 13:41:12.197 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: none
2025-04-22 13:41:12.197 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: none
2025-04-22 13:41:12.197 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 13:41:12.197 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:41:12.197 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 13:41:12.197 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: llama3:8b
2025-04-22 13:41:12.197 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:41:12.198 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:41:12.203 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:41:12.203 | DEBUG    | logging:callHandlers:1762 - connect_tcp.failed exception=ConnectError(OSError('All connection attempts failed'))
2025-04-22 13:41:12.203 | ERROR    | app.core.llm_client:check_connection:51 - [Ollama 경량] 서버 연결 실패: All connection attempts failed (소요 시간: 0.01초)
2025-04-22 13:41:12.203 | ERROR    | app.services.common.preprocessor:translate_query:91 - [Preprocess] Error during translation processing: Failed to connect to LLM server (Time elapsed: 0.01 seconds)
2025-04-22 13:41:12.204 | ERROR    | app.services.chatbot.chatbot:get_response:65 - 응답 생성 중 오류 발생: Error during translation processing: Failed to connect to LLM server
2025-04-22 13:41:12.204 | ERROR    | app.services.chatbot.chatbot:get_response:66 - [WORKFLOW] ====== Error in chatbot workflow: Error during translation processing: Failed to connect to LLM server ======
2025-04-22 13:41:12.525 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 13:41:19.960 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: llama3:8b
2025-04-22 13:41:19.961 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:41:20.163 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:41:20.366 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 13:41:20.574 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 13:41:20.780 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:41:20.988 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 13:41:21.188 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 13:41:21.524 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 13:41:22.169 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 13:41:22.173 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 13:41:22.315 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:41:22.319 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 13:41:22.322 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 13:41:22.325 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 13:41:22.327 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 13:41:22.329 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 13:41:22.331 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 13:41:22.331 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:12b
2025-04-22 13:41:22.331 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 13:41:22.331 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: llama3:8b
2025-04-22 13:41:22.331 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 13:41:22.331 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 13:41:22.331 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:41:22.331 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:41:22.331 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 13:41:22.332 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:41:22.332 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:41:22.338 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:41:22.340 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318bd3d40>
2025-04-22 13:41:22.340 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:41:22.340 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:41:22.341 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:41:22.341 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:41:22.341 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:41:22.343 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:41:22 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:41:22.343 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:41:22.343 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:41:22.343 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:41:22.343 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:41:22.344 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:41:22.344 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.01초
2025-04-22 13:41:22.344 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:41:22.344 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:41:22.344 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.01초)
2025-04-22 13:41:22.344 | ERROR    | app.services.chatbot.chatbot_classifier:_classify_rag_type:93 - RAG 유형 분류 중 오류 발생: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:41:22.344 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: none
2025-04-22 13:41:22.344 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: none
2025-04-22 13:41:22.344 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: none
2025-04-22 13:41:22.344 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 13:41:22.344 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:41:22.344 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 13:41:22.344 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: llama3:8b
2025-04-22 13:41:22.345 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:41:22.345 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:41:22.352 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:41:22.354 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x33927ff80>
2025-04-22 13:41:22.354 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 13:41:22.355 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:41:22.355 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 13:41:22.355 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:41:22.355 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 13:41:22.357 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:41:22 GMT'), (b'Content-Length', b'2028')])
2025-04-22 13:41:22.357 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 13:41:22.357 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 13:41:22.357 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:41:22.358 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:41:22.358 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:41:22.358 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.01초
2025-04-22 13:41:22.358 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:41:22.358 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:41:22.358 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.01 seconds
2025-04-22 13:41:22.358 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:41:22.359 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:41:22.365 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:41:22.366 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318b9fb90>
2025-04-22 13:41:22.366 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:41:22.366 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:41:22.366 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:41:22.366 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:41:22.367 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:41:22.368 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:41:22 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:41:22.368 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:41:22.368 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:41:22.368 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:41:22.368 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:41:22.368 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:41:22.369 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.00초
2025-04-22 13:41:22.369 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:41:22.369 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:41:22.369 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.01초)
2025-04-22 13:41:22.369 | ERROR    | app.services.common.preprocessor:translate_query:91 - [Preprocess] Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (Time elapsed: 0.02 seconds)
2025-04-22 13:41:22.369 | ERROR    | app.services.chatbot.chatbot:get_response:65 - 응답 생성 중 오류 발생: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:41:22.369 | ERROR    | app.services.chatbot.chatbot:get_response:66 - [WORKFLOW] ====== Error in chatbot workflow: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 ======
2025-04-22 13:41:22.929 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 13:43:04.850 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: llama3:8b
2025-04-22 13:43:04.851 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:43:05.294 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:43:05.500 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 13:43:05.704 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 13:43:05.904 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:43:06.110 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 13:43:06.317 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 13:43:06.667 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 13:43:07.668 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 13:43:07.672 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 13:43:07.830 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:43:07.835 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 13:43:07.838 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 13:43:07.841 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 13:43:07.845 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 13:43:07.847 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 13:43:07.849 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 13:43:07.850 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:12b
2025-04-22 13:43:07.850 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 13:43:07.850 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: llama3:8b
2025-04-22 13:43:07.850 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 13:43:07.850 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 13:43:07.850 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:43:07.850 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:43:07.850 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 13:43:07.850 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:43:07.851 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:43:07.857 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:43:07.859 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318bfaae0>
2025-04-22 13:43:07.859 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:43:07.859 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:43:07.859 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:43:07.859 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:43:07.859 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:43:07.862 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:43:07 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:43:07.862 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:43:07.862 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:43:07.862 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:43:07.862 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:43:07.862 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:43:07.862 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.01초
2025-04-22 13:43:07.862 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:43:07.862 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:43:07.862 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.01초)
2025-04-22 13:43:07.862 | ERROR    | app.services.chatbot.chatbot_classifier:_classify_rag_type:93 - RAG 유형 분류 중 오류 발생: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:43:07.863 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: none
2025-04-22 13:43:07.863 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: none
2025-04-22 13:43:07.863 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: none
2025-04-22 13:43:07.863 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 13:43:07.863 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:43:07.863 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 13:43:07.863 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: llama3:8b
2025-04-22 13:43:07.863 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:43:07.864 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:43:07.869 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:43:07.872 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16ba30cb0>
2025-04-22 13:43:07.872 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 13:43:07.872 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:43:07.872 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 13:43:07.872 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:43:07.872 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 13:43:07.874 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:43:07 GMT'), (b'Content-Length', b'2028')])
2025-04-22 13:43:07.875 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 13:43:07.875 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 13:43:07.875 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:43:07.875 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:43:07.875 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:43:07.875 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.01초
2025-04-22 13:43:07.875 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:43:07.875 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:43:07.875 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.01 seconds
2025-04-22 13:43:07.876 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:43:07.876 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:43:07.882 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:43:07.883 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318bfb4a0>
2025-04-22 13:43:07.883 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:43:07.883 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:43:07.883 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:43:07.883 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:43:07.883 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:43:07.885 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:43:07 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:43:07.885 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:43:07.885 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:43:07.885 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:43:07.885 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:43:07.885 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:43:07.885 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.00초
2025-04-22 13:43:07.885 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:43:07.886 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:43:07.886 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.01초)
2025-04-22 13:43:07.886 | ERROR    | app.services.common.preprocessor:translate_query:91 - [Preprocess] Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (Time elapsed: 0.02 seconds)
2025-04-22 13:43:07.886 | ERROR    | app.services.chatbot.chatbot:get_response:65 - 응답 생성 중 오류 발생: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:43:07.886 | ERROR    | app.services.chatbot.chatbot:get_response:66 - [WORKFLOW] ====== Error in chatbot workflow: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 ======
2025-04-22 13:43:08.297 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 13:44:06.425 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: llama3:8b
2025-04-22 13:44:06.425 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:44:06.860 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:44:07.070 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 13:44:07.277 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 13:44:07.484 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:44:07.680 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 13:44:07.884 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 13:44:08.197 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 13:44:08.845 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 13:44:08.849 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 13:44:09.001 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:44:09.004 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 13:44:09.007 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 13:44:09.011 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 13:44:09.013 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 13:44:09.014 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 13:44:09.016 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 13:44:09.016 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:12b
2025-04-22 13:44:09.016 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 13:44:09.016 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: llama3:8b
2025-04-22 13:44:09.016 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 13:44:09.017 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 13:44:09.017 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:44:09.017 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:44:09.017 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 13:44:09.017 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:44:09.018 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:44:09.024 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:44:09.025 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318bf8170>
2025-04-22 13:44:09.025 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:44:09.025 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:44:09.025 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:44:09.025 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:44:09.025 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:44:09.027 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:44:09 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:44:09.027 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:44:09.027 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:44:09.027 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:44:09.028 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:44:09.028 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:44:09.028 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.00초
2025-04-22 13:44:09.028 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:44:09.028 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:44:09.028 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.01초)
2025-04-22 13:44:09.028 | ERROR    | app.services.chatbot.chatbot_classifier:_classify_rag_type:93 - RAG 유형 분류 중 오류 발생: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:44:09.028 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: none
2025-04-22 13:44:09.028 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: none
2025-04-22 13:44:09.028 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: none
2025-04-22 13:44:09.028 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 13:44:09.028 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:44:09.029 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 13:44:09.029 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: llama3:8b
2025-04-22 13:44:09.029 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:44:09.029 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:44:09.035 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:44:09.037 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318bd2960>
2025-04-22 13:44:09.037 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 13:44:09.037 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:44:09.037 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 13:44:09.037 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:44:09.037 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 13:44:09.039 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:44:09 GMT'), (b'Content-Length', b'2028')])
2025-04-22 13:44:09.039 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 13:44:09.039 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 13:44:09.039 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:44:09.039 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:44:09.039 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:44:09.040 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.01초
2025-04-22 13:44:09.040 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:44:09.040 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:44:09.040 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.01 seconds
2025-04-22 13:44:09.040 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:44:09.040 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:44:09.046 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:44:09.046 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x33927ff80>
2025-04-22 13:44:09.047 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:44:09.047 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:44:09.047 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:44:09.047 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:44:09.047 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:44:09.048 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:44:09 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:44:09.048 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:44:09.048 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:44:09.048 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:44:09.048 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:44:09.048 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:44:09.049 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.00초
2025-04-22 13:44:09.049 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:44:09.049 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:44:09.049 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.01초)
2025-04-22 13:44:09.049 | ERROR    | app.services.common.preprocessor:translate_query:91 - [Preprocess] Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (Time elapsed: 0.02 seconds)
2025-04-22 13:44:09.049 | ERROR    | app.services.chatbot.chatbot:get_response:65 - 응답 생성 중 오류 발생: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:44:09.049 | ERROR    | app.services.chatbot.chatbot:get_response:66 - [WORKFLOW] ====== Error in chatbot workflow: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 ======
2025-04-22 13:44:09.345 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 13:44:45.754 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: llama3:8b
2025-04-22 13:44:45.756 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:44:46.192 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:44:46.394 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 13:44:46.596 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 13:44:46.803 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:44:47.005 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 13:44:47.206 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 13:44:47.579 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 13:44:48.235 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 13:44:48.238 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 13:44:48.409 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:44:48.414 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 13:44:48.417 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 13:44:48.419 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 13:44:48.422 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 13:44:48.424 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 13:44:48.425 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 13:44:48.426 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:12b
2025-04-22 13:44:48.426 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 13:44:48.426 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: llama3:8b
2025-04-22 13:44:48.426 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 13:44:48.426 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 13:44:48.426 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:44:48.426 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:44:48.426 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 13:44:48.426 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:44:48.427 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:44:48.433 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:44:48.434 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x316901f70>
2025-04-22 13:44:48.434 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:44:48.434 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:44:48.435 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:44:48.435 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:44:48.435 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:44:48.437 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:44:48 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:44:48.438 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:44:48.438 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:44:48.438 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:44:48.438 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:44:48.438 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:44:48.438 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.01초
2025-04-22 13:44:48.438 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:44:48.439 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:44:48.439 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.01초)
2025-04-22 13:44:48.439 | ERROR    | app.services.chatbot.chatbot_classifier:_classify_rag_type:93 - RAG 유형 분류 중 오류 발생: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:44:48.439 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: none
2025-04-22 13:44:48.439 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: none
2025-04-22 13:44:48.439 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: none
2025-04-22 13:44:48.439 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 13:44:48.439 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:44:48.439 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 13:44:48.439 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: llama3:8b
2025-04-22 13:44:48.439 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:44:48.440 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:44:48.445 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:44:48.447 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x33927f740>
2025-04-22 13:44:48.447 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 13:44:48.447 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:44:48.447 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 13:44:48.447 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:44:48.447 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 13:44:48.450 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:44:48 GMT'), (b'Content-Length', b'2028')])
2025-04-22 13:44:48.450 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 13:44:48.450 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 13:44:48.451 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:44:48.451 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:44:48.451 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:44:48.451 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.01초
2025-04-22 13:44:48.451 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:44:48.451 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:44:48.451 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.01 seconds
2025-04-22 13:44:48.451 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:44:48.451 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:44:48.456 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:44:48.457 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318bd38f0>
2025-04-22 13:44:48.457 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:44:48.458 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:44:48.458 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:44:48.458 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:44:48.458 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:44:48.459 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:44:48 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:44:48.459 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:44:48.459 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:44:48.459 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:44:48.459 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:44:48.459 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:44:48.459 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.00초
2025-04-22 13:44:48.459 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:44:48.459 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:44:48.459 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.01초)
2025-04-22 13:44:48.459 | ERROR    | app.services.common.preprocessor:translate_query:91 - [Preprocess] Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (Time elapsed: 0.02 seconds)
2025-04-22 13:44:48.460 | ERROR    | app.services.chatbot.chatbot:get_response:65 - 응답 생성 중 오류 발생: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:44:48.460 | ERROR    | app.services.chatbot.chatbot:get_response:66 - [WORKFLOW] ====== Error in chatbot workflow: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 ======
2025-04-22 13:44:48.940 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 13:47:28.695 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: llama3:8b
2025-04-22 13:47:28.702 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:47:29.393 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:47:29.627 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 13:47:29.826 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 13:47:30.022 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:47:30.231 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 13:47:30.646 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 13:47:31.905 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 13:47:32.619 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 13:47:32.627 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 13:47:34.418 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:47:34.447 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 13:47:34.449 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 13:47:34.453 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 13:47:34.456 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 13:47:34.459 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 13:47:34.462 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 13:47:34.463 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:12b
2025-04-22 13:47:34.463 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 13:47:34.463 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: llama3:8b
2025-04-22 13:47:34.463 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 13:47:34.463 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 13:47:34.463 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:47:34.463 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:47:34.463 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 13:47:34.464 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:47:34.473 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:47:34.487 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:47:34.494 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318b9f470>
2025-04-22 13:47:34.495 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:47:34.495 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:47:34.495 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:47:34.496 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:47:34.496 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:47:34.503 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:47:34 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:47:34.503 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:47:34.504 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:47:34.504 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:47:34.504 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:47:34.504 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:47:34.504 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.02초
2025-04-22 13:47:34.504 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:47:34.504 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:47:34.504 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.04초)
2025-04-22 13:47:34.504 | ERROR    | app.services.chatbot.chatbot_classifier:_classify_rag_type:93 - RAG 유형 분류 중 오류 발생: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:47:34.504 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: none
2025-04-22 13:47:34.504 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: none
2025-04-22 13:47:34.504 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: none
2025-04-22 13:47:34.504 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 13:47:34.505 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:47:34.505 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 13:47:34.505 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: llama3:8b
2025-04-22 13:47:34.505 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:47:34.505 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:47:34.511 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:47:34.513 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318b32d20>
2025-04-22 13:47:34.513 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 13:47:34.513 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:47:34.513 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 13:47:34.513 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:47:34.513 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 13:47:34.520 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:47:34 GMT'), (b'Content-Length', b'2028')])
2025-04-22 13:47:34.520 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 13:47:34.520 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 13:47:34.520 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:47:34.520 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:47:34.521 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:47:34.521 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 13:47:34.521 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:47:34.521 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:47:34.521 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 13:47:34.521 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:47:34.521 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:47:34.527 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=30 socket_options=None
2025-04-22 13:47:34.528 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318b649e0>
2025-04-22 13:47:34.528 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:47:34.528 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:47:34.528 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:47:34.528 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:47:34.528 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:47:34.532 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 404, b'Not Found', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:47:34 GMT'), (b'Content-Length', b'39')])
2025-04-22 13:47:34.532 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 404 Not Found"
2025-04-22 13:47:34.533 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:47:34.533 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:47:34.533 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:47:34.533 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:47:34.533 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.01초
2025-04-22 13:47:34.533 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:47:34.533 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:47:34.533 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (소요 시간: 0.01초)
2025-04-22 13:47:34.533 | ERROR    | app.services.common.preprocessor:translate_query:91 - [Preprocess] Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 (Time elapsed: 0.03 seconds)
2025-04-22 13:47:34.533 | ERROR    | app.services.chatbot.chatbot:get_response:65 - 응답 생성 중 오류 발생: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404
2025-04-22 13:47:34.533 | ERROR    | app.services.chatbot.chatbot:get_response:66 - [WORKFLOW] ====== Error in chatbot workflow: Error during translation processing: Ollama 처리 중 오류 발생: Client error '404 Not Found' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404 ======
2025-04-22 13:47:35.166 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 13:53:21.987 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 13:53:25.260 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 13:53:25.262 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 13:54:43.016 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 13:54:45.251 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 13:54:45.252 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 13:57:21.764 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:1b
2025-04-22 13:57:21.765 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:57:21.776 | DEBUG    | logging:callHandlers:1762 - Starting new HTTPS connection (1): huggingface.co:443
2025-04-22 13:57:22.094 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:57:22.311 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 13:57:22.512 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 13:57:22.786 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:57:23.173 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 13:57:23.381 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 13:57:24.722 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 13:57:25.380 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 13:57:25.421 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 13:57:25.575 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:57:25.594 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 13:57:25.660 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 13:57:25.660 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 13:57:25.660 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 13:57:25.660 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 13:57:25.660 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 13:57:25.664 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 13:57:25.664 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 13:57:25.664 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 13:57:25.669 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 13:57:25.670 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 13:57:25.670 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 13:57:25.670 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 13:57:25.670 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 13:57:25.670 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 13:57:25.670 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 13:57:25.671 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 13:57:25.671 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 13:57:25.671 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 13:57:25.672 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 13:57:25.673 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 13:57:25.673 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 13:57:25.673 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 13:57:25.673 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 13:57:25.673 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 13:57:25.674 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 13:57:25.675 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 13:57:25.675 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 13:57:25.675 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 13:57:25.676 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 13:57:25.677 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 13:57:25.677 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 13:57:25.677 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 13:57:25.677 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 13:57:25.677 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 13:57:25.677 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 13:57:25.678 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 13:57:25.678 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 13:57:25.678 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 13:57:25.679 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 13:57:25.680 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 13:57:25.680 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 13:57:25.680 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 13:57:25.680 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 13:57:25.680 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 13:57:25.680 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 13:57:25.681 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 13:57:25.681 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 13:57:25.681 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 13:57:25.682 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 13:57:25.683 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 13:57:25.683 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 13:57:25.683 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 13:57:25.683 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 13:57:25.683 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 13:57:25.683 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 13:57:25.685 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 13:57:25.685 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 13:57:25.685 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 13:57:25.685 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 13:57:25.686 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 13:57:25.686 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 13:57:25.686 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:1b
2025-04-22 13:57:25.686 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 13:57:25.686 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 13:57:25.686 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:57:25.686 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:57:25.686 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 13:57:25.686 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:57:25.687 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:57:25.695 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 13:57:25.696 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x30f022090>
2025-04-22 13:57:25.696 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:57:25.697 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:57:25.697 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:57:25.697 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:57:25.697 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:57:26.168 | DEBUG    | logging:callHandlers:1762 - Starting new HTTPS connection (1): us.i.posthog.com:443
2025-04-22 13:57:26.850 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 13:57:26.928 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:57:26 GMT'), (b'Content-Length', b'1038')])
2025-04-22 13:57:26.929 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 13:57:26.930 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:57:26.931 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:57:26.931 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:57:26.931 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:57:26.931 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.24초
2025-04-22 13:57:26.932 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.25초
2025-04-22 13:57:26.932 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:57:26.932 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:57:26.932 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 13:57:26.933 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 13:57:26.933 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 13:57:26.933 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 13:57:26.933 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:57:26.933 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 13:57:26.933 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:1b
2025-04-22 13:57:26.934 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:57:26.935 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:57:26.948 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 13:57:26.950 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x30f097c80>
2025-04-22 13:57:26.950 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 13:57:26.950 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:57:26.950 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 13:57:26.951 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:57:26.951 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 13:57:26.954 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:57:26 GMT'), (b'Content-Length', b'2028')])
2025-04-22 13:57:26.954 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 13:57:26.954 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 13:57:26.954 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:57:26.954 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:57:26.954 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:57:26.955 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 13:57:26.955 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:57:26.956 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:57:26.956 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 13:57:26.957 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:57:26.957 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:57:26.966 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 13:57:26.968 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x30f095dc0>
2025-04-22 13:57:26.969 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:57:26.969 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:57:26.969 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:57:26.969 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:57:26.970 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:57:27.628 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:57:27 GMT'), (b'Content-Length', b'1146')])
2025-04-22 13:57:27.629 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 13:57:27.629 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:57:27.629 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:57:27.629 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:57:27.630 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:57:27.630 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.66초
2025-04-22 13:57:27.630 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.67초
2025-04-22 13:57:27.630 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:57:27.631 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:57:27.631 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 0.67 seconds
2025-04-22 13:57:27.631 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I am trying to find a job in South Korea, could you please tell me what qualifications are required for the job?",
  "lang_code": "KR"
}
2025-04-22 13:57:27.631 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 13:57:27.631 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I am trying to find a job in South Korea, could you please tell me what qualifications are required for the job?
2025-04-22 13:57:27.631 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: KR
2025-04-22 13:57:27.631 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 0.70 seconds
2025-04-22 13:57:27.631 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: KR, 영어 번역: I am trying to find a job in South Korea, could you please tell me what qualifications are required for the job?
2025-04-22 13:57:27.632 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=KR, english_query='I am trying to find a job in South Korea, could you please tell me what qualifications are required for the job?'
2025-04-22 13:57:27.632 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 13:57:27.632 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I am trying to find a job in South Korea, could you please tell me what qualifications are required for the job?
2025-04-22 13:57:27.632 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 13:57:27.632 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 13:57:27.632 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 13:57:27.632 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I am trying to find a job in South Korea, could you please tell me what qualifications are required for the job?
2025-04-22 13:57:27.852 | DEBUG    | logging:callHandlers:1762 - Starting component PersistentLocalHnswSegment
2025-04-22 13:57:27.852 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 13:57:27.852 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 13:57:27.852 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 13:57:27.853 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 13:57:27.853 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I am trying to find a job in South Korea, could you please tell me what qualifications are required for the job?
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 13:57:27.853 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 13:57:27.853 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:57:27.853 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:57:27.858 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 13:57:27.859 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x30f023590>
2025-04-22 13:57:27.860 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:57:27.860 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:57:27.860 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:57:27.860 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:57:27.860 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:57:28.131 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 13:57:37.860 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 13:57:37.860 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:57:37.860 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:57:37.861 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.01초)
2025-04-22 13:57:37.861 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 13:57:37.862 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 13:57:37.862 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 13:57:37.862 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 13:57:37.862 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: KR, RAG type: visa_law
2025-04-22 13:57:37.862 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 13:57:37.862 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to KR (code: KR)
2025-04-22 13:57:37.863 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to KR. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 13:57:37.863 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:57:37.866 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:57:37.874 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 13:57:37.875 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x30f0c3fb0>
2025-04-22 13:57:37.875 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:57:37.876 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:57:37.876 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:57:37.876 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:57:37.876 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:57:38.094 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:57:38 GMT'), (b'Content-Length', b'738')])
2025-04-22 13:57:38.096 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 13:57:38.096 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:57:38.096 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:57:38.097 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:57:38.097 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:57:38.097 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.22초
2025-04-22 13:57:38.097 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.23초
2025-04-22 13:57:38.098 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:57:38.098 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:57:38.098 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed:  آسف، حدث خطأ أثناء توليد الاستجابة.

2025-04-22 13:57:38.098 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (KR):  آسف، حدث خطأ أثناء توليد الاستجابة.

2025-04-22 13:57:38.098 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 13:57:38.099 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 13:57:38.099 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: ' آسف، حدث خطأ أثناء توليد الاستجابة.
'
2025-04-22 13:57:38.099 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 13:58:46.549 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:1b
2025-04-22 13:58:46.551 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:58:46.749 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:58:47.832 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 13:58:48.251 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 13:58:48.718 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:58:50.179 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 13:58:50.391 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 13:58:51.213 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 13:58:52.242 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 13:58:52.246 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 13:58:52.655 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:58:52.659 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 13:58:52.661 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 13:58:52.663 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 13:58:52.664 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 13:58:52.666 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 13:58:52.667 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 13:58:52.668 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 13:58:52.668 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 13:58:52.668 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:1b
2025-04-22 13:58:52.668 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 13:58:52.668 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 13:58:52.668 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:58:52.668 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:58:52.668 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 13:58:52.668 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:58:52.669 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:58:52.675 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 13:58:52.676 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x30f0c3950>
2025-04-22 13:58:52.677 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:58:52.677 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:58:52.677 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:58:52.677 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:58:52.677 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:58:52.960 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 13:58:53.168 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:58:53 GMT'), (b'Content-Length', b'1035')])
2025-04-22 13:58:53.169 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 13:58:53.170 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:58:53.170 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:58:53.170 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:58:53.170 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:58:53.171 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.50초
2025-04-22 13:58:53.171 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.50초
2025-04-22 13:58:53.171 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:58:53.171 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:58:53.171 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 13:58:53.171 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 13:58:53.172 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 13:58:53.172 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 13:58:53.172 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:58:53.172 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 13:58:53.172 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:1b
2025-04-22 13:58:53.173 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:58:53.174 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:58:53.189 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 13:58:53.191 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x30f023170>
2025-04-22 13:58:53.192 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 13:58:53.192 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:58:53.192 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 13:58:53.193 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:58:53.193 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 13:58:53.195 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:58:53 GMT'), (b'Content-Length', b'2028')])
2025-04-22 13:58:53.195 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 13:58:53.196 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 13:58:53.196 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:58:53.196 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:58:53.196 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:58:53.196 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 13:58:53.196 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:58:53.196 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:58:53.196 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 13:58:53.197 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:58:53.198 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:58:53.208 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 13:58:53.209 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x30f097b00>
2025-04-22 13:58:53.210 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:58:53.210 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:58:53.210 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:58:53.210 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:58:53.210 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:58:53.849 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:58:53 GMT'), (b'Content-Length', b'1143')])
2025-04-22 13:58:53.849 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 13:58:53.851 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:58:53.851 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:58:53.851 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:58:53.852 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:58:53.852 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.64초
2025-04-22 13:58:53.852 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.66초
2025-04-22 13:58:53.852 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:58:53.853 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:58:53.853 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 0.66 seconds
2025-04-22 13:58:53.853 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I am trying to find a job in South Korea, could you please tell me what qualifications are needed for the job?",
  "lang_code": "ko"
}
2025-04-22 13:58:53.853 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 13:58:53.853 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I am trying to find a job in South Korea, could you please tell me what qualifications are needed for the job?
2025-04-22 13:58:53.853 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: ko
2025-04-22 13:58:53.853 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 0.68 seconds
2025-04-22 13:58:53.853 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: ko, 영어 번역: I am trying to find a job in South Korea, could you please tell me what qualifications are needed for the job?
2025-04-22 13:58:53.854 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=ko, english_query='I am trying to find a job in South Korea, could you please tell me what qualifications are needed for the job?'
2025-04-22 13:58:53.854 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 13:58:53.854 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I am trying to find a job in South Korea, could you please tell me what qualifications are needed for the job?
2025-04-22 13:58:53.854 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 13:58:53.854 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 13:58:53.854 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 13:58:53.854 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I am trying to find a job in South Korea, could you please tell me what qualifications are needed for the job?
2025-04-22 13:58:53.896 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 13:58:53.896 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 13:58:53.897 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 13:58:53.897 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 13:58:53.897 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I am trying to find a job in South Korea, could you please tell me what qualifications are needed for the job?
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 13:58:53.897 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 13:58:53.897 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:58:53.898 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:58:53.905 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 13:58:53.908 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x30f097020>
2025-04-22 13:58:53.908 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:58:53.908 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:58:53.908 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:58:53.909 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:58:53.909 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:59:03.908 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 13:59:03.909 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:59:03.910 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:59:03.910 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.01초)
2025-04-22 13:59:03.910 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 13:59:03.911 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 13:59:03.911 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 13:59:03.911 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 13:59:03.911 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: ko, RAG type: visa_law
2025-04-22 13:59:03.911 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 13:59:03.911 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Korean (code: ko)
2025-04-22 13:59:03.911 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Korean. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 13:59:03.912 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:59:03.913 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:59:03.922 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 13:59:03.923 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x30f055070>
2025-04-22 13:59:03.923 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:59:03.923 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:59:03.923 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:59:03.923 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:59:03.923 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:59:04.131 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:59:04 GMT'), (b'Content-Length', b'732')])
2025-04-22 13:59:04.132 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 13:59:04.132 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:59:04.132 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:59:04.132 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:59:04.133 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:59:04.133 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.21초
2025-04-22 13:59:04.133 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.22초
2025-04-22 13:59:04.133 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:59:04.134 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:59:04.134 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 죄송합니다. 응답 생성 중 오류가 발생했습니다.
2025-04-22 13:59:04.134 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Korean): 죄송합니다. 응답 생성 중 오류가 발생했습니다.
2025-04-22 13:59:04.134 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 13:59:04.134 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 13:59:04.135 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '죄송합니다. 응답 생성 중 오류가 발생했습니다.'
2025-04-22 13:59:04.135 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 13:59:13.869 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:1b
2025-04-22 13:59:13.870 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:59:14.071 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:59:14.277 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 13:59:14.698 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 13:59:14.893 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 13:59:15.094 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 13:59:15.304 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 13:59:15.757 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 13:59:16.425 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 13:59:16.429 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 13:59:16.581 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 13:59:16.585 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 13:59:16.587 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 13:59:16.590 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 13:59:16.591 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 13:59:16.593 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 13:59:16.595 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 13:59:16.595 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 13:59:16.595 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 13:59:16.595 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:1b
2025-04-22 13:59:16.595 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 13:59:16.595 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 13:59:16.595 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:59:16.595 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:59:16.595 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 13:59:16.596 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:59:16.596 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:59:16.602 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 13:59:16.603 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x30f0bff50>
2025-04-22 13:59:16.604 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:59:16.604 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:59:16.604 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:59:16.604 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:59:16.604 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:59:16.836 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:59:16 GMT'), (b'Content-Length', b'1036')])
2025-04-22 13:59:16.836 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 13:59:16.837 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:59:16.837 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:59:16.837 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:59:16.837 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:59:16.837 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.24초
2025-04-22 13:59:16.837 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.24초
2025-04-22 13:59:16.838 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:59:16.838 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:59:16.838 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 13:59:16.838 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 13:59:16.838 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 13:59:16.838 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 13:59:16.838 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 13:59:16.838 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 13:59:16.838 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:1b
2025-04-22 13:59:16.839 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:59:16.839 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:59:16.851 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 13:59:16.852 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x30f097170>
2025-04-22 13:59:16.853 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 13:59:16.853 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:59:16.853 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 13:59:16.853 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:59:16.853 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 13:59:16.855 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:59:16 GMT'), (b'Content-Length', b'2028')])
2025-04-22 13:59:16.856 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 13:59:16.856 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 13:59:16.856 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:59:16.856 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:59:16.856 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:59:16.856 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 13:59:16.856 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:59:16.856 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:59:16.856 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 13:59:16.857 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:59:16.857 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:59:16.866 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 13:59:16.867 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x30f0bd250>
2025-04-22 13:59:16.867 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:59:16.867 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:59:16.867 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:59:16.867 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:59:16.867 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:59:16.943 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 13:59:17.514 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:59:17 GMT'), (b'Content-Length', b'1144')])
2025-04-22 13:59:17.514 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 13:59:17.515 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:59:17.515 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:59:17.515 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:59:17.515 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:59:17.516 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.65초
2025-04-22 13:59:17.516 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.66초
2025-04-22 13:59:17.517 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:59:17.517 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:59:17.517 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 0.66 seconds
2025-04-22 13:59:17.518 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I am trying to find a job in South Korea, could you please tell me what qualifications are needed for the job?",
  "lang_code": "KR"
}
2025-04-22 13:59:17.518 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 13:59:17.518 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I am trying to find a job in South Korea, could you please tell me what qualifications are needed for the job?
2025-04-22 13:59:17.518 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: KR
2025-04-22 13:59:17.518 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 0.68 seconds
2025-04-22 13:59:17.519 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: KR, 영어 번역: I am trying to find a job in South Korea, could you please tell me what qualifications are needed for the job?
2025-04-22 13:59:17.519 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=KR, english_query='I am trying to find a job in South Korea, could you please tell me what qualifications are needed for the job?'
2025-04-22 13:59:17.519 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 13:59:17.519 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I am trying to find a job in South Korea, could you please tell me what qualifications are needed for the job?
2025-04-22 13:59:17.519 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 13:59:17.519 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 13:59:17.520 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 13:59:17.520 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I am trying to find a job in South Korea, could you please tell me what qualifications are needed for the job?
2025-04-22 13:59:17.548 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 13:59:17.548 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 13:59:17.548 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 13:59:17.548 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 13:59:17.548 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I am trying to find a job in South Korea, could you please tell me what qualifications are needed for the job?
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 13:59:17.548 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 13:59:17.549 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:59:17.549 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:59:17.558 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 13:59:17.562 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16bb3dd30>
2025-04-22 13:59:17.562 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:59:17.563 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:59:17.563 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:59:17.563 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:59:17.563 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:59:27.564 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 13:59:27.564 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:59:27.565 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:59:27.565 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.02초)
2025-04-22 13:59:27.565 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 13:59:27.566 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 13:59:27.566 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 13:59:27.566 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 13:59:27.566 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: KR, RAG type: visa_law
2025-04-22 13:59:27.566 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 13:59:27.566 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to KR (code: KR)
2025-04-22 13:59:27.566 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to KR. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 13:59:27.567 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 13:59:27.568 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 13:59:27.576 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 13:59:27.577 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x30f0bf1d0>
2025-04-22 13:59:27.577 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 13:59:27.577 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 13:59:27.577 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 13:59:27.578 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 13:59:27.578 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 13:59:27.801 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 04:59:27 GMT'), (b'Content-Length', b'742')])
2025-04-22 13:59:27.801 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 13:59:27.802 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 13:59:27.802 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 13:59:27.802 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 13:59:27.802 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 13:59:27.802 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.23초
2025-04-22 13:59:27.803 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.24초
2025-04-22 13:59:27.803 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 13:59:27.803 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 13:59:27.803 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 죄송합니다, 응답 생성 중에 오류가 발생했습니다.

2025-04-22 13:59:27.803 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (KR): 죄송합니다, 응답 생성 중에 오류가 발생했습니다.

2025-04-22 13:59:27.803 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 13:59:27.804 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 13:59:27.804 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '죄송합니다, 응답 생성 중에 오류가 발생했습니다.
'
2025-04-22 13:59:27.804 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 13:59:48.425 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 14:10:28.957 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 14:10:28.959 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 14:11:04.852 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:11:04.853 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:11:04.864 | DEBUG    | logging:callHandlers:1762 - Starting new HTTPS connection (1): huggingface.co:443
2025-04-22 14:11:05.134 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:11:05.338 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:11:05.546 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:11:05.747 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:11:05.953 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:11:06.161 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:11:07.769 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:11:08.516 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:11:08.552 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:11:08.853 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:11:08.871 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 14:11:08.935 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 14:11:08.935 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 14:11:08.935 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 14:11:08.935 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 14:11:08.935 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 14:11:08.939 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 14:11:08.939 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 14:11:08.939 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 14:11:08.944 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:11:08.945 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 14:11:08.945 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 14:11:08.945 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 14:11:08.945 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 14:11:08.945 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 14:11:08.945 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 14:11:08.946 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 14:11:08.946 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 14:11:08.946 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 14:11:08.947 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:11:08.948 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 14:11:08.948 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 14:11:08.948 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 14:11:08.948 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 14:11:08.948 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 14:11:08.948 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 14:11:08.950 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 14:11:08.950 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 14:11:08.950 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 14:11:08.950 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:11:08.951 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 14:11:08.951 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 14:11:08.951 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 14:11:08.951 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 14:11:08.952 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 14:11:08.952 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 14:11:08.952 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 14:11:08.952 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 14:11:08.952 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 14:11:08.953 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:11:08.954 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 14:11:08.954 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 14:11:08.954 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 14:11:08.954 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 14:11:08.954 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 14:11:08.954 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 14:11:08.955 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 14:11:08.955 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 14:11:08.955 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 14:11:08.956 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:11:08.957 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 14:11:08.957 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 14:11:08.957 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 14:11:08.957 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 14:11:08.957 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 14:11:08.957 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 14:11:08.958 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 14:11:08.958 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 14:11:08.958 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 14:11:08.959 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:11:08.959 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:11:08.959 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:11:08.959 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:11:08.959 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:11:08.959 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:11:08.959 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 14:11:08.959 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 14:11:08.960 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:11:08.960 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:11:08.960 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:11:08.967 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:11:08.969 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31e25de80>
2025-04-22 14:11:08.969 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:11:08.970 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:11:08.970 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:11:08.970 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:11:08.970 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:11:09.445 | DEBUG    | logging:callHandlers:1762 - Starting new HTTPS connection (1): us.i.posthog.com:443
2025-04-22 14:11:10.081 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:11:12.688 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:11:12 GMT'), (b'Content-Length', b'1028')])
2025-04-22 14:11:12.691 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:11:12.692 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:11:12.693 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:11:12.693 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:11:12.694 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:11:12.694 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 3.73초
2025-04-22 14:11:12.695 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 3.74초
2025-04-22 14:11:12.695 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:11:12.695 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:11:12.695 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: employment
2025-04-22 14:11:12.695 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: employment
2025-04-22 14:11:12.695 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: employment
2025-04-22 14:11:12.695 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:11:12.695 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 14:11:12.695 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:11:12.696 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:11:12.696 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:11:12.698 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:11:12.708 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:11:12.710 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31e29bef0>
2025-04-22 14:11:12.710 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:11:12.710 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:11:12.710 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:11:12.710 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:11:12.710 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:11:12.712 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:11:12 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:11:12.712 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:11:12.712 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:11:12.712 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:11:12.712 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:11:12.712 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:11:12.712 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 14:11:12.712 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:11:12.714 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:11:12.714 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 14:11:12.714 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:11:12.714 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:11:12.720 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:11:12.721 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31e29a0f0>
2025-04-22 14:11:12.722 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:11:12.722 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:11:12.722 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:11:12.722 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:11:12.722 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:11:14.043 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:11:14 GMT'), (b'Content-Length', b'1118')])
2025-04-22 14:11:14.044 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:11:14.044 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:11:14.045 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:11:14.045 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:11:14.045 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:11:14.045 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.33초
2025-04-22 14:11:14.046 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.33초
2025-04-22 14:11:14.046 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:11:14.046 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:11:14.047 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.33 seconds
2025-04-22 14:11:14.047 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I am trying to find a job in Korea, but I would like to know what the required specifications are.",
  "lang_code": "ja"
}
2025-04-22 14:11:14.047 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:11:14.047 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I am trying to find a job in Korea, but I would like to know what the required specifications are.
2025-04-22 14:11:14.047 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: ja
2025-04-22 14:11:14.048 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.35 seconds
2025-04-22 14:11:14.048 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: ja, 영어 번역: I am trying to find a job in Korea, but I would like to know what the required specifications are.
2025-04-22 14:11:14.048 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=ja, english_query='I am trying to find a job in Korea, but I would like to know what the required specifications are.'
2025-04-22 14:11:14.048 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:11:14.048 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I am trying to find a job in Korea, but I would like to know what the required specifications are.
2025-04-22 14:11:14.049 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:11:14.049 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: employment
2025-04-22 14:11:14.049 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] employment 유형에서 컨텍스트 생성 시작
2025-04-22 14:11:14.050 | INFO     | app.services.common.rag_service:search:81 - [RAG] employment 도메인에서 문서 검색 시작: I am trying to find a job in Korea, but I would like to know what the required specifications are.
2025-04-22 14:11:14.290 | DEBUG    | logging:callHandlers:1762 - Starting component PersistentLocalHnswSegment
2025-04-22 14:11:14.291 | INFO     | app.services.common.rag_service:search:98 - [RAG] employment 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 14:11:14.292 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:11:14.292 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:11:14.292 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:11:14.292 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I am trying to find a job in Korea, but I would like to know what the required specifications are.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:11:14.292 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:11:14.292 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:11:14.293 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:11:14.298 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:11:14.299 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31e2d3e00>
2025-04-22 14:11:14.300 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:11:14.300 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:11:14.300 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:11:14.300 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:11:14.300 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:11:14.871 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:11:24.302 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:11:24.306 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:11:24.308 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:11:24.308 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.02초)
2025-04-22 14:11:24.309 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:11:24.309 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:11:24.309 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:11:24.309 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:11:24.310 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: ja, RAG type: employment
2025-04-22 14:11:24.310 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:11:24.310 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Japanese (code: ja)
2025-04-22 14:11:24.310 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Japanese. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:11:24.311 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:11:24.314 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:11:24.321 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:11:24.322 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31e2d3230>
2025-04-22 14:11:24.322 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:11:24.323 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:11:24.323 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:11:24.323 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:11:24.323 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:11:24.774 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:11:24 GMT'), (b'Content-Length', b'743')])
2025-04-22 14:11:24.775 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:11:24.776 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:11:24.776 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:11:24.776 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:11:24.777 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:11:24.777 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.46초
2025-04-22 14:11:24.778 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.47초
2025-04-22 14:11:24.778 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:11:24.778 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:11:24.779 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 申し訳ありません。応答の生成中にエラーが発生しました。
2025-04-22 14:11:24.779 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Japanese): 申し訳ありません。応答の生成中にエラーが発生しました。
2025-04-22 14:11:24.779 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:11:24.779 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:11:24.779 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '申し訳ありません。応答の生成中にエラーが発生しました。'
2025-04-22 14:11:24.779 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:16:49.730 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 14:16:53.262 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 14:16:53.264 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 14:18:10.144 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 14:18:12.083 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 14:18:12.084 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 14:18:14.914 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 14:18:16.852 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 14:18:16.853 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 14:18:44.032 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 14:18:45.910 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 14:18:45.911 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 14:19:16.030 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:19:16.031 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:19:16.040 | DEBUG    | logging:callHandlers:1762 - Starting new HTTPS connection (1): huggingface.co:443
2025-04-22 14:19:16.493 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:19:16.698 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:19:16.892 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:19:17.098 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:19:17.302 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:19:17.503 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:19:18.827 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:19:19.473 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:19:19.509 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:19:19.736 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:19:19.756 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 14:19:19.824 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 14:19:19.824 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 14:19:19.824 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 14:19:19.824 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 14:19:19.824 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 14:19:19.826 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 14:19:19.827 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 14:19:19.827 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 14:19:19.832 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:19:19.833 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 14:19:19.833 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 14:19:19.833 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 14:19:19.833 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 14:19:19.833 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 14:19:19.833 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 14:19:19.834 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 14:19:19.834 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 14:19:19.834 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 14:19:19.835 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:19:19.836 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 14:19:19.837 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 14:19:19.837 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 14:19:19.837 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 14:19:19.837 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 14:19:19.837 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 14:19:19.839 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 14:19:19.839 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 14:19:19.839 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 14:19:19.839 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:19:19.840 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 14:19:19.841 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 14:19:19.841 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 14:19:19.841 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 14:19:19.841 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 14:19:19.841 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 14:19:19.841 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 14:19:19.841 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 14:19:19.841 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 14:19:19.842 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:19:19.843 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 14:19:19.843 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 14:19:19.843 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 14:19:19.844 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 14:19:19.844 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 14:19:19.844 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 14:19:19.845 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 14:19:19.845 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 14:19:19.845 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 14:19:19.845 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:19:19.846 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 14:19:19.846 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 14:19:19.847 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 14:19:19.847 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 14:19:19.847 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 14:19:19.847 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 14:19:19.848 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 14:19:19.848 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 14:19:19.848 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 14:19:19.849 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:19:19.849 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:19:19.849 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:19:19.849 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:19:19.849 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:19:19.849 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:19:19.849 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 14:19:19.849 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 14:19:19.849 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:19:19.850 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:19:19.850 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:19:19.858 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:19:19.859 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318c206b0>
2025-04-22 14:19:19.860 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:19:19.860 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:19:19.860 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:19:19.860 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:19:19.860 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:19:20.333 | DEBUG    | logging:callHandlers:1762 - Starting new HTTPS connection (1): us.i.posthog.com:443
2025-04-22 14:19:20.970 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:19:22.599 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 500, b'Internal Server Error', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:19:22 GMT'), (b'Content-Length', b'62')])
2025-04-22 14:19:22.600 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 500 Internal Server Error"
2025-04-22 14:19:22.600 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:19:22.601 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:19:22.601 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:19:22.601 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:19:22.602 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 2.75초
2025-04-22 14:19:22.602 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:19:22.602 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:19:22.602 | ERROR    | app.core.llm_client:generate:91 - [Ollama 경량] 예상치 못한 오류: Server error '500 Internal Server Error' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500 (소요 시간: 2.75초)
2025-04-22 14:19:22.603 | ERROR    | app.services.chatbot.chatbot_classifier:_classify_rag_type:93 - RAG 유형 분류 중 오류 발생: Ollama 처리 중 오류 발생: Server error '500 Internal Server Error' for url 'http://localhost:11434/api/generate'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500
2025-04-22 14:19:22.603 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: none
2025-04-22 14:19:22.603 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: none
2025-04-22 14:19:22.603 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: none
2025-04-22 14:19:22.603 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:19:22.604 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 14:19:22.604 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:19:22.604 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:19:22.605 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:19:22.614 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:19:22.628 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:19:22.631 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca5eb0>
2025-04-22 14:19:22.631 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:19:22.631 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:19:22.631 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:19:22.631 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:19:22.631 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:19:22.636 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:19:22 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:19:22.636 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:19:22.636 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:19:22.636 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:19:22.636 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:19:22.636 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:19:22.636 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.03초
2025-04-22 14:19:22.637 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:19:22.639 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:19:22.639 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.03 seconds
2025-04-22 14:19:22.639 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:19:22.640 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:19:22.648 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:19:22.650 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318c23650>
2025-04-22 14:19:22.650 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:19:22.650 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:19:22.650 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:19:22.650 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:19:22.650 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:19:26.876 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:19:26 GMT'), (b'Content-Length', b'1119')])
2025-04-22 14:19:26.877 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:19:26.878 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:19:26.878 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:19:26.878 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:19:26.878 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:19:26.879 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 4.23초
2025-04-22 14:19:26.879 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 4.24초
2025-04-22 14:19:26.879 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:19:26.879 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:19:26.879 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 4.24 seconds
2025-04-22 14:19:26.879 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I am trying to get a job in Korea, but I would like to know what the required specifications are.",
  "lang_code": "ja"
}
2025-04-22 14:19:26.880 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:19:26.880 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I am trying to get a job in Korea, but I would like to know what the required specifications are.
2025-04-22 14:19:26.880 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: ja
2025-04-22 14:19:26.880 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 4.28 seconds
2025-04-22 14:19:26.880 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: ja, 영어 번역: I am trying to get a job in Korea, but I would like to know what the required specifications are.
2025-04-22 14:19:26.880 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=ja, english_query='I am trying to get a job in Korea, but I would like to know what the required specifications are.'
2025-04-22 14:19:26.881 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:19:26.881 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I am trying to get a job in Korea, but I would like to know what the required specifications are.
2025-04-22 14:19:26.881 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:19:26.881 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: none
2025-04-22 14:19:26.881 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:19:26.882 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I am trying to get a job in Korea, but I would like to know what the required specifications are.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:19:26.882 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:19:26.883 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:19:26.883 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:19:26.895 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:19:26.896 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca6fc0>
2025-04-22 14:19:26.896 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:19:26.896 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:19:26.896 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:19:26.896 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:19:26.896 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:19:36.898 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:19:36.900 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:19:36.900 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:19:36.902 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.02초)
2025-04-22 14:19:36.904 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:19:36.904 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:19:36.904 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:19:36.904 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:19:36.904 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: ja, RAG type: none
2025-04-22 14:19:36.904 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:19:36.905 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Japanese (code: ja)
2025-04-22 14:19:36.905 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Japanese. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:19:36.905 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:19:36.907 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:19:36.914 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:19:36.919 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3393cb7a0>
2025-04-22 14:19:36.920 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:19:36.920 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:19:36.920 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:19:36.920 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:19:36.920 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:19:37.385 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:19:37 GMT'), (b'Content-Length', b'755')])
2025-04-22 14:19:37.385 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:19:37.386 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:19:37.386 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:19:37.386 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:19:37.386 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:19:37.387 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.47초
2025-04-22 14:19:37.387 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.48초
2025-04-22 14:19:37.387 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:19:37.387 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:19:37.387 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 申し訳ありません。応答を生成する際にエラーが発生しました。
2025-04-22 14:19:37.387 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Japanese): 申し訳ありません。応答を生成する際にエラーが発生しました。
2025-04-22 14:19:37.388 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: False
2025-04-22 14:19:37.388 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:19:37.388 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '申し訳ありません。応答を生成する際にエラーが発生しました。'
2025-04-22 14:19:37.388 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:19:56.809 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:19:56.811 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:19:57.011 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:19:57.226 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:19:57.422 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:19:58.010 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:19:58.210 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:19:58.405 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:19:59.189 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:19:59.866 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:19:59.874 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:20:00.359 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:20:00.366 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:20:00.369 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:20:00.371 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:20:00.373 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:20:00.375 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:20:00.377 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:20:00.377 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:20:00.377 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:20:00.378 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:20:00.378 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:20:00.378 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:20:00.378 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 14:20:00.378 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 14:20:00.378 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:20:00.378 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:20:00.379 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:20:00.385 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:20:00.387 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318cc7260>
2025-04-22 14:20:00.387 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:20:00.387 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:20:00.387 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:20:00.387 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:20:00.387 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:20:01.104 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:20:02.194 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:20:02 GMT'), (b'Content-Length', b'1026')])
2025-04-22 14:20:02.196 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:20:02.197 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:20:02.197 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:20:02.198 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:20:02.198 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:20:02.198 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.81초
2025-04-22 14:20:02.199 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.82초
2025-04-22 14:20:02.199 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:20:02.199 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:20:02.200 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: employment
2025-04-22 14:20:02.200 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: employment
2025-04-22 14:20:02.200 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: employment
2025-04-22 14:20:02.200 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:20:02.201 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国で就職しようとしていますが、就職に必要なスペックを教えてください。
2025-04-22 14:20:02.201 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:20:02.201 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:20:02.202 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:20:02.202 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:20:02.218 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:20:02.220 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3393cb920>
2025-04-22 14:20:02.220 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:20:02.221 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:20:02.221 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:20:02.221 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:20:02.221 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:20:02.223 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:20:02 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:20:02.223 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:20:02.223 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:20:02.223 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:20:02.223 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:20:02.224 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:20:02.224 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 14:20:02.224 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:20:02.224 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:20:02.224 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 14:20:02.225 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:20:02.225 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:20:02.233 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:20:02.234 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca4e30>
2025-04-22 14:20:02.234 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:20:02.234 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:20:02.234 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:20:02.234 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:20:02.234 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:20:03.599 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:20:03 GMT'), (b'Content-Length', b'1124')])
2025-04-22 14:20:03.600 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:20:03.601 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:20:03.601 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:20:03.601 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:20:03.601 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:20:03.602 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.37초
2025-04-22 14:20:03.602 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.38초
2025-04-22 14:20:03.603 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:20:03.603 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:20:03.603 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.38 seconds
2025-04-22 14:20:03.603 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I'm trying to get a job in Korea, but I would like to know what the required specifications are.",
  "lang_code": "ja"
}
2025-04-22 14:20:03.603 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:20:03.603 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I'm trying to get a job in Korea, but I would like to know what the required specifications are.
2025-04-22 14:20:03.604 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: ja
2025-04-22 14:20:03.604 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.40 seconds
2025-04-22 14:20:03.604 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: ja, 영어 번역: I'm trying to get a job in Korea, but I would like to know what the required specifications are.
2025-04-22 14:20:03.604 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=ja, english_query='I'm trying to get a job in Korea, but I would like to know what the required specifications are.'
2025-04-22 14:20:03.604 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:20:03.604 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I'm trying to get a job in Korea, but I would like to know what the required specifications are.
2025-04-22 14:20:03.605 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:20:03.605 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: employment
2025-04-22 14:20:03.605 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] employment 유형에서 컨텍스트 생성 시작
2025-04-22 14:20:03.605 | INFO     | app.services.common.rag_service:search:81 - [RAG] employment 도메인에서 문서 검색 시작: I'm trying to get a job in Korea, but I would like to know what the required specifications are.
2025-04-22 14:20:03.908 | DEBUG    | logging:callHandlers:1762 - Starting component PersistentLocalHnswSegment
2025-04-22 14:20:03.909 | INFO     | app.services.common.rag_service:search:98 - [RAG] employment 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 14:20:03.909 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:20:03.909 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:20:03.909 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:20:03.910 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I'm trying to get a job in Korea, but I would like to know what the required specifications are.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:20:03.910 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:20:03.910 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:20:03.910 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:20:03.915 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:20:03.916 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318cc7d10>
2025-04-22 14:20:03.917 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:20:03.917 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:20:03.917 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:20:03.917 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:20:03.917 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:20:04.339 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:20:13.918 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:20:13.919 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:20:13.920 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:20:13.921 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.01초)
2025-04-22 14:20:13.922 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:20:13.923 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:20:13.923 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:20:13.923 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:20:13.923 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: ja, RAG type: employment
2025-04-22 14:20:13.924 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:20:13.924 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Japanese (code: ja)
2025-04-22 14:20:13.924 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Japanese. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:20:13.925 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:20:13.926 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:20:13.932 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:20:13.944 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318c21f70>
2025-04-22 14:20:13.946 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:20:13.948 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:20:13.948 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:20:13.948 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:20:13.948 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:20:14.398 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:20:14 GMT'), (b'Content-Length', b'743')])
2025-04-22 14:20:14.399 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:20:14.399 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:20:14.400 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:20:14.400 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:20:14.400 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:20:14.400 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.47초
2025-04-22 14:20:14.401 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.48초
2025-04-22 14:20:14.401 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:20:14.401 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:20:14.402 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 申し訳ありません。応答の生成中にエラーが発生しました。
2025-04-22 14:20:14.402 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Japanese): 申し訳ありません。応答の生成中にエラーが発生しました。
2025-04-22 14:20:14.402 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:20:14.402 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:20:14.402 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '申し訳ありません。応答の生成中にエラーが発生しました。'
2025-04-22 14:20:14.402 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:20:48.911 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:20:48.913 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:20:49.116 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:20:49.593 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:20:49.791 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:20:49.988 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:20:50.270 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:20:52.433 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:20:53.223 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:20:53.971 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:20:53.977 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:20:54.525 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:20:54.530 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:20:54.532 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:20:54.534 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:20:54.536 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:20:54.538 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:20:54.540 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:20:54.540 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:20:54.540 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:20:54.540 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:20:54.541 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:20:54.541 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:20:54.541 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国に留学したいのですが、必要な資格や成績を教えてください。。
2025-04-22 14:20:54.541 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国に留学したいのですが、必要な資格や成績を教えてください。。
2025-04-22 14:20:54.541 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:20:54.541 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:20:54.542 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:20:54.548 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:20:54.549 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3393c9d30>
2025-04-22 14:20:54.549 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:20:54.550 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:20:54.550 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:20:54.550 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:20:54.550 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:20:54.915 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:20:56.321 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:20:56 GMT'), (b'Content-Length', b'1022')])
2025-04-22 14:20:56.322 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:20:56.323 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:20:56.323 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:20:56.323 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:20:56.323 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:20:56.324 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.78초
2025-04-22 14:20:56.324 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.78초
2025-04-22 14:20:56.324 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:20:56.325 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:20:56.325 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: daily_life
2025-04-22 14:20:56.325 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: daily_life
2025-04-22 14:20:56.325 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: daily_life
2025-04-22 14:20:56.325 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:20:56.325 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国に留学したいのですが、必要な資格や成績を教えてください。。
2025-04-22 14:20:56.326 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:20:56.326 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:20:56.327 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:20:56.327 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:20:56.336 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:20:56.337 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16cc9ae10>
2025-04-22 14:20:56.338 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:20:56.338 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:20:56.338 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:20:56.338 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:20:56.338 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:20:56.339 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:20:56 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:20:56.339 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:20:56.339 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:20:56.339 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:20:56.339 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:20:56.340 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:20:56.340 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.01초
2025-04-22 14:20:56.340 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:20:56.340 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:20:56.340 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.01 seconds
2025-04-22 14:20:56.340 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:20:56.340 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:20:56.350 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:20:56.351 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318c209b0>
2025-04-22 14:20:56.351 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:20:56.351 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:20:56.351 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:20:56.352 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:20:56.352 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:20:57.702 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:20:57 GMT'), (b'Content-Length', b'1094')])
2025-04-22 14:20:57.703 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:20:57.705 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:20:57.706 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:20:57.706 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:20:57.707 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:20:57.707 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.36초
2025-04-22 14:20:57.708 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.37초
2025-04-22 14:20:57.709 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:20:57.711 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:20:57.711 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.37 seconds
2025-04-22 14:20:57.712 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study abroad in Korea, but I need to know what qualifications and grades I need.",
  "lang_code": "ja"
}
2025-04-22 14:20:57.712 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:20:57.712 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study abroad in Korea, but I need to know what qualifications and grades I need.
2025-04-22 14:20:57.712 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: ja
2025-04-22 14:20:57.712 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.39 seconds
2025-04-22 14:20:57.712 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: ja, 영어 번역: I want to study abroad in Korea, but I need to know what qualifications and grades I need.
2025-04-22 14:20:57.720 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=ja, english_query='I want to study abroad in Korea, but I need to know what qualifications and grades I need.'
2025-04-22 14:20:57.721 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:20:57.721 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I want to study abroad in Korea, but I need to know what qualifications and grades I need.
2025-04-22 14:20:57.729 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:20:57.729 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: daily_life
2025-04-22 14:20:57.734 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] daily_life 유형에서 컨텍스트 생성 시작
2025-04-22 14:20:57.741 | INFO     | app.services.common.rag_service:search:81 - [RAG] daily_life 도메인에서 문서 검색 시작: I want to study abroad in Korea, but I need to know what qualifications and grades I need.
2025-04-22 14:20:58.219 | ERROR    | app.services.common.rag_service:search:104 - 문서 검색 중 오류 발생: <RAGType.DAILY_LIFE: 'daily_life'>
2025-04-22 14:20:58.220 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:20:58.220 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:20:58.220 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:20:58.220 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study abroad in Korea, but I need to know what qualifications and grades I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:20:58.221 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:20:58.221 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:20:58.222 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:20:58.229 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:20:58.240 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3169dbce0>
2025-04-22 14:20:58.240 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:20:58.241 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:20:58.241 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:20:58.241 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:20:58.241 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:21:08.244 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:21:08.245 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:21:08.245 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:21:08.246 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.03초)
2025-04-22 14:21:08.248 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:21:08.248 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:21:08.248 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:21:08.248 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:21:08.248 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: ja, RAG type: daily_life
2025-04-22 14:21:08.249 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:21:08.249 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Japanese (code: ja)
2025-04-22 14:21:08.249 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Japanese. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:21:08.250 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:21:08.251 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:21:08.257 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:21:08.259 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16bdbb7a0>
2025-04-22 14:21:08.259 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:21:08.260 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:21:08.260 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:21:08.260 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:21:08.260 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:21:08.700 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:21:08 GMT'), (b'Content-Length', b'743')])
2025-04-22 14:21:08.701 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:21:08.701 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:21:08.701 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:21:08.702 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:21:08.702 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:21:08.702 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.45초
2025-04-22 14:21:08.702 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.45초
2025-04-22 14:21:08.702 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:21:08.703 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:21:08.703 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 申し訳ありません。応答の生成中にエラーが発生しました。
2025-04-22 14:21:08.703 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Japanese): 申し訳ありません。応答の生成中にエラーが発生しました。
2025-04-22 14:21:08.703 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:21:08.703 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:21:08.703 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '申し訳ありません。応答の生成中にエラーが発生しました。'
2025-04-22 14:21:08.703 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:23:00.115 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:23:00.117 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:23:00.319 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:23:00.882 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:23:01.379 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:23:01.578 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:23:01.786 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:23:01.991 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:23:02.810 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:23:03.492 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:23:03.498 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:23:03.986 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:23:03.994 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:23:03.995 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:23:03.997 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:23:03.999 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:23:04.001 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:23:04.002 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:23:04.003 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:23:04.003 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:23:04.003 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:23:04.003 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:23:04.003 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:23:04.003 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国に留学したいのですが、必要な資格や成績を教えてください。。
2025-04-22 14:23:04.003 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国に留学したいのですが、必要な資格や成績を教えてください。。
2025-04-22 14:23:04.003 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:23:04.004 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:23:04.004 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:23:04.011 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:23:04.014 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce20f0>
2025-04-22 14:23:04.014 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:23:04.014 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:23:04.014 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:23:04.014 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:23:04.014 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:23:04.557 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:23:05.827 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:23:05 GMT'), (b'Content-Length', b'1022')])
2025-04-22 14:23:05.829 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:23:05.830 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:23:05.830 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:23:05.830 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:23:05.831 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:23:05.831 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.82초
2025-04-22 14:23:05.832 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.83초
2025-04-22 14:23:05.832 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:23:05.833 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:23:05.833 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: daily_life
2025-04-22 14:23:05.833 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: daily_life
2025-04-22 14:23:05.834 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: daily_life
2025-04-22 14:23:05.834 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:23:05.834 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国に留学したいのですが、必要な資格や成績を教えてください。。
2025-04-22 14:23:05.834 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:23:05.834 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:23:05.835 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:23:05.836 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:23:05.845 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:23:05.846 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318caf770>
2025-04-22 14:23:05.846 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:23:05.847 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:23:05.847 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:23:05.847 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:23:05.847 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:23:05.848 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:23:05 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:23:05.848 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:23:05.848 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:23:05.848 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:23:05.848 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:23:05.848 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:23:05.849 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.01초
2025-04-22 14:23:05.849 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:23:05.849 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:23:05.849 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.01 seconds
2025-04-22 14:23:05.849 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:23:05.849 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:23:05.855 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:23:05.856 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318cae090>
2025-04-22 14:23:05.856 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:23:05.856 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:23:05.856 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:23:05.856 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:23:05.856 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:23:07.177 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:23:07 GMT'), (b'Content-Length', b'1105')])
2025-04-22 14:23:07.177 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:23:07.178 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:23:07.178 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:23:07.178 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:23:07.178 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:23:07.178 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.32초
2025-04-22 14:23:07.179 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.33초
2025-04-22 14:23:07.179 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:23:07.179 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:23:07.179 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.33 seconds
2025-04-22 14:23:07.179 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study abroad in Korea, but I would like to know what qualifications and grades I need.",
  "lang_code": "ja"
}
2025-04-22 14:23:07.179 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:23:07.179 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study abroad in Korea, but I would like to know what qualifications and grades I need.
2025-04-22 14:23:07.180 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: ja
2025-04-22 14:23:07.180 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.35 seconds
2025-04-22 14:23:07.180 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: ja, 영어 번역: I want to study abroad in Korea, but I would like to know what qualifications and grades I need.
2025-04-22 14:23:07.180 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=ja, english_query='I want to study abroad in Korea, but I would like to know what qualifications and grades I need.'
2025-04-22 14:23:07.180 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:23:07.180 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I want to study abroad in Korea, but I would like to know what qualifications and grades I need.
2025-04-22 14:23:07.180 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:23:07.181 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: daily_life
2025-04-22 14:23:07.181 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] daily_life 유형에서 컨텍스트 생성 시작
2025-04-22 14:23:07.181 | INFO     | app.services.common.rag_service:search:81 - [RAG] daily_life 도메인에서 문서 검색 시작: I want to study abroad in Korea, but I would like to know what qualifications and grades I need.
2025-04-22 14:23:07.264 | ERROR    | app.services.common.rag_service:search:104 - 문서 검색 중 오류 발생: <RAGType.DAILY_LIFE: 'daily_life'>
2025-04-22 14:23:07.265 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:23:07.265 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:23:07.265 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:23:07.265 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study abroad in Korea, but I would like to know what qualifications and grades I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:23:07.265 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:23:07.265 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:23:07.266 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:23:07.272 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:23:07.275 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x316a702c0>
2025-04-22 14:23:07.275 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:23:07.275 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:23:07.275 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:23:07.275 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:23:07.276 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:23:17.276 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:23:17.278 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:23:17.279 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:23:17.279 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.01초)
2025-04-22 14:23:17.280 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:23:17.281 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:23:17.281 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:23:17.281 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:23:17.281 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: ja, RAG type: daily_life
2025-04-22 14:23:17.281 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:23:17.281 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Japanese (code: ja)
2025-04-22 14:23:17.282 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Japanese. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:23:17.282 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:23:17.283 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:23:17.290 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:23:17.291 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318caf260>
2025-04-22 14:23:17.291 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:23:17.292 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:23:17.292 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:23:17.292 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:23:17.292 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:23:17.737 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:23:17 GMT'), (b'Content-Length', b'743')])
2025-04-22 14:23:17.738 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:23:17.739 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:23:17.739 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:23:17.739 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:23:17.739 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:23:17.740 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.45초
2025-04-22 14:23:17.740 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.46초
2025-04-22 14:23:17.740 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:23:17.740 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:23:17.741 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 申し訳ありません。応答の生成中にエラーが発生しました。
2025-04-22 14:23:17.741 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Japanese): 申し訳ありません。応答の生成中にエラーが発生しました。
2025-04-22 14:23:17.741 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:23:17.741 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:23:17.741 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '申し訳ありません。応答の生成中にエラーが発生しました。'
2025-04-22 14:23:17.741 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:23:41.077 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:23:41.079 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:23:41.291 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:23:41.493 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:23:42.030 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:23:42.236 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:23:42.436 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:23:42.640 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:23:43.391 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:23:44.060 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:23:44.066 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:23:44.531 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:23:44.535 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:23:44.537 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:23:44.539 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:23:44.541 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:23:44.543 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:23:44.545 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:23:44.545 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:23:44.545 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:23:44.545 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:23:44.545 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:23:44.545 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:23:44.546 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 韓国に留学したいのですが、必要な資格や成績を教えてください。。
2025-04-22 14:23:44.546 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 韓国に留学したいのですが、必要な資格や成績を教えてください。。
2025-04-22 14:23:44.546 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:23:44.546 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:23:44.546 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:23:44.552 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:23:44.554 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3169db5c0>
2025-04-22 14:23:44.554 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:23:44.554 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:23:44.554 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:23:44.554 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:23:44.554 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:23:45.108 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:23:46.347 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:23:46 GMT'), (b'Content-Length', b'1022')])
2025-04-22 14:23:46.347 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:23:46.348 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:23:46.348 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:23:46.348 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:23:46.348 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:23:46.348 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.80초
2025-04-22 14:23:46.349 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.80초
2025-04-22 14:23:46.349 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:23:46.349 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:23:46.349 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: daily_life
2025-04-22 14:23:46.349 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: daily_life
2025-04-22 14:23:46.349 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: daily_life
2025-04-22 14:23:46.349 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:23:46.350 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 韓国に留学したいのですが、必要な資格や成績を教えてください。。
2025-04-22 14:23:46.350 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:23:46.350 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:23:46.350 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:23:46.351 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:23:46.366 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:23:46.367 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca4e90>
2025-04-22 14:23:46.367 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:23:46.367 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:23:46.367 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:23:46.367 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:23:46.367 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:23:46.369 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:23:46 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:23:46.369 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:23:46.369 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:23:46.369 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:23:46.369 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:23:46.369 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:23:46.369 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 14:23:46.369 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:23:46.369 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:23:46.369 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 14:23:46.370 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:23:46.370 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:23:46.380 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:23:46.381 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3169dbfe0>
2025-04-22 14:23:46.381 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:23:46.381 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:23:46.381 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:23:46.381 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:23:46.382 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:23:47.687 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:23:47 GMT'), (b'Content-Length', b'1100')])
2025-04-22 14:23:47.687 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:23:47.687 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:23:47.688 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:23:47.688 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:23:47.688 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:23:47.688 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.31초
2025-04-22 14:23:47.689 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.32초
2025-04-22 14:23:47.689 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:23:47.689 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:23:47.689 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.32 seconds
2025-04-22 14:23:47.689 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study abroad in Korea, but I need to know what qualifications and grades are required.",
  "lang_code": "ja"
}
2025-04-22 14:23:47.689 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:23:47.690 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study abroad in Korea, but I need to know what qualifications and grades are required.
2025-04-22 14:23:47.690 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: ja
2025-04-22 14:23:47.690 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.34 seconds
2025-04-22 14:23:47.690 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: ja, 영어 번역: I want to study abroad in Korea, but I need to know what qualifications and grades are required.
2025-04-22 14:23:47.690 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=ja, english_query='I want to study abroad in Korea, but I need to know what qualifications and grades are required.'
2025-04-22 14:23:47.690 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:23:47.690 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I want to study abroad in Korea, but I need to know what qualifications and grades are required.
2025-04-22 14:23:47.691 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:23:47.691 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: daily_life
2025-04-22 14:23:47.691 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] daily_life 유형에서 컨텍스트 생성 시작
2025-04-22 14:23:47.691 | INFO     | app.services.common.rag_service:search:81 - [RAG] daily_life 도메인에서 문서 검색 시작: I want to study abroad in Korea, but I need to know what qualifications and grades are required.
2025-04-22 14:23:47.788 | ERROR    | app.services.common.rag_service:search:104 - 문서 검색 중 오류 발생: <RAGType.DAILY_LIFE: 'daily_life'>
2025-04-22 14:23:47.789 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:23:47.790 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:23:47.790 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:23:47.790 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study abroad in Korea, but I need to know what qualifications and grades are required.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:23:47.790 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:23:47.791 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:23:47.793 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:23:47.813 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:23:47.817 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3169da750>
2025-04-22 14:23:47.817 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:23:47.817 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:23:47.817 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:23:47.817 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:23:47.817 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:23:57.818 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:23:57.819 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:23:57.819 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:23:57.819 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.03초)
2025-04-22 14:23:57.820 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:23:57.820 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:23:57.820 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:23:57.820 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:23:57.820 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: ja, RAG type: daily_life
2025-04-22 14:23:57.820 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:23:57.820 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Japanese (code: ja)
2025-04-22 14:23:57.820 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Japanese. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:23:57.821 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:23:57.821 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:23:57.827 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:23:57.828 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3169dac90>
2025-04-22 14:23:57.829 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:23:57.829 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:23:57.829 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:23:57.829 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:23:57.829 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:23:58.307 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:23:58 GMT'), (b'Content-Length', b'749')])
2025-04-22 14:23:58.308 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:23:58.309 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:23:58.309 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:23:58.309 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:23:58.310 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:23:58.310 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.48초
2025-04-22 14:23:58.310 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.49초
2025-04-22 14:23:58.310 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:23:58.311 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:23:58.311 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 申し訳ありません。応答の生成中にエラーが発生しました。

2025-04-22 14:23:58.311 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Japanese): 申し訳ありません。応答の生成中にエラーが発生しました。

2025-04-22 14:23:58.311 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:23:58.311 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:23:58.311 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '申し訳ありません。応答の生成中にエラーが発生しました。
'
2025-04-22 14:23:58.311 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:24:16.060 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:24:16.062 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:24:16.269 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:24:16.473 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:24:16.956 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:24:17.158 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:24:17.360 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:24:17.562 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:24:18.547 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:24:19.231 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:24:19.234 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:24:19.681 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:24:19.685 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:24:19.687 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:24:19.689 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:24:19.691 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:24:19.692 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:24:19.694 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:24:19.695 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:24:19.695 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:24:19.695 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:24:19.695 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:24:19.695 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:24:19.695 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 申し訳ありません。応答の生成中にエラーが発生しました。
2025-04-22 14:24:19.695 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 申し訳ありません。応答の生成中にエラーが発生しました。
2025-04-22 14:24:19.695 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:24:19.695 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:24:19.696 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:24:19.702 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:24:19.703 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce20f0>
2025-04-22 14:24:19.703 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:24:19.703 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:24:19.703 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:24:19.703 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:24:19.703 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:24:20.233 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:24:21.389 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:24:21 GMT'), (b'Content-Length', b'995')])
2025-04-22 14:24:21.390 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:24:21.390 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:24:21.390 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:24:21.391 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:24:21.391 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:24:21.391 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.69초
2025-04-22 14:24:21.391 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.70초
2025-04-22 14:24:21.392 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:24:21.392 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:24:21.392 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: none
2025-04-22 14:24:21.392 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: none
2025-04-22 14:24:21.392 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: none
2025-04-22 14:24:21.392 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:24:21.392 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 申し訳ありません。応答の生成中にエラーが発生しました。
2025-04-22 14:24:21.393 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:24:21.393 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:24:21.394 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:24:21.394 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:24:21.411 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:24:21.412 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3169db7a0>
2025-04-22 14:24:21.412 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:24:21.413 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:24:21.413 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:24:21.413 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:24:21.413 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:24:21.414 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:24:21 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:24:21.415 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:24:21.415 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:24:21.415 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:24:21.415 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:24:21.415 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:24:21.415 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 14:24:21.415 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:24:21.415 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:24:21.415 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 14:24:21.416 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:24:21.416 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:24:21.422 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:24:21.423 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca5a90>
2025-04-22 14:24:21.423 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:24:21.423 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:24:21.423 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:24:21.423 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:24:21.423 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:24:22.623 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:24:22 GMT'), (b'Content-Length', b'1030')])
2025-04-22 14:24:22.624 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:24:22.624 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:24:22.624 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:24:22.624 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:24:22.625 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:24:22.625 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.20초
2025-04-22 14:24:22.625 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.21초
2025-04-22 14:24:22.625 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:24:22.625 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:24:22.626 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.21 seconds
2025-04-22 14:24:22.626 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I'm sorry. An error occurred during the generation of the response.",
  "lang_code": "ja"
}
2025-04-22 14:24:22.626 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:24:22.626 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I'm sorry. An error occurred during the generation of the response.
2025-04-22 14:24:22.626 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: ja
2025-04-22 14:24:22.626 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.23 seconds
2025-04-22 14:24:22.626 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: ja, 영어 번역: I'm sorry. An error occurred during the generation of the response.
2025-04-22 14:24:22.626 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=ja, english_query='I'm sorry. An error occurred during the generation of the response.'
2025-04-22 14:24:22.627 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:24:22.627 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I'm sorry. An error occurred during the generation of the response.
2025-04-22 14:24:22.627 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:24:22.628 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: none
2025-04-22 14:24:22.628 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:24:22.628 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I'm sorry. An error occurred during the generation of the response.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:24:22.628 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:24:22.629 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:24:22.630 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:24:22.641 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:24:22.647 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16ca190a0>
2025-04-22 14:24:22.647 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:24:22.647 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:24:22.648 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:24:22.648 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:24:22.648 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:24:24.106 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:24:24 GMT'), (b'Content-Length', b'1134')])
2025-04-22 14:24:24.106 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:24:24.107 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:24:24.107 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:24:24.107 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:24:24.108 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:24:24.108 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.47초
2025-04-22 14:24:24.108 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.48초
2025-04-22 14:24:24.108 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:24:24.108 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:24:24.109 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:71 - [응답 생성기] 응답 생성 완료: 287자
2025-04-22 14:24:24.109 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:72 - [RESPONSE] Generated response: Okay, I apologize for the error! Something went wrong while generating my response. I’m still under development and occasional glitches happen. 

Could you please try your request again? If the error persists, could you briefly describe what you were asking so I can investigate further?
2025-04-22 14:24:24.109 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:24:24.109 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Okay, I apologize for the error! Something went wrong while generating my response. I’m still under development and occasional glitches happen. 

Could you please try your request again? If the error persists, could you briefly describe what you were asking so I can investigate further?'
2025-04-22 14:24:24.109 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:24:24.109 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: ja, RAG type: none
2025-04-22 14:24:24.109 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Okay, I apologize for the error! Something went wrong while generating my response. I’m still under development and occasional glitches happen. 

Could you please try your request again? If the error persists, could you briefly describe what you were asking so I can investigate further?
2025-04-22 14:24:24.110 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Japanese (code: ja)
2025-04-22 14:24:24.110 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Japanese. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Okay, I apologize for the error! Something went wrong while generating my response. I’m still under development and occasional glitches happen. 

Could you please try your request again? If the error persists, could you briefly describe what you were asking so I can investigate further?
                
2025-04-22 14:24:24.110 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:24:24.111 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:24:24.125 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:24:24.127 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3169da720>
2025-04-22 14:24:24.127 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:24:24.127 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:24:24.127 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:24:24.127 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:24:24.128 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:24:25.833 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:24:25 GMT'), (b'Content-Length', b'1620')])
2025-04-22 14:24:25.834 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:24:25.834 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:24:25.834 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:24:25.835 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:24:25.835 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:24:25.835 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.71초
2025-04-22 14:24:25.835 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.73초
2025-04-22 14:24:25.836 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:24:25.836 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:24:25.836 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: わかりました。エラーのお詫びです！返信を生成する際に問題が発生しました。私はまだ開発段階であり、時々バグが発生します。

再度リクエストをお試しいただけますか？エラーが続く場合は、具体的にどのような質問をしていたのか簡単に教えていただけると、さらに調査できます。
2025-04-22 14:24:25.836 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Japanese): わかりました。エラーのお詫びです！返信を生成する際に問題が発生しました。私はまだ開発段階であり、時々バグが発生します。

再度リクエストをお試しいただけますか？エラーが続く場合は、具体的にどのような質問をしていたのか簡単に教えていただけると、さらに調査できます。
2025-04-22 14:24:25.836 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: False
2025-04-22 14:24:25.836 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:24:25.837 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: 'わかりました。エラーのお詫びです！返信を生成する際に問題が発生しました。私はまだ開発段階であり、時々バグが発生します。

再度リクエストをお試しいただけますか？エラーが続く場合は、具体的にどのような質問をしていたのか簡単に教えていただけると、さらに調査できます。'
2025-04-22 14:24:25.837 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:25:39.443 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:25:39.446 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:25:39.650 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:25:39.850 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:25:40.412 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:25:40.616 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:25:40.821 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:25:41.026 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:25:41.756 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:25:42.730 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:25:42.733 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:25:43.080 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:25:43.084 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:25:43.086 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:25:43.088 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:25:43.090 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:25:43.092 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:25:43.094 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:25:43.095 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:25:43.095 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:25:43.095 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:25:43.095 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:25:43.095 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:25:43.095 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:25:43.095 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:25:43.095 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:25:43.096 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:25:43.096 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:25:43.102 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:25:43.103 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318caf3e0>
2025-04-22 14:25:43.104 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:25:43.104 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:25:43.104 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:25:43.104 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:25:43.104 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:25:43.904 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:25:44.732 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:25:44 GMT'), (b'Content-Length', b'1021')])
2025-04-22 14:25:44.733 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:25:44.734 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:25:44.734 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:25:44.735 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:25:44.735 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:25:44.735 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.63초
2025-04-22 14:25:44.736 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.64초
2025-04-22 14:25:44.736 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:25:44.736 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:25:44.736 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 14:25:44.737 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 14:25:44.737 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 14:25:44.737 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:25:44.737 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:25:44.737 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:25:44.737 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:25:44.738 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:25:44.746 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:25:44.755 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:25:44.756 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318cad280>
2025-04-22 14:25:44.756 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:25:44.756 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:25:44.756 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:25:44.756 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:25:44.756 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:25:44.758 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:25:44 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:25:44.758 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:25:44.758 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:25:44.758 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:25:44.758 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:25:44.758 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:25:44.758 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 14:25:44.758 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:25:44.758 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:25:44.758 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 14:25:44.759 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:25:44.759 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:25:44.766 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:25:44.767 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca4d70>
2025-04-22 14:25:44.767 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:25:44.767 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:25:44.768 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:25:44.768 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:25:44.768 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:25:46.000 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:25:45 GMT'), (b'Content-Length', b'1056')])
2025-04-22 14:25:46.001 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:25:46.002 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:25:46.002 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:25:46.004 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:25:46.005 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:25:46.006 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.24초
2025-04-22 14:25:46.006 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.25초
2025-04-22 14:25:46.006 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:25:46.006 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:25:46.006 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.25 seconds
2025-04-22 14:25:46.006 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study in Korea. Please tell me what qualifications and scores I need.",
  "lang_code": "zh"
}
2025-04-22 14:25:46.006 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:25:46.006 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:25:46.007 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: zh
2025-04-22 14:25:46.007 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.27 seconds
2025-04-22 14:25:46.007 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: zh, 영어 번역: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:25:46.007 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=zh, english_query='I want to study in Korea. Please tell me what qualifications and scores I need.'
2025-04-22 14:25:46.007 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:25:46.007 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:25:46.007 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:25:46.007 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 14:25:46.007 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 14:25:46.007 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:25:46.143 | DEBUG    | logging:callHandlers:1762 - Starting component PersistentLocalHnswSegment
2025-04-22 14:25:46.144 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 14:25:46.144 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:25:46.144 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:25:46.145 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:25:46.145 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study in Korea. Please tell me what qualifications and scores I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:25:46.145 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:25:46.145 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:25:46.145 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:25:46.153 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:25:46.154 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318cc76e0>
2025-04-22 14:25:46.154 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:25:46.154 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:25:46.154 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:25:46.154 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:25:46.154 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:25:46.860 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:25:56.155 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:25:56.156 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:25:56.157 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:25:56.157 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.01초)
2025-04-22 14:25:56.158 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:25:56.158 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:25:56.158 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:25:56.159 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:25:56.159 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: zh, RAG type: visa_law
2025-04-22 14:25:56.159 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:25:56.159 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Chinese (code: zh)
2025-04-22 14:25:56.159 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Chinese. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:25:56.160 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:25:56.161 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:25:56.171 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:25:56.173 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318cad310>
2025-04-22 14:25:56.173 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:25:56.173 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:25:56.173 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:25:56.173 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:25:56.173 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:25:56.594 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:25:56 GMT'), (b'Content-Length', b'697')])
2025-04-22 14:25:56.596 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:25:56.596 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:25:56.597 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:25:56.597 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:25:56.597 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:25:56.598 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.43초
2025-04-22 14:25:56.598 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.44초
2025-04-22 14:25:56.598 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:25:56.599 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:25:56.599 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 抱歉，在生成回复时发生错误。

2025-04-22 14:25:56.599 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Chinese): 抱歉，在生成回复时发生错误。

2025-04-22 14:25:56.599 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:25:56.599 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:25:56.599 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '抱歉，在生成回复时发生错误。
'
2025-04-22 14:25:56.600 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:26:27.373 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:26:27.375 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:26:27.622 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:26:28.154 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:26:28.360 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:26:28.562 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:26:28.862 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:26:29.057 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:26:29.916 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:26:30.798 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:26:30.805 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:26:31.287 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:26:31.292 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:26:31.294 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:26:31.296 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:26:31.298 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:26:31.299 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:26:31.301 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:26:31.302 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:26:31.302 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:26:31.302 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:26:31.302 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:26:31.302 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:26:31.302 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:26:31.302 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:26:31.302 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:26:31.303 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:26:31.303 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:26:31.310 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:26:31.312 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca5df0>
2025-04-22 14:26:31.312 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:26:31.312 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:26:31.313 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:26:31.313 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:26:31.313 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:26:31.608 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:26:33.092 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:26:33 GMT'), (b'Content-Length', b'1021')])
2025-04-22 14:26:33.093 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:26:33.093 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:26:33.093 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:26:33.094 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:26:33.094 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:26:33.095 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.78초
2025-04-22 14:26:33.095 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.79초
2025-04-22 14:26:33.095 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:26:33.095 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:26:33.096 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 14:26:33.096 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 14:26:33.096 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 14:26:33.096 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:26:33.096 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:26:33.096 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:26:33.096 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:26:33.097 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:26:33.098 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:26:33.112 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:26:33.113 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca5880>
2025-04-22 14:26:33.114 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:26:33.114 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:26:33.114 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:26:33.114 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:26:33.114 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:26:33.116 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:26:33 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:26:33.116 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:26:33.116 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:26:33.116 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:26:33.116 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:26:33.116 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:26:33.116 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 14:26:33.117 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:26:33.117 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:26:33.117 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 14:26:33.117 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:26:33.118 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:26:33.125 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:26:33.127 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce3b90>
2025-04-22 14:26:33.127 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:26:33.127 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:26:33.127 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:26:33.127 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:26:33.127 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:26:34.364 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:26:34 GMT'), (b'Content-Length', b'1054')])
2025-04-22 14:26:34.365 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:26:34.365 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:26:34.365 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:26:34.365 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:26:34.366 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:26:34.366 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.24초
2025-04-22 14:26:34.366 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.25초
2025-04-22 14:26:34.366 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:26:34.367 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:26:34.367 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.25 seconds
2025-04-22 14:26:34.367 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study in Korea. Please tell me what qualifications and scores I need.",
  "lang_code": "zh"
}
2025-04-22 14:26:34.367 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:26:34.367 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:26:34.367 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: zh
2025-04-22 14:26:34.367 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.27 seconds
2025-04-22 14:26:34.367 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: zh, 영어 번역: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:26:34.368 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=zh, english_query='I want to study in Korea. Please tell me what qualifications and scores I need.'
2025-04-22 14:26:34.368 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:26:34.368 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:26:34.368 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:26:34.368 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 14:26:34.368 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 14:26:34.368 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:26:34.434 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 14:26:34.434 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:26:34.434 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:26:34.434 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:26:34.434 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study in Korea. Please tell me what qualifications and scores I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:26:34.434 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:26:34.435 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:26:34.435 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:26:34.442 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:26:34.445 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318c209b0>
2025-04-22 14:26:34.446 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:26:34.446 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:26:34.446 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:26:34.446 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:26:34.446 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:26:44.448 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:26:44.448 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:26:44.449 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:26:44.449 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.01초)
2025-04-22 14:26:44.450 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:26:44.450 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:26:44.450 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:26:44.450 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:26:44.451 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: zh, RAG type: visa_law
2025-04-22 14:26:44.451 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:26:44.451 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Chinese (code: zh)
2025-04-22 14:26:44.451 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Chinese. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:26:44.452 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:26:44.452 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:26:44.460 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:26:44.461 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce39e0>
2025-04-22 14:26:44.461 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:26:44.461 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:26:44.461 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:26:44.461 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:26:44.461 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:26:44.913 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:26:44 GMT'), (b'Content-Length', b'697')])
2025-04-22 14:26:44.914 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:26:44.914 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:26:44.914 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:26:44.914 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:26:44.914 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:26:44.915 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.46초
2025-04-22 14:26:44.915 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.46초
2025-04-22 14:26:44.915 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:26:44.915 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:26:44.915 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 抱歉，在生成回复时发生错误。

2025-04-22 14:26:44.916 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Chinese): 抱歉，在生成回复时发生错误。

2025-04-22 14:26:44.916 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:26:44.916 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:26:44.916 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '抱歉，在生成回复时发生错误。
'
2025-04-22 14:26:44.916 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:30:00.237 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:30:00.240 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:30:00.449 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:30:00.650 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:30:01.126 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:30:01.322 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:30:01.516 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:30:01.831 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:30:02.638 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:30:03.309 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:30:03.315 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:30:03.811 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:30:03.816 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:30:03.818 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:30:03.820 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:30:03.822 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:30:03.823 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:30:03.825 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:30:03.826 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:30:03.826 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:30:03.826 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:30:03.826 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:30:03.826 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:30:03.827 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:30:03.827 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:30:03.827 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:30:03.827 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:30:03.827 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:30:03.834 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:30:03.835 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce3050>
2025-04-22 14:30:03.835 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:30:03.835 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:30:03.835 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:30:03.836 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:30:03.836 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:30:04.340 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:30:05.594 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:30:05 GMT'), (b'Content-Length', b'1020')])
2025-04-22 14:30:05.595 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:30:05.596 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:30:05.596 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:30:05.596 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:30:05.597 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:30:05.597 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.76초
2025-04-22 14:30:05.597 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.77초
2025-04-22 14:30:05.597 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:30:05.597 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:30:05.598 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 14:30:05.598 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 14:30:05.598 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 14:30:05.598 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:30:05.598 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:30:05.598 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:30:05.598 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:30:05.599 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:30:05.600 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:30:05.770 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:30:05.771 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x33940bfe0>
2025-04-22 14:30:05.771 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:30:05.771 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:30:05.771 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:30:05.771 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:30:05.772 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:30:05.774 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:30:05 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:30:05.774 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:30:05.774 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:30:05.774 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:30:05.774 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:30:05.774 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:30:05.774 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.18초
2025-04-22 14:30:05.774 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:30:05.774 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:30:05.775 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.18 seconds
2025-04-22 14:30:05.775 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:30:05.775 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:30:05.781 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:30:05.782 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x339446930>
2025-04-22 14:30:05.782 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:30:05.782 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:30:05.782 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:30:05.782 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:30:05.782 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:30:07.038 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:30:07 GMT'), (b'Content-Length', b'1056')])
2025-04-22 14:30:07.038 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:30:07.039 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:30:07.039 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:30:07.039 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:30:07.039 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:30:07.039 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.26초
2025-04-22 14:30:07.040 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.26초
2025-04-22 14:30:07.040 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:30:07.040 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:30:07.042 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.27 seconds
2025-04-22 14:30:07.042 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study in Korea. Please tell me what qualifications and scores I need.",
  "lang_code": "zh"
}
2025-04-22 14:30:07.043 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:30:07.043 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:30:07.043 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: zh
2025-04-22 14:30:07.043 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.44 seconds
2025-04-22 14:30:07.043 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: zh, 영어 번역: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:30:07.043 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=zh, english_query='I want to study in Korea. Please tell me what qualifications and scores I need.'
2025-04-22 14:30:07.044 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:30:07.044 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:30:07.044 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:30:07.044 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 14:30:07.044 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 14:30:07.044 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:30:07.121 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 14:30:07.122 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:30:07.122 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:30:07.122 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:30:07.122 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study in Korea. Please tell me what qualifications and scores I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:30:07.122 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:30:07.122 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:30:07.123 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:30:07.129 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:30:07.130 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x339444d70>
2025-04-22 14:30:07.131 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:30:07.131 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:30:07.131 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:30:07.131 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:30:07.131 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:30:17.132 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:30:17.132 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:30:17.133 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:30:17.133 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.01초)
2025-04-22 14:30:17.134 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:30:17.134 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:30:17.134 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:30:17.134 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:30:17.135 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: zh, RAG type: visa_law
2025-04-22 14:30:17.135 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:30:17.135 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Chinese (code: zh)
2025-04-22 14:30:17.135 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Chinese. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:30:17.135 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:30:17.136 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:30:17.144 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:30:17.145 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x339454e00>
2025-04-22 14:30:17.145 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:30:17.145 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:30:17.146 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:30:17.146 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:30:17.146 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:30:17.662 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:30:17 GMT'), (b'Content-Length', b'697')])
2025-04-22 14:30:17.663 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:30:17.663 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:30:17.663 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:30:17.663 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:30:17.663 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:30:17.664 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.52초
2025-04-22 14:30:17.664 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.53초
2025-04-22 14:30:17.664 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:30:17.665 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:30:17.665 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 抱歉，在生成回复时出现错误。

2025-04-22 14:30:17.665 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Chinese): 抱歉，在生成回复时出现错误。

2025-04-22 14:30:17.665 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:30:17.665 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:30:17.666 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '抱歉，在生成回复时出现错误。
'
2025-04-22 14:30:17.666 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:30:22.429 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:30:22.667 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:30:22.863 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:30:23.069 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:30:23.269 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:30:23.471 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:30:23.667 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:30:23.883 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:30:24.924 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:30:25.690 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:30:25.696 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:30:26.153 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:30:26.165 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:30:26.167 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:30:26.169 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:30:26.171 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:30:26.173 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:30:26.175 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:30:26.175 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:30:26.176 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:30:26.176 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:30:26.176 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:30:26.176 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:30:26.176 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:30:26.176 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:30:26.176 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:30:26.177 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:30:26.178 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:30:26.185 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:30:26.187 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce2ba0>
2025-04-22 14:30:26.188 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:30:26.188 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:30:26.188 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:30:26.188 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:30:26.188 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:30:26.584 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:30:27.960 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:30:27 GMT'), (b'Content-Length', b'1021')])
2025-04-22 14:30:27.963 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:30:27.964 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:30:27.964 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:30:27.964 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:30:27.965 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:30:27.965 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.78초
2025-04-22 14:30:27.965 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.79초
2025-04-22 14:30:27.965 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:30:27.965 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:30:27.966 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 14:30:27.966 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 14:30:27.966 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 14:30:27.966 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:30:27.966 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:30:27.966 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:30:27.966 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:30:27.967 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:30:27.968 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:30:27.976 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:30:27.977 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318c20bc0>
2025-04-22 14:30:27.978 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:30:27.978 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:30:27.978 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:30:27.978 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:30:27.978 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:30:27.979 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:30:27 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:30:27.979 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:30:27.979 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:30:27.979 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:30:27.979 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:30:27.979 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:30:27.979 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.01초
2025-04-22 14:30:27.979 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:30:27.980 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:30:27.980 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.01 seconds
2025-04-22 14:30:27.980 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:30:27.980 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:30:27.989 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:30:27.991 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce0f20>
2025-04-22 14:30:27.991 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:30:27.991 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:30:27.991 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:30:27.991 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:30:27.991 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:30:29.209 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:30:29 GMT'), (b'Content-Length', b'1055')])
2025-04-22 14:30:29.211 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:30:29.212 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:30:29.213 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:30:29.213 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:30:29.213 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:30:29.213 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.22초
2025-04-22 14:30:29.214 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.23초
2025-04-22 14:30:29.214 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:30:29.214 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:30:29.214 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.23 seconds
2025-04-22 14:30:29.214 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study in Korea. Please tell me what qualifications and scores I need.",
  "lang_code": "zh"
}
2025-04-22 14:30:29.214 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:30:29.214 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:30:29.215 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: zh
2025-04-22 14:30:29.215 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.25 seconds
2025-04-22 14:30:29.215 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: zh, 영어 번역: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:30:29.215 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=zh, english_query='I want to study in Korea. Please tell me what qualifications and scores I need.'
2025-04-22 14:30:29.215 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:30:29.215 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:30:29.215 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:30:29.216 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 14:30:29.216 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 14:30:29.216 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:30:29.332 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 14:30:29.333 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:30:29.333 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:30:29.333 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:30:29.333 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study in Korea. Please tell me what qualifications and scores I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:30:29.333 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:30:29.333 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:30:29.334 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:30:29.341 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:30:29.345 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x33949d940>
2025-04-22 14:30:29.345 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:30:29.345 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:30:29.345 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:30:29.346 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:30:29.346 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:30:39.346 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:30:39.347 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:30:39.347 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:30:39.348 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.01초)
2025-04-22 14:30:39.349 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:30:39.350 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:30:39.350 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:30:39.350 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:30:39.351 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: zh, RAG type: visa_law
2025-04-22 14:30:39.351 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:30:39.351 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Chinese (code: zh)
2025-04-22 14:30:39.351 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Chinese. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:30:39.352 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:30:39.353 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:30:39.367 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:30:39.368 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31670a060>
2025-04-22 14:30:39.368 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:30:39.369 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:30:39.370 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:30:39.370 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:30:39.370 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:30:39.688 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:30:39 GMT'), (b'Content-Length', b'696')])
2025-04-22 14:30:39.688 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:30:39.689 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:30:39.689 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:30:39.689 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:30:39.689 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:30:39.690 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.32초
2025-04-22 14:30:39.690 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.34초
2025-04-22 14:30:39.690 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:30:39.690 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:30:39.690 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 抱歉，在生成回复时发生错误。

2025-04-22 14:30:39.690 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Chinese): 抱歉，在生成回复时发生错误。

2025-04-22 14:30:39.691 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:30:39.691 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:30:39.691 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '抱歉，在生成回复时发生错误。
'
2025-04-22 14:30:39.691 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:34:48.490 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:34:48.500 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:34:48.503 | DEBUG    | logging:callHandlers:1762 - Resetting dropped connection: huggingface.co
2025-04-22 14:34:48.824 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:34:49.038 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:34:49.526 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:34:49.725 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:34:49.949 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:34:50.158 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:34:50.898 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:34:51.586 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:34:51.592 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:34:52.066 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:34:52.071 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:34:52.073 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:34:52.075 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:34:52.077 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:34:52.079 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:34:52.080 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:34:52.081 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:34:52.081 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:34:52.081 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:34:52.081 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:34:52.081 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:34:52.081 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:34:52.081 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:34:52.081 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:34:52.082 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:34:52.082 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:34:52.088 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:34:52.089 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca7620>
2025-04-22 14:34:52.089 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:34:52.090 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:34:52.090 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:34:52.090 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:34:52.090 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:34:52.782 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:34:53.888 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:34:53 GMT'), (b'Content-Length', b'1021')])
2025-04-22 14:34:53.889 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:34:53.889 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:34:53.889 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:34:53.889 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:34:53.890 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:34:53.890 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.80초
2025-04-22 14:34:53.890 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.81초
2025-04-22 14:34:53.890 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:34:53.891 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:34:53.891 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 14:34:53.891 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 14:34:53.892 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 14:34:53.892 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:34:53.892 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:34:53.892 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:34:53.892 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:34:53.893 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:34:53.894 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:34:53.903 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:34:53.904 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca6ff0>
2025-04-22 14:34:53.905 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:34:53.905 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:34:53.905 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:34:53.905 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:34:53.905 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:34:53.906 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:34:53 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:34:53.906 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:34:53.906 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:34:53.906 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:34:53.906 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:34:53.907 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:34:53.907 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.01초
2025-04-22 14:34:53.907 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:34:53.907 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:34:53.907 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.01 seconds
2025-04-22 14:34:53.907 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:34:53.907 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:34:53.917 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:34:53.918 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x101ac5b20>
2025-04-22 14:34:53.918 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:34:53.918 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:34:53.918 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:34:53.918 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:34:53.918 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:34:55.162 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:34:55 GMT'), (b'Content-Length', b'1055')])
2025-04-22 14:34:55.163 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:34:55.163 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:34:55.164 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:34:55.164 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:34:55.164 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:34:55.164 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.25초
2025-04-22 14:34:55.165 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.26초
2025-04-22 14:34:55.165 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:34:55.165 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:34:55.165 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.26 seconds
2025-04-22 14:34:55.165 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study in Korea. Please tell me what qualifications and scores I need.",
  "lang_code": "zh"
}
2025-04-22 14:34:55.165 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:34:55.166 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:34:55.166 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: zh
2025-04-22 14:34:55.166 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.27 seconds
2025-04-22 14:34:55.166 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: zh, 영어 번역: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:34:55.166 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=zh, english_query='I want to study in Korea. Please tell me what qualifications and scores I need.'
2025-04-22 14:34:55.166 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:34:55.166 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:34:55.167 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:34:55.167 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 14:34:55.167 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 14:34:55.167 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:34:55.250 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 14:34:55.250 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:34:55.250 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:34:55.251 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:34:55.251 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study in Korea. Please tell me what qualifications and scores I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:34:55.251 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:34:55.251 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:34:55.252 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:34:55.260 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:34:55.264 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318c57ad0>
2025-04-22 14:34:55.264 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:34:55.265 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:34:55.265 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:34:55.265 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:34:55.265 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:35:05.267 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:35:05.268 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:35:05.269 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:35:05.269 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.02초)
2025-04-22 14:35:05.270 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:35:05.270 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:35:05.270 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:35:05.271 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:35:05.271 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: zh, RAG type: visa_law
2025-04-22 14:35:05.271 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:35:05.271 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Chinese (code: zh)
2025-04-22 14:35:05.271 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Chinese. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:35:05.272 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:35:05.273 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:35:05.281 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:35:05.283 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca5df0>
2025-04-22 14:35:05.283 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:35:05.283 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:35:05.283 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:35:05.283 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:35:05.283 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:35:05.565 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:35:05 GMT'), (b'Content-Length', b'686')])
2025-04-22 14:35:05.566 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:35:05.566 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:35:05.566 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:35:05.566 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:35:05.567 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:35:05.567 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.29초
2025-04-22 14:35:05.567 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.30초
2025-04-22 14:35:05.567 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:35:05.568 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:35:05.568 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 抱歉，生成响应时发生错误。

2025-04-22 14:35:05.568 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Chinese): 抱歉，生成响应时发生错误。

2025-04-22 14:35:05.568 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:35:05.568 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:35:05.568 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '抱歉，生成响应时发生错误。
'
2025-04-22 14:35:05.569 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:35:25.286 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:35:25.287 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:35:26.503 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:35:26.699 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:35:27.153 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:35:27.373 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:35:27.580 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:35:27.786 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:35:28.522 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:35:29.256 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:35:29.262 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:35:29.723 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:35:29.729 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:35:29.731 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:35:29.732 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:35:29.734 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:35:29.736 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:35:29.738 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:35:29.739 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:35:29.739 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:35:29.739 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:35:29.739 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:35:29.739 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:35:29.739 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:35:29.739 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:35:29.739 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:35:29.740 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:35:29.740 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:35:29.746 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:35:29.748 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x339445eb0>
2025-04-22 14:35:29.748 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:35:29.748 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:35:29.748 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:35:29.748 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:35:29.748 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:35:30.306 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:35:31.534 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:35:31 GMT'), (b'Content-Length', b'1021')])
2025-04-22 14:35:31.535 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:35:31.536 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:35:31.536 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:35:31.536 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:35:31.536 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:35:31.537 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.79초
2025-04-22 14:35:31.537 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.80초
2025-04-22 14:35:31.537 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:35:31.537 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:35:31.537 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 14:35:31.537 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 14:35:31.538 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 14:35:31.538 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:35:31.538 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:35:31.538 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:35:31.538 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:35:31.539 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:35:31.540 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:35:31.555 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:35:31.557 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3169dac00>
2025-04-22 14:35:31.557 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:35:31.557 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:35:31.557 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:35:31.557 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:35:31.557 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:35:31.559 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:35:31 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:35:31.559 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:35:31.559 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:35:31.559 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:35:31.559 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:35:31.559 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:35:31.559 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 14:35:31.559 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:35:31.560 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:35:31.560 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 14:35:31.560 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:35:31.560 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:35:31.567 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:35:31.568 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x339446570>
2025-04-22 14:35:31.568 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:35:31.568 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:35:31.568 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:35:31.568 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:35:31.568 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:35:32.809 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:35:32 GMT'), (b'Content-Length', b'1056')])
2025-04-22 14:35:32.809 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:35:32.809 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:35:32.809 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:35:32.809 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:35:32.809 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:35:32.809 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.24초
2025-04-22 14:35:32.809 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.25초
2025-04-22 14:35:32.810 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:35:32.810 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:35:32.810 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.25 seconds
2025-04-22 14:35:32.810 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study in Korea. Please tell me what qualifications and scores I need.",
  "lang_code": "zh"
}
2025-04-22 14:35:32.810 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:35:32.810 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:35:32.810 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: zh
2025-04-22 14:35:32.810 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.27 seconds
2025-04-22 14:35:32.810 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: zh, 영어 번역: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:35:32.810 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=zh, english_query='I want to study in Korea. Please tell me what qualifications and scores I need.'
2025-04-22 14:35:32.811 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:35:32.811 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:35:32.811 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:35:32.811 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 14:35:32.811 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 14:35:32.811 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:35:32.894 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 14:35:32.894 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:35:32.894 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:35:32.894 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:35:32.894 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study in Korea. Please tell me what qualifications and scores I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:35:32.894 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:35:32.895 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:35:32.895 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:35:32.902 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:35:32.906 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x339447170>
2025-04-22 14:35:32.906 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:35:32.907 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:35:32.907 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:35:32.907 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:35:32.907 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:35:42.907 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:35:42.909 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:35:42.910 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:35:42.910 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.02초)
2025-04-22 14:35:42.911 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:35:42.912 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:35:42.912 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:35:42.912 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:35:42.912 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: zh, RAG type: visa_law
2025-04-22 14:35:42.913 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:35:42.913 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Chinese (code: zh)
2025-04-22 14:35:42.913 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Chinese. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:35:42.913 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:35:42.914 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:35:42.925 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:35:42.927 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x339447770>
2025-04-22 14:35:42.927 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:35:42.927 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:35:42.927 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:35:42.927 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:35:42.927 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:35:43.209 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:35:43 GMT'), (b'Content-Length', b'686')])
2025-04-22 14:35:43.210 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:35:43.210 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:35:43.210 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:35:43.210 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:35:43.210 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:35:43.211 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.29초
2025-04-22 14:35:43.211 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.30초
2025-04-22 14:35:43.211 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:35:43.211 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:35:43.212 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 抱歉，生成回复时出现错误。

2025-04-22 14:35:43.212 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Chinese): 抱歉，生成回复时出现错误。

2025-04-22 14:35:43.212 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:35:43.212 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:35:43.212 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '抱歉，生成回复时出现错误。
'
2025-04-22 14:35:43.212 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:41:26.467 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:41:26.468 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:41:26.470 | DEBUG    | logging:callHandlers:1762 - Resetting dropped connection: huggingface.co
2025-04-22 14:41:26.739 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:41:26.948 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:41:27.389 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:41:27.596 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:41:27.798 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:41:28.000 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:41:28.518 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:41:29.155 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6096
2025-04-22 14:41:29.161 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:41:29.497 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:41:29.502 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:41:29.504 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:41:29.506 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:41:29.508 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:41:29.510 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:41:29.512 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:41:29.512 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:41:29.512 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:41:29.512 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:41:29.512 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:41:29.512 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:41:29.512 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:41:29.512 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:41:29.512 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:41:29.512 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:41:29.513 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:41:29.519 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:41:29.520 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce07d0>
2025-04-22 14:41:29.520 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:41:29.520 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:41:29.520 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:41:29.520 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:41:29.520 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:41:29.938 | DEBUG    | logging:callHandlers:1762 - Resetting dropped connection: us.i.posthog.com
2025-04-22 14:41:30.568 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:41:33.208 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:41:33 GMT'), (b'Content-Length', b'1023')])
2025-04-22 14:41:33.209 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:41:33.209 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:41:33.210 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:41:33.210 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:41:33.210 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:41:33.210 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 3.69초
2025-04-22 14:41:33.211 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 3.70초
2025-04-22 14:41:33.211 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:41:33.211 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:41:33.212 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 14:41:33.213 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 14:41:33.213 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 14:41:33.213 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:41:33.213 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:41:33.214 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:41:33.214 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:41:33.215 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:41:33.216 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:41:33.226 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:41:33.227 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x152b03c80>
2025-04-22 14:41:33.227 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:41:33.228 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:41:33.228 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:41:33.228 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:41:33.228 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:41:33.229 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:41:33 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:41:33.230 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:41:33.230 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:41:33.230 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:41:33.230 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:41:33.230 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:41:33.230 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 14:41:33.230 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:41:33.230 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:41:33.231 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 14:41:33.231 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:41:33.231 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:41:33.238 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:41:33.239 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318cac5f0>
2025-04-22 14:41:33.239 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:41:33.239 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:41:33.239 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:41:33.239 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:41:33.239 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:41:34.448 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:41:34 GMT'), (b'Content-Length', b'1055')])
2025-04-22 14:41:34.449 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:41:34.449 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:41:34.449 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:41:34.450 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:41:34.450 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:41:34.450 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.21초
2025-04-22 14:41:34.450 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.22초
2025-04-22 14:41:34.451 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:41:34.451 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:41:34.451 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.22 seconds
2025-04-22 14:41:34.451 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study in Korea. Please tell me what qualifications and scores I need.",
  "lang_code": "zh"
}
2025-04-22 14:41:34.451 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:41:34.451 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:41:34.452 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: zh
2025-04-22 14:41:34.452 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.24 seconds
2025-04-22 14:41:34.452 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: zh, 영어 번역: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:41:34.452 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=zh, english_query='I want to study in Korea. Please tell me what qualifications and scores I need.'
2025-04-22 14:41:34.452 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:41:34.452 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:41:34.452 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:41:34.453 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 14:41:34.453 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 14:41:34.453 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:41:34.555 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 14:41:34.556 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:41:34.556 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:41:34.556 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:41:34.556 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study in Korea. Please tell me what qualifications and scores I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:41:34.556 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:41:34.557 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:41:34.558 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:41:34.563 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:41:34.566 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318c57950>
2025-04-22 14:41:34.566 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:41:34.567 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:41:34.567 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:41:34.567 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:41:34.567 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:41:44.567 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:41:44.567 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:41:44.568 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:41:44.568 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.01초)
2025-04-22 14:41:44.569 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:41:44.570 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:41:44.570 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:41:44.570 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:41:44.570 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: zh, RAG type: visa_law
2025-04-22 14:41:44.570 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:41:44.571 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Chinese (code: zh)
2025-04-22 14:41:44.571 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Chinese. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:41:44.571 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:41:44.572 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:41:44.584 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:41:44.586 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318cad670>
2025-04-22 14:41:44.587 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:41:44.587 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:41:44.587 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:41:44.587 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:41:44.587 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:41:44.975 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:41:44 GMT'), (b'Content-Length', b'687')])
2025-04-22 14:41:44.976 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:41:44.976 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:41:44.976 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:41:44.977 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:41:44.977 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:41:44.978 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.39초
2025-04-22 14:41:44.978 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.41초
2025-04-22 14:41:44.980 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:41:44.980 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:41:44.980 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 抱歉，生成响应时出现错误。

2025-04-22 14:41:44.980 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Chinese): 抱歉，生成响应时出现错误。

2025-04-22 14:41:44.980 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:41:44.981 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:41:44.981 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '抱歉，生成响应时出现错误。
'
2025-04-22 14:41:44.982 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:45:11.631 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:45:11.632 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:45:11.828 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:45:12.029 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:45:12.558 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:45:12.913 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:45:13.121 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:45:13.320 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:45:13.994 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:45:14.682 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:45:14.688 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:45:15.163 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:45:15.168 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:45:15.170 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:45:15.172 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:45:15.174 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:45:15.176 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:45:15.178 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:45:15.178 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:45:15.178 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:45:15.178 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:45:15.178 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:45:15.179 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:45:15.179 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:45:15.179 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:45:15.179 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:45:15.179 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:45:15.179 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:45:15.186 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:45:15.188 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca4e00>
2025-04-22 14:45:15.188 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:45:15.188 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:45:15.188 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:45:15.188 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:45:15.188 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:45:15.685 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:45:16.979 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:45:16 GMT'), (b'Content-Length', b'1021')])
2025-04-22 14:45:16.980 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:45:16.980 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:45:16.981 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:45:16.981 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:45:16.981 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:45:16.982 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.80초
2025-04-22 14:45:16.982 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.80초
2025-04-22 14:45:16.982 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:45:16.982 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:45:16.983 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 14:45:16.983 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 14:45:16.983 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 14:45:16.983 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:45:16.983 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:45:16.984 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:45:16.984 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:45:16.984 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:45:16.985 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:45:16.994 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:45:16.995 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca7950>
2025-04-22 14:45:16.995 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:45:16.995 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:45:16.996 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:45:16.996 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:45:16.996 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:45:16.997 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:45:16 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:45:16.997 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:45:16.997 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:45:16.997 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:45:16.997 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:45:16.997 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:45:16.998 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.01초
2025-04-22 14:45:16.998 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:45:16.998 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:45:16.998 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.01 seconds
2025-04-22 14:45:16.998 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:45:16.999 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:45:17.004 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:45:17.005 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16c9ef9b0>
2025-04-22 14:45:17.005 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:45:17.006 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:45:17.006 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:45:17.006 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:45:17.006 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:45:18.235 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:45:18 GMT'), (b'Content-Length', b'1056')])
2025-04-22 14:45:18.236 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:45:18.237 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:45:18.237 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:45:18.237 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:45:18.237 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:45:18.238 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.23초
2025-04-22 14:45:18.239 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.24초
2025-04-22 14:45:18.239 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:45:18.239 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:45:18.239 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.24 seconds
2025-04-22 14:45:18.239 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study in Korea. Please tell me what qualifications and scores I need.",
  "lang_code": "zh"
}
2025-04-22 14:45:18.240 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:45:18.240 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:45:18.240 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: zh
2025-04-22 14:45:18.240 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.26 seconds
2025-04-22 14:45:18.240 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: zh, 영어 번역: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:45:18.240 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=zh, english_query='I want to study in Korea. Please tell me what qualifications and scores I need.'
2025-04-22 14:45:18.241 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:45:18.241 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:45:18.241 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:45:18.241 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 14:45:18.241 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 14:45:18.242 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:45:18.375 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 14:45:18.375 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:45:18.375 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:45:18.376 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:45:18.376 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study in Korea. Please tell me what qualifications and scores I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:45:18.376 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:45:18.376 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:45:18.376 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:45:18.382 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:45:18.386 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16c9efdd0>
2025-04-22 14:45:18.386 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:45:18.386 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:45:18.386 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:45:18.386 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:45:18.386 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:45:28.386 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:45:28.387 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:45:28.387 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:45:28.388 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.01초)
2025-04-22 14:45:28.389 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:45:28.389 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:45:28.389 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:45:28.390 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:45:28.390 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: zh, RAG type: visa_law
2025-04-22 14:45:28.390 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:45:28.390 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Chinese (code: zh)
2025-04-22 14:45:28.390 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Chinese. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:45:28.391 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:45:28.393 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:45:28.404 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:45:28.405 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca74a0>
2025-04-22 14:45:28.405 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:45:28.405 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:45:28.405 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:45:28.406 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:45:28.406 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:45:28.799 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:45:28 GMT'), (b'Content-Length', b'687')])
2025-04-22 14:45:28.799 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:45:28.799 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:45:28.799 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:45:28.799 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:45:28.800 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:45:28.800 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.40초
2025-04-22 14:45:28.800 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.41초
2025-04-22 14:45:28.800 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:45:28.800 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:45:28.800 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 抱歉，生成响应时出现错误。

2025-04-22 14:45:28.800 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Chinese): 抱歉，生成响应时出现错误。

2025-04-22 14:45:28.800 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:45:28.800 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:45:28.800 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '抱歉，生成响应时出现错误。
'
2025-04-22 14:45:28.801 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:45:56.561 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:45:56.561 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:45:56.781 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:45:57.118 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:45:57.629 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:45:58.095 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:45:58.290 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:45:58.581 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:45:59.308 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:46:00.056 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:46:00.070 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:46:00.499 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:46:00.511 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:46:00.513 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:46:00.516 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:46:00.518 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:46:00.520 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:46:00.522 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:46:00.522 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:46:00.522 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:46:00.522 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:46:00.522 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:46:00.522 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:46:00.522 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:46:00.522 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:46:00.522 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:46:00.523 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:46:00.523 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:46:00.530 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:46:00.531 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x339446c00>
2025-04-22 14:46:00.531 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:46:00.531 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:46:00.531 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:46:00.531 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:46:00.531 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:46:00.987 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:46:02.306 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:46:02 GMT'), (b'Content-Length', b'1019')])
2025-04-22 14:46:02.307 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:46:02.308 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:46:02.308 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:46:02.308 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:46:02.308 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:46:02.308 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.78초
2025-04-22 14:46:02.309 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.79초
2025-04-22 14:46:02.309 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:46:02.309 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:46:02.309 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 14:46:02.309 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 14:46:02.309 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 14:46:02.310 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:46:02.310 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: 我想去韩国留学。请告诉我需要什么资格和成绩。
2025-04-22 14:46:02.310 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:46:02.310 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:46:02.311 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:46:02.311 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:46:02.326 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:46:02.330 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318c57b00>
2025-04-22 14:46:02.330 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:46:02.330 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:46:02.330 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:46:02.330 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:46:02.330 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:46:02.331 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:46:02 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:46:02.332 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:46:02.332 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:46:02.332 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:46:02.332 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:46:02.332 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:46:02.332 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 14:46:02.332 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:46:02.332 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:46:02.333 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 14:46:02.333 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:46:02.333 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:46:02.342 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:46:02.343 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3394441a0>
2025-04-22 14:46:02.343 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:46:02.343 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:46:02.344 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:46:02.344 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:46:02.344 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:46:03.579 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:46:03 GMT'), (b'Content-Length', b'1056')])
2025-04-22 14:46:03.580 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:46:03.580 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:46:03.581 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:46:03.581 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:46:03.581 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:46:03.581 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.24초
2025-04-22 14:46:03.581 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.25초
2025-04-22 14:46:03.582 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:46:03.582 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:46:03.582 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.25 seconds
2025-04-22 14:46:03.582 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study in Korea. Please tell me what qualifications and scores I need.",
  "lang_code": "zh"
}
2025-04-22 14:46:03.582 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:46:03.582 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:46:03.583 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: zh
2025-04-22 14:46:03.583 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.27 seconds
2025-04-22 14:46:03.583 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: zh, 영어 번역: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:46:03.583 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=zh, english_query='I want to study in Korea. Please tell me what qualifications and scores I need.'
2025-04-22 14:46:03.583 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:46:03.583 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:46:03.583 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:46:03.583 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 14:46:03.584 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 14:46:03.584 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I want to study in Korea. Please tell me what qualifications and scores I need.
2025-04-22 14:46:03.660 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 14:46:03.660 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:46:03.661 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:46:03.661 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:46:03.661 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study in Korea. Please tell me what qualifications and scores I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:46:03.661 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:46:03.661 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:46:03.662 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:46:03.668 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:46:03.669 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x339456d80>
2025-04-22 14:46:03.670 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:46:03.670 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:46:03.670 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:46:03.670 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:46:03.670 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:46:13.671 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:46:13.676 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:46:13.676 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:46:13.676 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.02초)
2025-04-22 14:46:13.678 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:46:13.678 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:46:13.678 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:46:13.678 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:46:13.678 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: zh, RAG type: visa_law
2025-04-22 14:46:13.678 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:46:13.679 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Chinese (code: zh)
2025-04-22 14:46:13.679 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Chinese. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:46:13.679 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:46:13.680 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:46:13.691 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:46:13.692 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x339445280>
2025-04-22 14:46:13.692 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:46:13.692 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:46:13.692 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:46:13.692 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:46:13.693 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:46:14.060 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:46:14 GMT'), (b'Content-Length', b'676')])
2025-04-22 14:46:14.061 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:46:14.061 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:46:14.061 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:46:14.061 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:46:14.062 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:46:14.062 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.37초
2025-04-22 14:46:14.062 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.38초
2025-04-22 14:46:14.062 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:46:14.063 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:46:14.063 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: 抱歉，生成响应时出错。

2025-04-22 14:46:14.063 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Chinese): 抱歉，生成响应时出错。

2025-04-22 14:46:14.063 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:46:14.063 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:46:14.064 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: '抱歉，生成响应时出错。
'
2025-04-22 14:46:14.064 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:48:29.798 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:48:29.800 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:48:30.237 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:48:30.434 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:48:30.758 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:48:30.965 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:48:31.284 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:48:31.506 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:48:32.855 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:48:33.579 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:48:33.583 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:48:34.008 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:48:34.016 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:48:34.018 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:48:34.020 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:48:34.022 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:48:34.024 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:48:34.026 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:48:34.026 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:48:34.026 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:48:34.026 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:48:34.026 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:48:34.026 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:48:34.026 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: Мен Кореяда шетелде оқығым келеді. Маған қандай біліктілік пен баға керек екенін айтыңызшы.
2025-04-22 14:48:34.026 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: Мен Кореяда шетелде оқығым келеді. Маған қандай біліктілік пен баға керек екенін айтыңызшы.
2025-04-22 14:48:34.026 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:48:34.027 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:48:34.027 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:48:34.034 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:48:34.035 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce3aa0>
2025-04-22 14:48:34.036 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:48:34.036 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:48:34.036 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:48:34.036 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:48:34.036 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:48:34.743 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:48:35.808 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:48:35 GMT'), (b'Content-Length', b'1143')])
2025-04-22 14:48:35.809 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:48:35.809 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:48:35.810 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:48:35.810 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:48:35.810 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:48:35.810 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.78초
2025-04-22 14:48:35.811 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.78초
2025-04-22 14:48:35.811 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:48:35.811 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:48:35.811 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 14:48:35.811 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 14:48:35.811 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 14:48:35.811 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:48:35.811 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: Мен Кореяда шетелде оқығым келеді. Маған қандай біліктілік пен баға керек екенін айтыңызшы.
2025-04-22 14:48:35.811 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:48:35.811 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:48:35.812 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:48:35.812 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:48:35.821 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:48:35.822 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce2cf0>
2025-04-22 14:48:35.822 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:48:35.823 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:48:35.823 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:48:35.823 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:48:35.823 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:48:35.824 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:48:35 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:48:35.824 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:48:35.824 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:48:35.824 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:48:35.824 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:48:35.824 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:48:35.825 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.01초
2025-04-22 14:48:35.825 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:48:35.825 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:48:35.825 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.01 seconds
2025-04-22 14:48:35.825 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:48:35.825 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:48:35.835 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:48:35.836 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce0b60>
2025-04-22 14:48:35.836 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:48:35.836 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:48:35.836 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:48:35.836 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:48:35.836 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:48:37.087 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:48:37 GMT'), (b'Content-Length', b'1195')])
2025-04-22 14:48:37.088 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:48:37.088 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:48:37.088 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:48:37.089 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:48:37.089 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:48:37.089 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.25초
2025-04-22 14:48:37.090 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.26초
2025-04-22 14:48:37.090 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:48:37.090 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:48:37.090 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.27 seconds
2025-04-22 14:48:37.090 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study in Korea abroad. Please tell me what qualifications and price I need?",
  "lang_code": "kk"
}
2025-04-22 14:48:37.090 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:48:37.091 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study in Korea abroad. Please tell me what qualifications and price I need?
2025-04-22 14:48:37.091 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: kk
2025-04-22 14:48:37.091 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.28 seconds
2025-04-22 14:48:37.091 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: kk, 영어 번역: I want to study in Korea abroad. Please tell me what qualifications and price I need?
2025-04-22 14:48:37.091 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=kk, english_query='I want to study in Korea abroad. Please tell me what qualifications and price I need?'
2025-04-22 14:48:37.091 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:48:37.091 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I want to study in Korea abroad. Please tell me what qualifications and price I need?
2025-04-22 14:48:37.092 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:48:37.092 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 14:48:37.092 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 14:48:37.092 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I want to study in Korea abroad. Please tell me what qualifications and price I need?
2025-04-22 14:48:37.275 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 14:48:37.276 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:48:37.276 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:48:37.276 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:48:37.276 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study in Korea abroad. Please tell me what qualifications and price I need?
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:48:37.276 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:48:37.276 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:48:37.277 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:48:37.282 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:48:37.285 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce0b60>
2025-04-22 14:48:37.286 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:48:37.286 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:48:37.286 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:48:37.286 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:48:37.286 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:48:47.288 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:48:47.288 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:48:47.288 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:48:47.289 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.01초)
2025-04-22 14:48:47.289 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:48:47.290 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:48:47.290 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:48:47.290 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:48:47.290 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: kk, RAG type: visa_law
2025-04-22 14:48:47.290 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:48:47.291 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to kk (code: kk)
2025-04-22 14:48:47.291 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to kk. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:48:47.291 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:48:47.292 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:48:47.303 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:48:47.304 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce2b70>
2025-04-22 14:48:47.304 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:48:47.304 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:48:47.304 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:48:47.305 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:48:47.305 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:48:48.093 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:48:48 GMT'), (b'Content-Length', b'750')])
2025-04-22 14:48:48.094 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:48:48.094 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:48:48.094 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:48:48.094 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:48:48.095 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:48:48.095 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.79초
2025-04-22 14:48:48.095 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.80초
2025-04-22 14:48:48.095 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:48:48.096 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:48:48.096 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: Ngem, kuol ngei diew ngor giang diew kuol giang diew.
2025-04-22 14:48:48.096 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (kk): Ngem, kuol ngei diew ngor giang diew kuol giang diew.
2025-04-22 14:48:48.096 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:48:48.096 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:48:48.096 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: 'Ngem, kuol ngei diew ngor giang diew kuol giang diew.'
2025-04-22 14:48:48.096 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:49:40.821 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:49:40.823 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:49:41.031 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:49:41.236 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:49:41.744 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:49:41.942 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:49:42.143 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:49:42.347 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:49:43.126 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:49:43.819 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:49:43.826 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:49:44.313 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:49:44.318 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:49:44.321 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:49:44.323 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:49:44.325 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:49:44.327 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:49:44.328 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:49:44.328 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:49:44.328 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:49:44.329 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:49:44.329 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:49:44.329 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:49:44.329 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: Ich möchte im Ausland in Korea studieren. Bitte teilen Sie mir mit, welche Qualifikationen und Noten ich benötige..
2025-04-22 14:49:44.329 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: Ich möchte im Ausland in Korea studieren. Bitte teilen Sie mir mit, welche Qualifikationen und Noten ich benötige..
2025-04-22 14:49:44.329 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:49:44.329 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:49:44.330 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:49:44.336 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:49:44.338 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca7f50>
2025-04-22 14:49:44.338 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:49:44.338 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:49:44.338 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:49:44.338 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:49:44.338 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:49:45.065 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:49:46.156 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:49:46 GMT'), (b'Content-Length', b'1072')])
2025-04-22 14:49:46.156 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:49:46.157 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:49:46.157 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:49:46.157 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:49:46.158 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:49:46.159 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.82초
2025-04-22 14:49:46.159 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.83초
2025-04-22 14:49:46.160 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:49:46.160 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:49:46.160 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 14:49:46.160 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 14:49:46.160 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 14:49:46.161 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:49:46.161 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: Ich möchte im Ausland in Korea studieren. Bitte teilen Sie mir mit, welche Qualifikationen und Noten ich benötige..
2025-04-22 14:49:46.163 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:49:46.164 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:49:46.171 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:49:46.175 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:49:46.203 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:49:46.205 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318c57da0>
2025-04-22 14:49:46.205 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:49:46.206 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:49:46.206 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:49:46.206 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:49:46.206 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:49:46.208 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:49:46 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:49:46.208 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:49:46.208 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:49:46.208 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:49:46.208 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:49:46.208 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:49:46.209 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.04초
2025-04-22 14:49:46.209 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:49:46.209 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:49:46.209 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.04 seconds
2025-04-22 14:49:46.209 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:49:46.210 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:49:46.215 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:49:46.217 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca6540>
2025-04-22 14:49:46.217 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:49:46.217 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:49:46.217 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:49:46.217 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:49:46.217 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:49:47.531 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:49:47 GMT'), (b'Content-Length', b'1148')])
2025-04-22 14:49:47.533 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:49:47.533 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:49:47.534 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:49:47.534 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:49:47.534 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:49:47.535 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.32초
2025-04-22 14:49:47.535 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.33초
2025-04-22 14:49:47.535 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:49:47.535 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:49:47.535 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.33 seconds
2025-04-22 14:49:47.536 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I would like to study in Korea abroad. Please let me know what qualifications and grades I need.",
  "lang_code": "de"
}
2025-04-22 14:49:47.536 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:49:47.536 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I would like to study in Korea abroad. Please let me know what qualifications and grades I need.
2025-04-22 14:49:47.536 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: de
2025-04-22 14:49:47.536 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.38 seconds
2025-04-22 14:49:47.536 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: de, 영어 번역: I would like to study in Korea abroad. Please let me know what qualifications and grades I need.
2025-04-22 14:49:47.537 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=de, english_query='I would like to study in Korea abroad. Please let me know what qualifications and grades I need.'
2025-04-22 14:49:47.537 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:49:47.537 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I would like to study in Korea abroad. Please let me know what qualifications and grades I need.
2025-04-22 14:49:47.537 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:49:47.537 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 14:49:47.537 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 14:49:47.538 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I would like to study in Korea abroad. Please let me know what qualifications and grades I need.
2025-04-22 14:49:47.622 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 14:49:47.622 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:49:47.622 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:49:47.622 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:49:47.622 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I would like to study in Korea abroad. Please let me know what qualifications and grades I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:49:47.622 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:49:47.622 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:49:47.623 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:49:47.629 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:49:47.633 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x33940afc0>
2025-04-22 14:49:47.633 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:49:47.633 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:49:47.633 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:49:47.633 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:49:47.633 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:49:57.634 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:49:57.634 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:49:57.634 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:49:57.635 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.01초)
2025-04-22 14:49:57.635 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:49:57.636 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:49:57.636 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:49:57.636 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:49:57.636 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: de, RAG type: visa_law
2025-04-22 14:49:57.636 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:49:57.636 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to German (code: de)
2025-04-22 14:49:57.637 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to German. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:49:57.637 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:49:57.638 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:49:57.647 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:49:57.648 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca62d0>
2025-04-22 14:49:57.648 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:49:57.649 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:49:57.649 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:49:57.649 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:49:57.649 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:49:58.247 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:49:58 GMT'), (b'Content-Length', b'758')])
2025-04-22 14:49:58.247 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:49:58.247 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:49:58.248 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:49:58.248 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:49:58.248 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:49:58.249 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.60초
2025-04-22 14:49:58.249 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.61초
2025-04-22 14:49:58.249 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:49:58.250 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:49:58.250 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: Es tut uns leid, bei der Erstellung der Antwort ist ein Fehler aufgetreten.
2025-04-22 14:49:58.250 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (German): Es tut uns leid, bei der Erstellung der Antwort ist ein Fehler aufgetreten.
2025-04-22 14:49:58.250 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:49:58.250 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:49:58.251 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: 'Es tut uns leid, bei der Erstellung der Antwort ist ein Fehler aufgetreten.'
2025-04-22 14:49:58.251 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:52:04.712 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:52:04.713 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:52:04.966 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:52:05.168 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:52:05.664 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:52:06.022 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:52:06.224 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:52:06.432 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:52:07.166 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:52:07.852 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:52:07.858 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:52:08.340 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:52:08.346 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:52:08.348 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:52:08.349 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:52:08.351 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:52:08.353 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:52:08.355 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:52:08.355 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:52:08.355 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:52:08.355 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:52:08.355 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:52:08.355 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:52:08.356 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: Ich möchte im Ausland in Korea studieren. Bitte teilen Sie mir mit, welche Qualifikationen und Noten ich benötige..
2025-04-22 14:52:08.356 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: Ich möchte im Ausland in Korea studieren. Bitte teilen Sie mir mit, welche Qualifikationen und Noten ich benötige..
2025-04-22 14:52:08.356 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:52:08.356 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:52:08.356 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:52:08.362 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:52:08.364 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce3bf0>
2025-04-22 14:52:08.364 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:52:08.364 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:52:08.364 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:52:08.364 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:52:08.364 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:52:08.853 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:52:10.127 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:52:10 GMT'), (b'Content-Length', b'1072')])
2025-04-22 14:52:10.128 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:52:10.129 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:52:10.129 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:52:10.129 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:52:10.129 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:52:10.130 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.77초
2025-04-22 14:52:10.130 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.77초
2025-04-22 14:52:10.130 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:52:10.131 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:52:10.131 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 14:52:10.131 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 14:52:10.131 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 14:52:10.132 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:52:10.132 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: Ich möchte im Ausland in Korea studieren. Bitte teilen Sie mir mit, welche Qualifikationen und Noten ich benötige..
2025-04-22 14:52:10.132 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:52:10.132 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:52:10.133 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:52:10.134 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:52:10.147 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:52:10.149 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce0830>
2025-04-22 14:52:10.149 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:52:10.149 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:52:10.150 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:52:10.150 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:52:10.150 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:52:10.151 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:52:10 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:52:10.151 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:52:10.151 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:52:10.153 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:52:10.153 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:52:10.153 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:52:10.153 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 14:52:10.153 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:52:10.153 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:52:10.153 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 14:52:10.153 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:52:10.154 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:52:10.160 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:52:10.162 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce31d0>
2025-04-22 14:52:10.162 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:52:10.162 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:52:10.162 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:52:10.162 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:52:10.162 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:52:11.468 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:52:11 GMT'), (b'Content-Length', b'1148')])
2025-04-22 14:52:11.468 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:52:11.469 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:52:11.469 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:52:11.469 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:52:11.469 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:52:11.470 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.31초
2025-04-22 14:52:11.470 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.32초
2025-04-22 14:52:11.470 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:52:11.470 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:52:11.471 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.32 seconds
2025-04-22 14:52:11.471 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I would like to study in Korea abroad. Please let me know what qualifications and grades I need.",
  "lang_code": "de"
}
2025-04-22 14:52:11.471 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:52:11.471 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I would like to study in Korea abroad. Please let me know what qualifications and grades I need.
2025-04-22 14:52:11.471 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: de
2025-04-22 14:52:11.471 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.34 seconds
2025-04-22 14:52:11.472 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: de, 영어 번역: I would like to study in Korea abroad. Please let me know what qualifications and grades I need.
2025-04-22 14:52:11.472 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=de, english_query='I would like to study in Korea abroad. Please let me know what qualifications and grades I need.'
2025-04-22 14:52:11.472 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:52:11.472 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I would like to study in Korea abroad. Please let me know what qualifications and grades I need.
2025-04-22 14:52:11.472 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:52:11.472 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 14:52:11.473 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 14:52:11.473 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I would like to study in Korea abroad. Please let me know what qualifications and grades I need.
2025-04-22 14:52:11.568 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 14:52:11.568 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:52:11.568 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:52:11.568 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:52:11.568 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I would like to study in Korea abroad. Please let me know what qualifications and grades I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:52:11.569 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:52:11.569 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:52:11.570 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:52:11.577 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:52:11.578 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16c9efc20>
2025-04-22 14:52:11.579 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:52:11.579 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:52:11.579 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:52:11.579 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:52:11.579 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:52:21.580 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:52:21.581 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:52:21.582 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:52:21.582 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.01초)
2025-04-22 14:52:21.583 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:52:21.583 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:52:21.583 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:52:21.583 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:52:21.583 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: de, RAG type: visa_law
2025-04-22 14:52:21.583 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:52:21.584 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to German (code: de)
2025-04-22 14:52:21.584 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to German. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:52:21.584 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:52:21.585 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:52:21.599 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:52:21.602 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16c9ef8c0>
2025-04-22 14:52:21.602 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:52:21.603 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:52:21.603 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:52:21.603 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:52:21.603 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:52:22.105 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:52:22 GMT'), (b'Content-Length', b'769')])
2025-04-22 14:52:22.105 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:52:22.106 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:52:22.106 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:52:22.106 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:52:22.106 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:52:22.107 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.51초
2025-04-22 14:52:22.107 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.52초
2025-04-22 14:52:22.107 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:52:22.107 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:52:22.107 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: Es tut uns leid, während der Generierung der Antwort ist ein Fehler aufgetreten.

2025-04-22 14:52:22.107 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (German): Es tut uns leid, während der Generierung der Antwort ist ein Fehler aufgetreten.

2025-04-22 14:52:22.108 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:52:22.108 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:52:22.108 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: 'Es tut uns leid, während der Generierung der Antwort ist ein Fehler aufgetreten.
'
2025-04-22 14:52:22.108 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:58:26.751 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:58:26.754 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:58:26.758 | DEBUG    | logging:callHandlers:1762 - Resetting dropped connection: huggingface.co
2025-04-22 14:58:27.043 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:58:27.266 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:58:27.470 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:58:27.773 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:58:28.260 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:58:28.472 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:58:29.009 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:58:29.674 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:58:29.680 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:58:30.019 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:58:30.025 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:58:30.027 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:58:30.029 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:58:30.031 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:58:30.033 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:58:30.034 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:58:30.035 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:58:30.035 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:58:30.035 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:58:30.035 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:58:30.035 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:58:30.035 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: Ich möchte im Ausland in Korea studieren. Bitte teilen Sie mir mit, welche Qualifikationen und Noten ich benötige..
2025-04-22 14:58:30.035 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: Ich möchte im Ausland in Korea studieren. Bitte teilen Sie mir mit, welche Qualifikationen und Noten ich benötige..
2025-04-22 14:58:30.035 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:58:30.036 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:58:30.036 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:58:30.043 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:58:30.044 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318cad700>
2025-04-22 14:58:30.044 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:58:30.044 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:58:30.044 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:58:30.045 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:58:30.045 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:58:30.461 | DEBUG    | logging:callHandlers:1762 - Resetting dropped connection: us.i.posthog.com
2025-04-22 14:58:31.084 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:58:33.835 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:58:33 GMT'), (b'Content-Length', b'1073')])
2025-04-22 14:58:33.836 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:58:33.837 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:58:33.837 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:58:33.838 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:58:33.838 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:58:33.838 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 3.80초
2025-04-22 14:58:33.839 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 3.80초
2025-04-22 14:58:33.839 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:58:33.839 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:58:33.839 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 14:58:33.840 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 14:58:33.840 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 14:58:33.840 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:58:33.840 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: Ich möchte im Ausland in Korea studieren. Bitte teilen Sie mir mit, welche Qualifikationen und Noten ich benötige..
2025-04-22 14:58:33.840 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:58:33.841 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:58:33.841 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:58:33.842 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:58:33.854 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:58:33.855 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318cad130>
2025-04-22 14:58:33.855 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:58:33.856 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:58:33.856 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:58:33.856 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:58:33.856 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:58:33.858 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:58:33 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:58:33.858 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:58:33.858 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:58:33.858 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:58:33.858 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:58:33.858 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:58:33.858 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 14:58:33.858 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:58:33.859 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:58:33.859 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 14:58:33.859 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:58:33.859 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:58:33.868 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:58:33.869 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318caf320>
2025-04-22 14:58:33.870 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:58:33.870 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:58:33.870 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:58:33.870 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:58:33.870 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:58:35.173 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:58:35 GMT'), (b'Content-Length', b'1150')])
2025-04-22 14:58:35.174 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:58:35.174 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:58:35.174 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:58:35.174 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:58:35.175 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:58:35.175 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.31초
2025-04-22 14:58:35.175 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.32초
2025-04-22 14:58:35.175 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:58:35.175 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:58:35.176 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.32 seconds
2025-04-22 14:58:35.176 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I would like to study in Korea abroad. Please inform me about the qualifications and grades I need.",
  "lang_code": "de"
}
2025-04-22 14:58:35.176 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:58:35.176 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I would like to study in Korea abroad. Please inform me about the qualifications and grades I need.
2025-04-22 14:58:35.176 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: de
2025-04-22 14:58:35.176 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.34 seconds
2025-04-22 14:58:35.176 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: de, 영어 번역: I would like to study in Korea abroad. Please inform me about the qualifications and grades I need.
2025-04-22 14:58:35.177 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=de, english_query='I would like to study in Korea abroad. Please inform me about the qualifications and grades I need.'
2025-04-22 14:58:35.177 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:58:35.177 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I would like to study in Korea abroad. Please inform me about the qualifications and grades I need.
2025-04-22 14:58:35.177 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:58:35.177 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 14:58:35.177 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 14:58:35.178 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I would like to study in Korea abroad. Please inform me about the qualifications and grades I need.
2025-04-22 14:58:35.517 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 14:58:35.517 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:58:35.518 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:58:35.518 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:58:35.518 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I would like to study in Korea abroad. Please inform me about the qualifications and grades I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:58:35.518 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:58:35.519 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:58:35.519 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:58:35.524 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:58:35.528 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3394708f0>
2025-04-22 14:58:35.528 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:58:35.528 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:58:35.528 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:58:35.529 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:58:35.529 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:58:45.529 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:58:45.530 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:58:45.530 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:58:45.530 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.01초)
2025-04-22 14:58:45.531 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:58:45.531 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:58:45.531 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:58:45.531 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:58:45.532 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: de, RAG type: visa_law
2025-04-22 14:58:45.532 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:58:45.532 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to German (code: de)
2025-04-22 14:58:45.532 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to German. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Sorry, an error occurred while generating the response.
                
2025-04-22 14:58:45.533 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:58:45.534 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:58:45.545 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:58:45.547 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318caf410>
2025-04-22 14:58:45.547 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:58:45.547 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:58:45.547 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:58:45.548 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:58:45.548 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:58:46.127 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:58:46 GMT'), (b'Content-Length', b'759')])
2025-04-22 14:58:46.128 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:58:46.128 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:58:46.129 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:58:46.129 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:58:46.129 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:58:46.129 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 0.58초
2025-04-22 14:58:46.129 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 0.60초
2025-04-22 14:58:46.130 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:58:46.130 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:58:46.130 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: Es tut uns leid, bei der Generierung der Antwort ist ein Fehler aufgetreten.
2025-04-22 14:58:46.130 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (German): Es tut uns leid, bei der Generierung der Antwort ist ein Fehler aufgetreten.
2025-04-22 14:58:46.130 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:58:46.130 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:58:46.131 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: 'Es tut uns leid, bei der Generierung der Antwort ist ein Fehler aufgetreten.'
2025-04-22 14:58:46.131 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 14:59:30.312 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 14:59:30.314 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:59:30.520 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:59:30.723 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 14:59:31.263 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 14:59:31.471 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 14:59:31.677 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 14:59:31.886 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 14:59:32.981 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 14:59:33.666 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 14:59:33.672 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 14:59:34.135 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 14:59:34.139 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 14:59:34.141 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 14:59:34.144 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 14:59:34.145 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 14:59:34.147 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 14:59:34.149 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 14:59:34.149 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 14:59:34.149 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 14:59:34.149 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 14:59:34.149 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 14:59:34.150 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 14:59:34.150 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 14:59:34.150 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 14:59:34.150 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 14:59:34.150 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:59:34.150 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:59:34.156 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:59:34.157 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca74a0>
2025-04-22 14:59:34.157 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:59:34.157 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:59:34.158 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:59:34.158 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:59:34.158 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:59:34.701 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 14:59:35.889 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:59:35 GMT'), (b'Content-Length', b'1021')])
2025-04-22 14:59:35.890 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:59:35.890 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:59:35.890 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:59:35.890 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:59:35.891 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:59:35.891 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.73초
2025-04-22 14:59:35.891 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.74초
2025-04-22 14:59:35.891 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:59:35.891 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:59:35.891 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 14:59:35.892 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 14:59:35.892 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 14:59:35.892 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 14:59:35.892 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 14:59:35.892 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 14:59:35.892 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 14:59:35.893 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:59:35.894 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:59:35.905 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:59:35.906 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3169da090>
2025-04-22 14:59:35.906 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 14:59:35.907 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:59:35.907 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 14:59:35.907 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:59:35.907 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 14:59:35.908 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:59:35 GMT'), (b'Content-Length', b'1335')])
2025-04-22 14:59:35.909 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 14:59:35.910 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 14:59:35.910 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:59:35.910 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:59:35.910 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:59:35.910 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 14:59:35.910 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:59:35.910 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:59:35.910 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 14:59:35.911 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:59:35.911 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:59:35.917 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:59:35.918 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x339447fb0>
2025-04-22 14:59:35.918 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:59:35.918 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:59:35.918 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:59:35.918 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:59:35.918 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:59:37.168 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 05:59:37 GMT'), (b'Content-Length', b'1075')])
2025-04-22 14:59:37.169 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 14:59:37.169 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 14:59:37.170 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 14:59:37.170 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:59:37.170 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:59:37.170 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.25초
2025-04-22 14:59:37.170 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.26초
2025-04-22 14:59:37.171 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 14:59:37.171 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 14:59:37.171 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.26 seconds
2025-04-22 14:59:37.171 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study abroad in Korea. Please tell me what qualifications and grades I need.",
  "lang_code": "en"
}
2025-04-22 14:59:37.171 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 14:59:37.171 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 14:59:37.172 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: en
2025-04-22 14:59:37.172 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.28 seconds
2025-04-22 14:59:37.172 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: en, 영어 번역: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 14:59:37.172 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=en, english_query='I want to study abroad in Korea. Please tell me what qualifications and grades I need.'
2025-04-22 14:59:37.172 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 14:59:37.172 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 14:59:37.172 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 14:59:37.173 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 14:59:37.173 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 14:59:37.173 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 14:59:37.380 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 14:59:37.381 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 14:59:37.381 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 14:59:37.381 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 14:59:37.381 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 14:59:37.381 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 14:59:37.381 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 14:59:37.382 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 14:59:37.388 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 14:59:37.390 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ca5e20>
2025-04-22 14:59:37.390 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 14:59:37.390 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 14:59:37.390 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 14:59:37.390 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 14:59:37.390 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 14:59:47.391 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 14:59:47.392 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 14:59:47.393 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 14:59:47.393 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.01초)
2025-04-22 14:59:47.394 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 14:59:47.394 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 14:59:47.394 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:59:47.394 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 14:59:47.394 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: en, RAG type: visa_law
2025-04-22 14:59:47.394 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 14:59:47.394 | INFO     | app.services.common.postprocessor:postprocess:67 - [POSTPROCESS] No translation needed (source language is English)
2025-04-22 14:59:47.395 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 14:59:47.395 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 14:59:47.395 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 14:59:47.395 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 15:00:02.435 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 15:00:02.436 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 15:00:02.888 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 15:00:03.094 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 15:00:03.301 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 15:00:03.518 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 15:00:03.738 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 15:00:04.036 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 15:00:04.796 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 15:00:05.566 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 15:00:05.570 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 15:00:06.007 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 15:00:06.012 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 15:00:06.014 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 15:00:06.016 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 15:00:06.018 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 15:00:06.020 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 15:00:06.022 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 15:00:06.022 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 15:00:06.022 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 15:00:06.022 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 15:00:06.022 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 15:00:06.022 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 15:00:06.022 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:00:06.022 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:00:06.022 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 15:00:06.023 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:00:06.023 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:00:06.030 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 15:00:06.032 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3169da0f0>
2025-04-22 15:00:06.032 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 15:00:06.033 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:00:06.033 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 15:00:06.033 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:00:06.033 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 15:00:06.685 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 15:00:07.803 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:00:07 GMT'), (b'Content-Length', b'1021')])
2025-04-22 15:00:07.803 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 15:00:07.804 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 15:00:07.804 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:00:07.804 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:00:07.805 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:00:07.805 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.78초
2025-04-22 15:00:07.806 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.78초
2025-04-22 15:00:07.806 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:00:07.806 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:00:07.806 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 15:00:07.806 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 15:00:07.806 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 15:00:07.807 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 15:00:07.807 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:00:07.807 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 15:00:07.807 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 15:00:07.807 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:00:07.808 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:00:07.821 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 15:00:07.823 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x316a70230>
2025-04-22 15:00:07.823 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 15:00:07.823 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:00:07.823 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 15:00:07.823 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:00:07.823 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 15:00:07.825 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:00:07 GMT'), (b'Content-Length', b'1335')])
2025-04-22 15:00:07.825 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 15:00:07.825 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 15:00:07.825 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:00:07.825 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:00:07.825 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:00:07.825 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 15:00:07.825 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:00:07.826 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:00:07.826 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 15:00:07.826 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:00:07.826 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:00:07.832 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 15:00:07.833 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318ce0080>
2025-04-22 15:00:07.833 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 15:00:07.833 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:00:07.833 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 15:00:07.833 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:00:07.833 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 15:00:09.098 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:00:09 GMT'), (b'Content-Length', b'1075')])
2025-04-22 15:00:09.099 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 15:00:09.099 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 15:00:09.100 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:00:09.100 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:00:09.100 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:00:09.100 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.27초
2025-04-22 15:00:09.100 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.27초
2025-04-22 15:00:09.101 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:00:09.101 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:00:09.101 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.28 seconds
2025-04-22 15:00:09.101 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study abroad in Korea. Please tell me what qualifications and grades I need.",
  "lang_code": "en"
}
2025-04-22 15:00:09.101 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 15:00:09.101 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:00:09.102 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: en
2025-04-22 15:00:09.102 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.30 seconds
2025-04-22 15:00:09.102 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: en, 영어 번역: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:00:09.102 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=en, english_query='I want to study abroad in Korea. Please tell me what qualifications and grades I need.'
2025-04-22 15:00:09.102 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 15:00:09.102 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:00:09.103 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 15:00:09.103 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 15:00:09.103 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 15:00:09.103 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:00:09.196 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 15:00:09.197 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 15:00:09.197 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 15:00:09.197 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 15:00:09.197 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 15:00:09.197 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 15:00:09.198 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:00:09.198 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:00:09.206 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 15:00:09.210 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x3169dac90>
2025-04-22 15:00:09.210 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 15:00:09.210 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:00:09.210 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 15:00:09.210 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:00:09.210 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 15:00:19.212 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 15:00:19.213 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:00:19.213 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:00:19.213 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.02초)
2025-04-22 15:00:19.214 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 15:00:19.214 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 15:00:19.214 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 15:00:19.215 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 15:00:19.215 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: en, RAG type: visa_law
2025-04-22 15:00:19.215 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 15:00:19.215 | INFO     | app.services.common.postprocessor:postprocess:67 - [POSTPROCESS] No translation needed (source language is English)
2025-04-22 15:00:19.215 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 15:00:19.215 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 15:00:19.215 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 15:00:19.215 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 15:00:54.718 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 15:00:54.722 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 15:00:54.922 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 15:00:55.532 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 15:00:55.732 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 15:00:55.938 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 15:00:56.155 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 15:00:56.678 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 15:00:57.386 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 15:00:58.100 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 15:00:58.106 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 15:00:58.569 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 15:00:58.574 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 15:00:58.576 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 15:00:58.578 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 15:00:58.580 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 15:00:58.582 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 15:00:58.584 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 15:00:58.584 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:16 - [응답 생성기] 고성능 모델 사용: gemma3:4b
2025-04-22 15:00:58.584 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:18 - [응답 생성기] 디바이스: cpu
2025-04-22 15:00:58.585 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 15:00:58.585 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 15:00:58.585 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 15:00:58.585 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:00:58.585 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:00:58.585 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 15:00:58.585 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:00:58.586 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:00:58.592 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 15:00:58.593 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16ca182f0>
2025-04-22 15:00:58.593 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 15:00:58.594 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:00:58.594 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 15:00:58.594 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:00:58.594 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 15:00:59.054 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 15:01:00.374 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:01:00 GMT'), (b'Content-Length', b'1021')])
2025-04-22 15:01:00.375 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 15:01:00.376 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 15:01:00.376 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:01:00.376 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:01:00.376 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:01:00.376 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.78초
2025-04-22 15:01:00.377 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.79초
2025-04-22 15:01:00.377 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:01:00.377 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:01:00.378 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 15:01:00.378 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 15:01:00.378 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 15:01:00.379 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 15:01:00.379 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:01:00.379 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 15:01:00.379 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 15:01:00.380 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:01:00.381 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:01:00.398 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 15:01:00.400 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x16c9efa10>
2025-04-22 15:01:00.400 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 15:01:00.400 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:01:00.400 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 15:01:00.400 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:01:00.400 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 15:01:00.401 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:01:00 GMT'), (b'Content-Length', b'1335')])
2025-04-22 15:01:00.402 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 15:01:00.402 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 15:01:00.402 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:01:00.402 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:01:00.402 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:01:00.402 | INFO     | app.core.llm_client:check_connection:46 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 15:01:00.402 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:01:00.402 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:01:00.402 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 15:01:00.403 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:01:00.403 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:01:00.412 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 15:01:00.413 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318caf830>
2025-04-22 15:01:00.413 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 15:01:00.413 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:01:00.413 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 15:01:00.414 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:01:00.414 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 15:01:01.682 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:01:01 GMT'), (b'Content-Length', b'1075')])
2025-04-22 15:01:01.682 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 15:01:01.682 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 15:01:01.682 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:01:01.682 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:01:01.683 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:01:01.683 | INFO     | app.core.llm_client:generate:70 - [Ollama 경량] API 요청 시간: 1.27초
2025-04-22 15:01:01.683 | INFO     | app.core.llm_client:generate:76 - [Ollama 경량] 전체 생성 시간: 1.28초
2025-04-22 15:01:01.683 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:01:01.683 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:01:01.683 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.28 seconds
2025-04-22 15:01:01.683 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study abroad in Korea. Please tell me what qualifications and grades I need.",
  "lang_code": "en"
}
2025-04-22 15:01:01.683 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 15:01:01.683 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:01:01.683 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: en
2025-04-22 15:01:01.683 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.30 seconds
2025-04-22 15:01:01.683 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: en, 영어 번역: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:01:01.683 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=en, english_query='I want to study abroad in Korea. Please tell me what qualifications and grades I need.'
2025-04-22 15:01:01.683 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 15:01:01.683 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:33 - [RESPONSE] Input query (English): I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:01:01.684 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Query type: general
2025-04-22 15:01:01.684 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] RAG type: visa_law
2025-04-22 15:01:01.684 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 15:01:01.684 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:01:01.818 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 15:01:01.818 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 15:01:01.818 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:61 - [RESPONSE] No RAG context available
2025-04-22 15:01:01.818 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:65 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 15:01:01.819 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 15:01:01.819 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:69 - [응답 생성기] 응답 생성 시작
2025-04-22 15:01:01.819 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:01:01.819 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:01:01.825 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=10 socket_options=None
2025-04-22 15:01:01.828 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x318cae540>
2025-04-22 15:01:01.828 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 15:01:01.829 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:01:01.829 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 15:01:01.829 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:01:01.829 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 15:01:11.829 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.failed exception=ReadTimeout(TimeoutError())
2025-04-22 15:01:11.831 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:01:11.831 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:01:11.831 | ERROR    | app.core.llm_client:generate:81 - [Ollama 경량] 요청 타임아웃:  (소요 시간: 10.01초)
2025-04-22 15:01:11.832 | ERROR    | app.services.chatbot.chatbot_response_generator:_generate_general_response:76 - 일반 응답 생성 중 오류 발생: Ollama 서버 응답 시간 초과 (타임아웃: 10초)
2025-04-22 15:01:11.832 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 15:01:11.833 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 15:01:11.834 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 15:01:11.834 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: en, RAG type: visa_law
2025-04-22 15:01:11.834 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Sorry, an error occurred while generating the response.
2025-04-22 15:01:11.834 | INFO     | app.services.common.postprocessor:postprocess:67 - [POSTPROCESS] No translation needed (source language is English)
2025-04-22 15:01:11.834 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 15:01:11.834 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 15:01:11.835 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: 'Sorry, an error occurred while generating the response.'
2025-04-22 15:01:11.835 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 15:04:17.328 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 15:04:17.330 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
2025-04-22 15:04:19.724 | INFO     | app.core.llm_client:__init__:30 - [OllamaClient] 경량 모델 초기화 완료: URL=http://localhost:11434, MODEL=gemma3:4b, TIMEOUT=20초
2025-04-22 15:04:19.724 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 15:04:19.725 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 15:04:19.736 | DEBUG    | logging:callHandlers:1762 - Starting new HTTPS connection (1): huggingface.co:443
2025-04-22 15:04:20.008 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 15:04:20.305 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 15:04:20.523 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 15:04:20.719 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 15:04:20.917 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 15:04:21.124 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 15:04:22.756 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 15:04:23.449 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 15:04:23.493 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 15:04:23.857 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 15:04:23.873 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 15:04:23.940 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 15:04:23.940 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 15:04:23.940 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 15:04:23.940 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 15:04:23.940 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 15:04:23.945 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 15:04:23.945 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 15:04:23.945 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 15:04:23.949 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 15:04:23.950 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 15:04:23.951 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 15:04:23.951 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 15:04:23.951 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 15:04:23.951 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 15:04:23.951 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 15:04:23.952 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 15:04:23.952 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 15:04:23.952 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 15:04:23.953 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 15:04:23.954 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 15:04:23.954 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 15:04:23.954 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 15:04:23.954 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 15:04:23.954 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 15:04:23.955 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 15:04:23.956 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 15:04:23.956 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 15:04:23.956 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 15:04:23.957 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 15:04:23.957 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 15:04:23.958 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 15:04:23.958 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 15:04:23.958 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 15:04:23.958 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 15:04:23.958 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 15:04:23.958 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 15:04:23.958 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 15:04:23.958 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 15:04:23.959 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 15:04:23.960 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 15:04:23.960 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 15:04:23.960 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 15:04:23.960 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 15:04:23.960 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 15:04:23.960 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 15:04:23.961 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 15:04:23.961 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 15:04:23.961 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 15:04:23.962 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 15:04:23.963 | INFO     | logging:callHandlers:1762 - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-04-22 15:04:23.963 | DEBUG    | logging:callHandlers:1762 - Starting component System
2025-04-22 15:04:23.963 | DEBUG    | logging:callHandlers:1762 - Starting component Posthog
2025-04-22 15:04:23.963 | DEBUG    | logging:callHandlers:1762 - Starting component OpenTelemetryClient
2025-04-22 15:04:23.963 | DEBUG    | logging:callHandlers:1762 - Starting component SimpleAssignmentPolicy
2025-04-22 15:04:23.963 | DEBUG    | logging:callHandlers:1762 - Starting component SqliteDB
2025-04-22 15:04:23.964 | DEBUG    | logging:callHandlers:1762 - Starting component QuotaEnforcer
2025-04-22 15:04:23.964 | DEBUG    | logging:callHandlers:1762 - Starting component LocalSegmentManager
2025-04-22 15:04:23.964 | DEBUG    | logging:callHandlers:1762 - Starting component SegmentAPI
2025-04-22 15:04:23.965 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 15:04:23.965 | INFO     | app.core.llm_client:__init__:35 - [OllamaClient] 고성능 모델 초기화 완료: URL=http://localhost:11434, MODEL=gemma3:4b, TIMEOUT=60초
2025-04-22 15:04:23.965 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:17 - [응답 생성기] 고성능 모델 사용: gemma3:4b, 타임아웃: 60초
2025-04-22 15:04:23.965 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:19 - [응답 생성기] 디바이스: cpu
2025-04-22 15:04:23.965 | INFO     | app.core.llm_client:__init__:30 - [OllamaClient] 경량 모델 초기화 완료: URL=http://localhost:11434, MODEL=gemma3:4b, TIMEOUT=20초
2025-04-22 15:04:23.965 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 15:04:23.965 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 15:04:23.966 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 15:04:23.966 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:04:23.966 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:04:23.966 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 15:04:23.967 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:04:23.967 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:04:23.975 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=20 socket_options=None
2025-04-22 15:04:23.978 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31c427050>
2025-04-22 15:04:23.978 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 15:04:23.978 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:04:23.978 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 15:04:23.978 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:04:23.978 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 15:04:24.453 | DEBUG    | logging:callHandlers:1762 - Starting new HTTPS connection (1): us.i.posthog.com:443
2025-04-22 15:04:25.128 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 15:04:25.804 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:04:25 GMT'), (b'Content-Length', b'1021')])
2025-04-22 15:04:25.805 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 15:04:25.806 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 15:04:25.806 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:04:25.807 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:04:25.807 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:04:25.807 | INFO     | app.core.llm_client:generate:72 - [Ollama 경량] API 요청 시간: 1.83초
2025-04-22 15:04:25.807 | INFO     | app.core.llm_client:generate:78 - [Ollama 경량] 전체 생성 시간: 1.84초
2025-04-22 15:04:25.808 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:04:25.808 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:04:25.808 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: visa_law
2025-04-22 15:04:25.808 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: visa_law
2025-04-22 15:04:25.808 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: visa_law
2025-04-22 15:04:25.808 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 15:04:25.808 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:04:25.809 | INFO     | app.core.llm_client:__init__:30 - [OllamaClient] 경량 모델 초기화 완료: URL=http://localhost:11434, MODEL=gemma3:4b, TIMEOUT=20초
2025-04-22 15:04:25.809 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 15:04:25.809 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 15:04:25.810 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:04:25.810 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:04:25.821 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=20 socket_options=None
2025-04-22 15:04:25.823 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31c4a5a60>
2025-04-22 15:04:25.823 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 15:04:25.823 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:04:25.823 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 15:04:25.823 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:04:25.823 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 15:04:25.824 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:04:25 GMT'), (b'Content-Length', b'1335')])
2025-04-22 15:04:25.825 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 15:04:25.825 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 15:04:25.825 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:04:25.825 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:04:25.825 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:04:25.825 | INFO     | app.core.llm_client:check_connection:48 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 15:04:25.825 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:04:25.826 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:04:25.826 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 15:04:25.827 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:04:25.827 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:04:25.833 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=20 socket_options=None
2025-04-22 15:04:25.834 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31c427ad0>
2025-04-22 15:04:25.834 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 15:04:25.834 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:04:25.834 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 15:04:25.835 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:04:25.835 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 15:04:27.091 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:04:27 GMT'), (b'Content-Length', b'1075')])
2025-04-22 15:04:27.092 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 15:04:27.092 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 15:04:27.093 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:04:27.093 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:04:27.093 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:04:27.093 | INFO     | app.core.llm_client:generate:72 - [Ollama 경량] API 요청 시간: 1.26초
2025-04-22 15:04:27.094 | INFO     | app.core.llm_client:generate:78 - [Ollama 경량] 전체 생성 시간: 1.27초
2025-04-22 15:04:27.094 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:04:27.094 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:04:27.094 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.27 seconds
2025-04-22 15:04:27.095 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study abroad in Korea. Please tell me what qualifications and grades I need.",
  "lang_code": "en"
}
2025-04-22 15:04:27.095 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 15:04:27.095 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:04:27.095 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: en
2025-04-22 15:04:27.095 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.29 seconds
2025-04-22 15:04:27.095 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: en, 영어 번역: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:04:27.096 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=en, english_query='I want to study abroad in Korea. Please tell me what qualifications and grades I need.'
2025-04-22 15:04:27.096 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 15:04:27.096 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Input query (English): I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:04:27.096 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] Query type: general
2025-04-22 15:04:27.096 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:36 - [RESPONSE] RAG type: visa_law
2025-04-22 15:04:27.096 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] visa_law 유형에서 컨텍스트 생성 시작
2025-04-22 15:04:27.097 | INFO     | app.services.common.rag_service:search:81 - [RAG] visa_law 도메인에서 문서 검색 시작: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
2025-04-22 15:04:27.330 | DEBUG    | logging:callHandlers:1762 - Starting component PersistentLocalHnswSegment
2025-04-22 15:04:27.330 | INFO     | app.services.common.rag_service:search:98 - [RAG] visa_law 도메인에서 0개의 문서가 검색되었습니다.
2025-04-22 15:04:27.331 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 15:04:27.331 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:62 - [RESPONSE] No RAG context available
2025-04-22 15:04:27.331 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 15:04:27.331 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:67 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study abroad in Korea. Please tell me what qualifications and grades I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 15:04:27.331 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:70 - [응답 생성기] 응답 생성 시작 (타임아웃: 60초)
2025-04-22 15:04:27.331 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:04:27.332 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:04:27.337 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=60 socket_options=None
2025-04-22 15:04:27.338 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31c4c1d60>
2025-04-22 15:04:27.338 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 15:04:27.338 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:04:27.338 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 15:04:27.338 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:04:27.338 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 15:04:27.868 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 15:04:43.661 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:04:43 GMT'), (b'Transfer-Encoding', b'chunked')])
2025-04-22 15:04:43.663 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 15:04:43.664 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 15:04:43.664 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:04:43.664 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:04:43.666 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:04:43.667 | INFO     | app.core.llm_client:generate:72 - [Ollama 고성능] API 요청 시간: 16.33초
2025-04-22 15:04:43.667 | INFO     | app.core.llm_client:generate:78 - [Ollama 고성능] 전체 생성 시간: 16.34초
2025-04-22 15:04:43.667 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:04:43.667 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:04:43.667 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:72 - [응답 생성기] 응답 생성 완료: 3049자
2025-04-22 15:04:43.667 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:73 - [RESPONSE] Generated response: Okay, let's talk about studying abroad in Korea! The qualifications and grades you’ll need depend largely on the type of program you’re applying for – whether it’s a university degree program, a language course, or a short-term study abroad experience. Here's a breakdown:

**1. University Degree Programs (Most Common):**

* **Minimum GPA:** Generally, universities in Korea require a minimum GPA of **3.0 or higher** (on a 4.0 scale). This translates roughly to a B or better in most Western systems. Some competitive programs, particularly in top universities like Seoul National University or KAIST, might require a GPA of 3.5 or higher.
* **Bachelor's Degree:** You’ll typically need to have already completed a Bachelor's degree (or be in your final year) in a field related to your desired Korean studies program.
* **English Proficiency:** You *absolutely* need proof of English proficiency. This is almost always demonstrated through:
    * **TOEFL iBT:** Minimum score of 80-90 is common, but higher scores are strongly preferred.
    * **IELTS:** Minimum score of 6.0 - 6.5 is generally required. Again, higher scores are beneficial.
* **GRE/TOEFL iBT Scores:** Some universities might require a GRE score in addition to the TOEFL.

**2. Language Courses (Korean Language Programs):**

* **High School Grades:** Strong grades in English and potentially other languages (like Mandarin or Japanese) can be helpful.
* **English Proficiency:** Still important for communication and learning support.
* **No specific academic qualifications are *always* required**, but a good understanding of grammar and a willingness to learn are crucial. Some programs might require a basic English placement test.

**3. Short-Term Study Abroad Programs:**

* **High School Diploma or Equivalent:** This is usually the minimum requirement.
* **Strong academic standing:** A good overall high school GPA is often desired.
* **English Proficiency:**  Again, proof of English proficiency is generally required.


**Important Resources & Considerations:**

* **University Websites:**  *The most important thing* is to research the specific university and program you’re interested in.  Each university has its own admissions criteria, so check their website for detailed information.
* **Korean Embassies & Consulates:** Contact the Korean embassy or consulate in your country for information on visa requirements.
* **Study Abroad Agencies:** Agencies specializing in Korean study abroad programs can offer guidance and assistance with the application process.

**Resources to Start With:**

* **Study in Korea:** [https://studyinkorea.go.kr/](https://studyinkorea.go.kr/) - This is the official website and a fantastic resource.
* **University Websites:**  (e.g., Seoul National University, KAIST, Yonsei University, Korea University)

**To help me give you even more tailored advice, could you tell me:**

*   What type of program are you most interested in (e.g., university degree, language course, short-term)?
*   Which universities are you considering?
2025-04-22 15:04:43.667 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 15:04:43.667 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Okay, let's talk about studying abroad in Korea! The qualifications and grades you’ll need depend largely on the type of program you’re applying for – whether it’s a university degree program, a language course, or a short-term study abroad experience. Here's a breakdown:

**1. University Degree Programs (Most Common):**

* **Minimum GPA:** Generally, universities in Korea require a minimum GPA of **3.0 or higher** (on a 4.0 scale). This translates roughly to a B or better in most Western systems. Some competitive programs, particularly in top universities like Seoul National University or KAIST, might require a GPA of 3.5 or higher.
* **Bachelor's Degree:** You’ll typically need to have already completed a Bachelor's degree (or be in your final year) in a field related to your desired Korean studies program.
* **English Proficiency:** You *absolutely* need proof of English proficiency. This is almost always demonstrated through:
    * **TOEFL iBT:** Minimum score of 80-90 is common, but higher scores are strongly preferred.
    * **IELTS:** Minimum score of 6.0 - 6.5 is generally required. Again, higher scores are beneficial.
* **GRE/TOEFL iBT Scores:** Some universities might require a GRE score in addition to the TOEFL.

**2. Language Courses (Korean Language Programs):**

* **High School Grades:** Strong grades in English and potentially other languages (like Mandarin or Japanese) can be helpful.
* **English Proficiency:** Still important for communication and learning support.
* **No specific academic qualifications are *always* required**, but a good understanding of grammar and a willingness to learn are crucial. Some programs might require a basic English placement test.

**3. Short-Term Study Abroad Programs:**

* **High School Diploma or Equivalent:** This is usually the minimum requirement.
* **Strong academic standing:** A good overall high school GPA is often desired.
* **English Proficiency:**  Again, proof of English proficiency is generally required.


**Important Resources & Considerations:**

* **University Websites:**  *The most important thing* is to research the specific university and program you’re interested in.  Each university has its own admissions criteria, so check their website for detailed information.
* **Korean Embassies & Consulates:** Contact the Korean embassy or consulate in your country for information on visa requirements.
* **Study Abroad Agencies:** Agencies specializing in Korean study abroad programs can offer guidance and assistance with the application process.

**Resources to Start With:**

* **Study in Korea:** [https://studyinkorea.go.kr/](https://studyinkorea.go.kr/) - This is the official website and a fantastic resource.
* **University Websites:**  (e.g., Seoul National University, KAIST, Yonsei University, Korea University)

**To help me give you even more tailored advice, could you tell me:**

*   What type of program are you most interested in (e.g., university degree, language course, short-term)?
*   Which universities are you considering?'
2025-04-22 15:04:43.667 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 15:04:43.667 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: en, RAG type: visa_law
2025-04-22 15:04:43.668 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Okay, let's talk about studying abroad in Korea! The qualifications and grades you’ll need depend largely on the type of program you’re applying for – whether it’s a university degree program, a language course, or a short-term study abroad experience. Here's a breakdown:

**1. University Degree Programs (Most Common):**

* **Minimum GPA:** Generally, universities in Korea require a minimum GPA of **3.0 or higher** (on a 4.0 scale). This translates roughly to a B or better in most Western systems. Some competitive programs, particularly in top universities like Seoul National University or KAIST, might require a GPA of 3.5 or higher.
* **Bachelor's Degree:** You’ll typically need to have already completed a Bachelor's degree (or be in your final year) in a field related to your desired Korean studies program.
* **English Proficiency:** You *absolutely* need proof of English proficiency. This is almost always demonstrated through:
    * **TOEFL iBT:** Minimum score of 80-90 is common, but higher scores are strongly preferred.
    * **IELTS:** Minimum score of 6.0 - 6.5 is generally required. Again, higher scores are beneficial.
* **GRE/TOEFL iBT Scores:** Some universities might require a GRE score in addition to the TOEFL.

**2. Language Courses (Korean Language Programs):**

* **High School Grades:** Strong grades in English and potentially other languages (like Mandarin or Japanese) can be helpful.
* **English Proficiency:** Still important for communication and learning support.
* **No specific academic qualifications are *always* required**, but a good understanding of grammar and a willingness to learn are crucial. Some programs might require a basic English placement test.

**3. Short-Term Study Abroad Programs:**

* **High School Diploma or Equivalent:** This is usually the minimum requirement.
* **Strong academic standing:** A good overall high school GPA is often desired.
* **English Proficiency:**  Again, proof of English proficiency is generally required.


**Important Resources & Considerations:**

* **University Websites:**  *The most important thing* is to research the specific university and program you’re interested in.  Each university has its own admissions criteria, so check their website for detailed information.
* **Korean Embassies & Consulates:** Contact the Korean embassy or consulate in your country for information on visa requirements.
* **Study Abroad Agencies:** Agencies specializing in Korean study abroad programs can offer guidance and assistance with the application process.

**Resources to Start With:**

* **Study in Korea:** [https://studyinkorea.go.kr/](https://studyinkorea.go.kr/) - This is the official website and a fantastic resource.
* **University Websites:**  (e.g., Seoul National University, KAIST, Yonsei University, Korea University)

**To help me give you even more tailored advice, could you tell me:**

*   What type of program are you most interested in (e.g., university degree, language course, short-term)?
*   Which universities are you considering?
2025-04-22 15:04:43.668 | INFO     | app.services.common.postprocessor:postprocess:67 - [POSTPROCESS] No translation needed (source language is English)
2025-04-22 15:04:43.668 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 15:04:43.668 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 15:04:43.668 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: 'Okay, let's talk about studying abroad in Korea! The qualifications and grades you’ll need depend largely on the type of program you’re applying for – whether it’s a university degree program, a language course, or a short-term study abroad experience. Here's a breakdown:

**1. University Degree Programs (Most Common):**

* **Minimum GPA:** Generally, universities in Korea require a minimum GPA of **3.0 or higher** (on a 4.0 scale). This translates roughly to a B or better in most Western systems. Some competitive programs, particularly in top universities like Seoul National University or KAIST, might require a GPA of 3.5 or higher.
* **Bachelor's Degree:** You’ll typically need to have already completed a Bachelor's degree (or be in your final year) in a field related to your desired Korean studies program.
* **English Proficiency:** You *absolutely* need proof of English proficiency. This is almost always demonstrated through:
    * **TOEFL iBT:** Minimum score of 80-90 is common, but higher scores are strongly preferred.
    * **IELTS:** Minimum score of 6.0 - 6.5 is generally required. Again, higher scores are beneficial.
* **GRE/TOEFL iBT Scores:** Some universities might require a GRE score in addition to the TOEFL.

**2. Language Courses (Korean Language Programs):**

* **High School Grades:** Strong grades in English and potentially other languages (like Mandarin or Japanese) can be helpful.
* **English Proficiency:** Still important for communication and learning support.
* **No specific academic qualifications are *always* required**, but a good understanding of grammar and a willingness to learn are crucial. Some programs might require a basic English placement test.

**3. Short-Term Study Abroad Programs:**

* **High School Diploma or Equivalent:** This is usually the minimum requirement.
* **Strong academic standing:** A good overall high school GPA is often desired.
* **English Proficiency:**  Again, proof of English proficiency is generally required.


**Important Resources & Considerations:**

* **University Websites:**  *The most important thing* is to research the specific university and program you’re interested in.  Each university has its own admissions criteria, so check their website for detailed information.
* **Korean Embassies & Consulates:** Contact the Korean embassy or consulate in your country for information on visa requirements.
* **Study Abroad Agencies:** Agencies specializing in Korean study abroad programs can offer guidance and assistance with the application process.

**Resources to Start With:**

* **Study in Korea:** [https://studyinkorea.go.kr/](https://studyinkorea.go.kr/) - This is the official website and a fantastic resource.
* **University Websites:**  (e.g., Seoul National University, KAIST, Yonsei University, Korea University)

**To help me give you even more tailored advice, could you tell me:**

*   What type of program are you most interested in (e.g., university degree, language course, short-term)?
*   Which universities are you considering?'
2025-04-22 15:04:43.668 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 15:05:16.836 | INFO     | app.core.llm_client:__init__:30 - [OllamaClient] 경량 모델 초기화 완료: URL=http://localhost:11434, MODEL=gemma3:4b, TIMEOUT=20초
2025-04-22 15:05:16.837 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 15:05:16.838 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 15:05:17.039 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 15:05:17.269 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 15:05:17.475 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 15:05:17.673 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 15:05:18.179 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 15:05:18.707 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 15:05:19.462 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 15:05:20.150 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 15:05:20.156 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 15:05:20.649 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 15:05:20.655 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 15:05:20.657 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 15:05:20.660 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 15:05:20.661 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 15:05:20.663 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 15:05:20.664 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 15:05:20.665 | INFO     | app.core.llm_client:__init__:35 - [OllamaClient] 고성능 모델 초기화 완료: URL=http://localhost:11434, MODEL=gemma3:4b, TIMEOUT=60초
2025-04-22 15:05:20.665 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:17 - [응답 생성기] 고성능 모델 사용: gemma3:4b, 타임아웃: 60초
2025-04-22 15:05:20.665 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:19 - [응답 생성기] 디바이스: cpu
2025-04-22 15:05:20.665 | INFO     | app.core.llm_client:__init__:30 - [OllamaClient] 경량 모델 초기화 완료: URL=http://localhost:11434, MODEL=gemma3:4b, TIMEOUT=20초
2025-04-22 15:05:20.665 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 15:05:20.665 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 15:05:20.665 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 15:05:20.665 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: I want to study abroad in Korea. Please tell me what grades I need.
2025-04-22 15:05:20.665 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: I want to study abroad in Korea. Please tell me what grades I need.
2025-04-22 15:05:20.665 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 15:05:20.666 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:05:20.666 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:05:20.673 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=20 socket_options=None
2025-04-22 15:05:20.674 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31c4d2c00>
2025-04-22 15:05:20.674 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 15:05:20.675 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:05:20.675 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 15:05:20.675 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:05:20.675 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 15:05:21.178 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 15:05:22.503 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:05:22 GMT'), (b'Content-Length', b'1011')])
2025-04-22 15:05:22.506 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 15:05:22.507 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 15:05:22.507 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:05:22.508 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:05:22.508 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:05:22.508 | INFO     | app.core.llm_client:generate:72 - [Ollama 경량] API 요청 시간: 1.84초
2025-04-22 15:05:22.509 | INFO     | app.core.llm_client:generate:78 - [Ollama 경량] 전체 생성 시간: 1.84초
2025-04-22 15:05:22.509 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:05:22.509 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:05:22.509 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: daily_life
2025-04-22 15:05:22.509 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: daily_life
2025-04-22 15:05:22.509 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: daily_life
2025-04-22 15:05:22.510 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 15:05:22.510 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: I want to study abroad in Korea. Please tell me what grades I need.
2025-04-22 15:05:22.510 | INFO     | app.core.llm_client:__init__:30 - [OllamaClient] 경량 모델 초기화 완료: URL=http://localhost:11434, MODEL=gemma3:4b, TIMEOUT=20초
2025-04-22 15:05:22.510 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 15:05:22.510 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 15:05:22.511 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:05:22.511 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:05:22.525 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=20 socket_options=None
2025-04-22 15:05:22.526 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31a1dbd40>
2025-04-22 15:05:22.526 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 15:05:22.527 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:05:22.527 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 15:05:22.527 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:05:22.527 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 15:05:22.528 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:05:22 GMT'), (b'Content-Length', b'1335')])
2025-04-22 15:05:22.528 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 15:05:22.529 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 15:05:22.529 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:05:22.529 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:05:22.529 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:05:22.529 | INFO     | app.core.llm_client:check_connection:48 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 15:05:22.529 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:05:22.529 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:05:22.529 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 15:05:22.530 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:05:22.530 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:05:22.536 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=20 socket_options=None
2025-04-22 15:05:22.537 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31c4c19a0>
2025-04-22 15:05:22.537 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 15:05:22.537 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:05:22.538 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 15:05:22.538 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:05:22.538 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 15:05:23.741 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:05:23 GMT'), (b'Content-Length', b'1035')])
2025-04-22 15:05:23.741 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 15:05:23.741 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 15:05:23.742 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:05:23.742 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:05:23.742 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:05:23.742 | INFO     | app.core.llm_client:generate:72 - [Ollama 경량] API 요청 시간: 1.21초
2025-04-22 15:05:23.742 | INFO     | app.core.llm_client:generate:78 - [Ollama 경량] 전체 생성 시간: 1.21초
2025-04-22 15:05:23.743 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:05:23.743 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:05:23.743 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.21 seconds
2025-04-22 15:05:23.743 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study abroad in Korea. Please tell me what grades I need.",
  "lang_code": "en"
}
2025-04-22 15:05:23.743 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 15:05:23.743 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study abroad in Korea. Please tell me what grades I need.
2025-04-22 15:05:23.743 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: en
2025-04-22 15:05:23.743 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.23 seconds
2025-04-22 15:05:23.744 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: en, 영어 번역: I want to study abroad in Korea. Please tell me what grades I need.
2025-04-22 15:05:23.744 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=en, english_query='I want to study abroad in Korea. Please tell me what grades I need.'
2025-04-22 15:05:23.744 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 15:05:23.744 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Input query (English): I want to study abroad in Korea. Please tell me what grades I need.
2025-04-22 15:05:23.744 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] Query type: general
2025-04-22 15:05:23.744 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:36 - [RESPONSE] RAG type: daily_life
2025-04-22 15:05:23.745 | INFO     | app.services.common.rag_service:get_context:119 - [RAG] daily_life 유형에서 컨텍스트 생성 시작
2025-04-22 15:05:23.745 | INFO     | app.services.common.rag_service:search:81 - [RAG] daily_life 도메인에서 문서 검색 시작: I want to study abroad in Korea. Please tell me what grades I need.
2025-04-22 15:05:23.898 | ERROR    | app.services.common.rag_service:search:104 - 문서 검색 중 오류 발생: <RAGType.DAILY_LIFE: 'daily_life'>
2025-04-22 15:05:23.898 | INFO     | app.services.common.rag_service:get_context:129 - [RAG] 관련 문서가 없습니다.
2025-04-22 15:05:23.898 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:62 - [RESPONSE] No RAG context available
2025-04-22 15:05:23.898 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 15:05:23.898 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:67 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study abroad in Korea. Please tell me what grades I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 15:05:23.898 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:70 - [응답 생성기] 응답 생성 시작 (타임아웃: 60초)
2025-04-22 15:05:23.899 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:05:23.899 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:05:23.906 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=60 socket_options=None
2025-04-22 15:05:23.908 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31c453f50>
2025-04-22 15:05:23.909 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 15:05:23.909 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:05:23.909 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 15:05:23.909 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:05:23.909 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 15:05:38.779 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:05:38 GMT'), (b'Transfer-Encoding', b'chunked')])
2025-04-22 15:05:38.780 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 15:05:38.780 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 15:05:38.780 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:05:38.780 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:05:38.781 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:05:38.781 | INFO     | app.core.llm_client:generate:72 - [Ollama 고성능] API 요청 시간: 14.88초
2025-04-22 15:05:38.781 | INFO     | app.core.llm_client:generate:78 - [Ollama 고성능] 전체 생성 시간: 14.88초
2025-04-22 15:05:38.781 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:05:38.782 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:05:38.782 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:72 - [응답 생성기] 응답 생성 완료: 2666자
2025-04-22 15:05:38.782 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:73 - [RESPONSE] Generated response: Okay, here’s a helpful response to someone asking about grade requirements for studying abroad in Korea:

“That’s fantastic! Studying in Korea is an amazing experience. The specific grades you’ll need depend heavily on the program you choose. Here's a breakdown of what’s generally required:

**1. University Exchange Programs (e.g., through your university):**

*   **Minimum GPA:** Usually, you’ll need a minimum GPA of **3.0 or higher** (on a 4.0 scale). Some universities may require a higher GPA, like 3.5 or even 3.7, especially for competitive programs.
*   **Major Requirements:**  You’ll almost certainly need to be in good standing in your major.  Check with your home university’s international education office for specific requirements related to your field of study.

**2. Private Language Academies & Intensive Programs:**

*   **Varies Greatly:** Requirements here are *much* more variable. Some academies focus on academic study and require a minimum GPA (often around 2.5 - 3.0). Others prioritize language learning and may have less stringent academic requirements.
*   **Entrance Exams:** Many academies require you to take an entrance exam to assess your Korean language ability.  Passing this exam is usually a key factor.

**3. Specific Program Requirements:**

*   **Check the Program Details:** *Always* carefully review the requirements listed on the website of the specific program you’re interested in. They will outline the exact GPA, language proficiency, and any other qualifications needed.

**Language Proficiency:**

*   **Korean Language Skills:** Regardless of the program, you’ll likely need a decent level of Korean. Many programs require a TOPIK (Test of Proficiency in Korean) score.  The minimum score will vary depending on the program's level. Expect to need at least TOPIK Level 3 or 4 for most programs.

**Resources to Explore:**

*   **Your University’s International Education Office:** They can provide guidance on programs available through your university.
*   **TOPIK Website:** [https://www.topik.toeic.net/](https://www.topik.toeic.net/) (for information on the TOPIK test)
*   **Study in Korea Website:** [https://studyinkorea.go.kr/](https://studyinkorea.go.kr/) (a great resource for finding programs and information)

**To help me give you more tailored advice, could you tell me:**

*   What is your current GPA?
*   What area of study are you interested in (e.g., Korean language, business, engineering)?
*   Are you looking to study through your university or with a private program?”

---

Would you like me to elaborate on any of these points, such as the different types of programs or the TOPIK test?"
2025-04-22 15:05:38.782 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 15:05:38.782 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Okay, here’s a helpful response to someone asking about grade requirements for studying abroad in Korea:

“That’s fantastic! Studying in Korea is an amazing experience. The specific grades you’ll need depend heavily on the program you choose. Here's a breakdown of what’s generally required:

**1. University Exchange Programs (e.g., through your university):**

*   **Minimum GPA:** Usually, you’ll need a minimum GPA of **3.0 or higher** (on a 4.0 scale). Some universities may require a higher GPA, like 3.5 or even 3.7, especially for competitive programs.
*   **Major Requirements:**  You’ll almost certainly need to be in good standing in your major.  Check with your home university’s international education office for specific requirements related to your field of study.

**2. Private Language Academies & Intensive Programs:**

*   **Varies Greatly:** Requirements here are *much* more variable. Some academies focus on academic study and require a minimum GPA (often around 2.5 - 3.0). Others prioritize language learning and may have less stringent academic requirements.
*   **Entrance Exams:** Many academies require you to take an entrance exam to assess your Korean language ability.  Passing this exam is usually a key factor.

**3. Specific Program Requirements:**

*   **Check the Program Details:** *Always* carefully review the requirements listed on the website of the specific program you’re interested in. They will outline the exact GPA, language proficiency, and any other qualifications needed.

**Language Proficiency:**

*   **Korean Language Skills:** Regardless of the program, you’ll likely need a decent level of Korean. Many programs require a TOPIK (Test of Proficiency in Korean) score.  The minimum score will vary depending on the program's level. Expect to need at least TOPIK Level 3 or 4 for most programs.

**Resources to Explore:**

*   **Your University’s International Education Office:** They can provide guidance on programs available through your university.
*   **TOPIK Website:** [https://www.topik.toeic.net/](https://www.topik.toeic.net/) (for information on the TOPIK test)
*   **Study in Korea Website:** [https://studyinkorea.go.kr/](https://studyinkorea.go.kr/) (a great resource for finding programs and information)

**To help me give you more tailored advice, could you tell me:**

*   What is your current GPA?
*   What area of study are you interested in (e.g., Korean language, business, engineering)?
*   Are you looking to study through your university or with a private program?”

---

Would you like me to elaborate on any of these points, such as the different types of programs or the TOPIK test?"'
2025-04-22 15:05:38.782 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 15:05:38.783 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: en, RAG type: daily_life
2025-04-22 15:05:38.783 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Okay, here’s a helpful response to someone asking about grade requirements for studying abroad in Korea:

“That’s fantastic! Studying in Korea is an amazing experience. The specific grades you’ll need depend heavily on the program you choose. Here's a breakdown of what’s generally required:

**1. University Exchange Programs (e.g., through your university):**

*   **Minimum GPA:** Usually, you’ll need a minimum GPA of **3.0 or higher** (on a 4.0 scale). Some universities may require a higher GPA, like 3.5 or even 3.7, especially for competitive programs.
*   **Major Requirements:**  You’ll almost certainly need to be in good standing in your major.  Check with your home university’s international education office for specific requirements related to your field of study.

**2. Private Language Academies & Intensive Programs:**

*   **Varies Greatly:** Requirements here are *much* more variable. Some academies focus on academic study and require a minimum GPA (often around 2.5 - 3.0). Others prioritize language learning and may have less stringent academic requirements.
*   **Entrance Exams:** Many academies require you to take an entrance exam to assess your Korean language ability.  Passing this exam is usually a key factor.

**3. Specific Program Requirements:**

*   **Check the Program Details:** *Always* carefully review the requirements listed on the website of the specific program you’re interested in. They will outline the exact GPA, language proficiency, and any other qualifications needed.

**Language Proficiency:**

*   **Korean Language Skills:** Regardless of the program, you’ll likely need a decent level of Korean. Many programs require a TOPIK (Test of Proficiency in Korean) score.  The minimum score will vary depending on the program's level. Expect to need at least TOPIK Level 3 or 4 for most programs.

**Resources to Explore:**

*   **Your University’s International Education Office:** They can provide guidance on programs available through your university.
*   **TOPIK Website:** [https://www.topik.toeic.net/](https://www.topik.toeic.net/) (for information on the TOPIK test)
*   **Study in Korea Website:** [https://studyinkorea.go.kr/](https://studyinkorea.go.kr/) (a great resource for finding programs and information)

**To help me give you more tailored advice, could you tell me:**

*   What is your current GPA?
*   What area of study are you interested in (e.g., Korean language, business, engineering)?
*   Are you looking to study through your university or with a private program?”

---

Would you like me to elaborate on any of these points, such as the different types of programs or the TOPIK test?"
2025-04-22 15:05:38.783 | INFO     | app.services.common.postprocessor:postprocess:67 - [POSTPROCESS] No translation needed (source language is English)
2025-04-22 15:05:38.783 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: True
2025-04-22 15:05:38.783 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 15:05:38.783 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: 'Okay, here’s a helpful response to someone asking about grade requirements for studying abroad in Korea:

“That’s fantastic! Studying in Korea is an amazing experience. The specific grades you’ll need depend heavily on the program you choose. Here's a breakdown of what’s generally required:

**1. University Exchange Programs (e.g., through your university):**

*   **Minimum GPA:** Usually, you’ll need a minimum GPA of **3.0 or higher** (on a 4.0 scale). Some universities may require a higher GPA, like 3.5 or even 3.7, especially for competitive programs.
*   **Major Requirements:**  You’ll almost certainly need to be in good standing in your major.  Check with your home university’s international education office for specific requirements related to your field of study.

**2. Private Language Academies & Intensive Programs:**

*   **Varies Greatly:** Requirements here are *much* more variable. Some academies focus on academic study and require a minimum GPA (often around 2.5 - 3.0). Others prioritize language learning and may have less stringent academic requirements.
*   **Entrance Exams:** Many academies require you to take an entrance exam to assess your Korean language ability.  Passing this exam is usually a key factor.

**3. Specific Program Requirements:**

*   **Check the Program Details:** *Always* carefully review the requirements listed on the website of the specific program you’re interested in. They will outline the exact GPA, language proficiency, and any other qualifications needed.

**Language Proficiency:**

*   **Korean Language Skills:** Regardless of the program, you’ll likely need a decent level of Korean. Many programs require a TOPIK (Test of Proficiency in Korean) score.  The minimum score will vary depending on the program's level. Expect to need at least TOPIK Level 3 or 4 for most programs.

**Resources to Explore:**

*   **Your University’s International Education Office:** They can provide guidance on programs available through your university.
*   **TOPIK Website:** [https://www.topik.toeic.net/](https://www.topik.toeic.net/) (for information on the TOPIK test)
*   **Study in Korea Website:** [https://studyinkorea.go.kr/](https://studyinkorea.go.kr/) (a great resource for finding programs and information)

**To help me give you more tailored advice, could you tell me:**

*   What is your current GPA?
*   What area of study are you interested in (e.g., Korean language, business, engineering)?
*   Are you looking to study through your university or with a private program?”

---

Would you like me to elaborate on any of these points, such as the different types of programs or the TOPIK test?"'
2025-04-22 15:05:38.783 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 15:06:24.307 | INFO     | app.core.llm_client:__init__:30 - [OllamaClient] 경량 모델 초기화 완료: URL=http://localhost:11434, MODEL=gemma3:4b, TIMEOUT=20초
2025-04-22 15:06:24.310 | INFO     | app.services.chatbot.chatbot_classifier:__init__:27 - [분류] 경량 모델 사용: gemma3:4b
2025-04-22 15:06:24.311 | INFO     | logging:callHandlers:1762 - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 15:06:24.611 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 15:06:24.813 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config_sentence_transformers.json HTTP/1.1" 200 0
2025-04-22 15:06:25.064 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/README.md HTTP/1.1" 200 0
2025-04-22 15:06:25.267 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/modules.json HTTP/1.1" 200 0
2025-04-22 15:06:25.470 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/sentence_bert_config.json HTTP/1.1" 200 0
2025-04-22 15:06:26.000 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/config.json HTTP/1.1" 200 0
2025-04-22 15:06:26.749 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "HEAD /sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-04-22 15:06:27.432 | DEBUG    | logging:callHandlers:1762 - https://huggingface.co:443 "GET /api/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2/revision/main HTTP/1.1" 200 6115
2025-04-22 15:06:27.438 | INFO     | logging:callHandlers:1762 - Use pytorch device_name: mps
2025-04-22 15:06:27.869 | INFO     | app.services.common.rag_service:__init__:15 - [RAG] 임베딩 모델 사용: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2025-04-22 15:06:27.876 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] visa_law 도메인 초기화 완료: data/vectorstore1
2025-04-22 15:06:27.877 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] social_security 도메인 초기화 완료: data/vectorstore2
2025-04-22 15:06:27.879 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] tax_finance 도메인 초기화 완료: data/vectorstore3
2025-04-22 15:06:27.882 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] medical_health 도메인 초기화 완료: data/vectorstore4
2025-04-22 15:06:27.884 | INFO     | app.services.common.rag_service:__init__:36 - [RAG] employment 도메인 초기화 완료: data/vectorstore5
2025-04-22 15:06:27.886 | ERROR    | app.services.common.rag_service:__init__:38 - [RAG] daily_life 도메인 초기화 중 오류 발생: no such column: collections.topic
2025-04-22 15:06:27.886 | INFO     | app.core.llm_client:__init__:35 - [OllamaClient] 고성능 모델 초기화 완료: URL=http://localhost:11434, MODEL=gemma3:4b, TIMEOUT=60초
2025-04-22 15:06:27.886 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:17 - [응답 생성기] 고성능 모델 사용: gemma3:4b, 타임아웃: 60초
2025-04-22 15:06:27.886 | INFO     | app.services.chatbot.chatbot_response_generator:__init__:19 - [응답 생성기] 디바이스: cpu
2025-04-22 15:06:27.886 | INFO     | app.core.llm_client:__init__:30 - [OllamaClient] 경량 모델 초기화 완료: URL=http://localhost:11434, MODEL=gemma3:4b, TIMEOUT=20초
2025-04-22 15:06:27.886 | INFO     | app.services.common.postprocessor:__init__:28 - [Postprocess] Using lightweight model: gemma3:4b
2025-04-22 15:06:27.886 | INFO     | app.services.chatbot.chatbot:__init__:15 - [챗봇] 초기화 완료
2025-04-22 15:06:27.886 | INFO     | app.services.chatbot.chatbot:get_response:20 - [WORKFLOW] ====== Starting chatbot workflow for user user_id ======
2025-04-22 15:06:27.886 | INFO     | app.services.chatbot.chatbot:get_response:21 - [WORKFLOW] Original query: Quiero estudiar en el extranjero en Corea. Por favor, dígame qué calificaciones y titulaciones necesito.
2025-04-22 15:06:27.886 | INFO     | app.services.chatbot.chatbot_classifier:classify:40 - [분류] 질의 분류 시작: Quiero estudiar en el extranjero en Corea. Por favor, dígame qué calificaciones y titulaciones necesito.
2025-04-22 15:06:27.886 | INFO     | app.services.chatbot.chatbot_classifier:classify:44 - [분류] 질의 유형: general
2025-04-22 15:06:27.887 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:06:27.887 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:06:27.894 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=20 socket_options=None
2025-04-22 15:06:27.895 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31c4d3140>
2025-04-22 15:06:27.896 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 15:06:27.896 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:06:27.896 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 15:06:27.896 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:06:27.896 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 15:06:28.117 | DEBUG    | logging:callHandlers:1762 - https://us.i.posthog.com:443 "POST /batch/ HTTP/1.1" 200 15
2025-04-22 15:06:29.575 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:06:29 GMT'), (b'Content-Length', b'1028')])
2025-04-22 15:06:29.576 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 15:06:29.576 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 15:06:29.576 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:06:29.577 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:06:29.577 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:06:29.577 | INFO     | app.core.llm_client:generate:72 - [Ollama 경량] API 요청 시간: 1.68초
2025-04-22 15:06:29.578 | INFO     | app.core.llm_client:generate:78 - [Ollama 경량] 전체 생성 시간: 1.69초
2025-04-22 15:06:29.578 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:06:29.578 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:06:29.578 | INFO     | app.services.chatbot.chatbot_classifier:classify:48 - [분류] RAG 유형: none
2025-04-22 15:06:29.578 | INFO     | app.services.chatbot.chatbot:get_response:25 - [챗봇] 분류 완료 - 질의 유형: general, RAG 유형: none
2025-04-22 15:06:29.579 | INFO     | app.services.chatbot.chatbot:get_response:26 - [WORKFLOW] Query classified as general, RAG type: none
2025-04-22 15:06:29.579 | INFO     | app.services.chatbot.chatbot:get_response:29 - [WORKFLOW] Step 1: Preprocessing (language detection and translation)
2025-04-22 15:06:29.579 | INFO     | app.services.common.preprocessor:translate_query:41 - [PREPROCESS] Original query: Quiero estudiar en el extranjero en Corea. Por favor, dígame qué calificaciones y titulaciones necesito.
2025-04-22 15:06:29.579 | INFO     | app.core.llm_client:__init__:30 - [OllamaClient] 경량 모델 초기화 완료: URL=http://localhost:11434, MODEL=gemma3:4b, TIMEOUT=20초
2025-04-22 15:06:29.579 | INFO     | app.services.common.preprocessor:translate_query:47 - [Preprocess] Client initialization time: 0.00 seconds
2025-04-22 15:06:29.579 | INFO     | app.services.common.preprocessor:translate_query:48 - [Preprocess] Model used: gemma3:4b
2025-04-22 15:06:29.580 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:06:29.581 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:06:29.591 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=20 socket_options=None
2025-04-22 15:06:29.593 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31a1dbdd0>
2025-04-22 15:06:29.593 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'GET']>
2025-04-22 15:06:29.593 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:06:29.593 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'GET']>
2025-04-22 15:06:29.593 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:06:29.593 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'GET']>
2025-04-22 15:06:29.595 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:06:29 GMT'), (b'Content-Length', b'1335')])
2025-04-22 15:06:29.595 | INFO     | logging:callHandlers:1762 - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-04-22 15:06:29.595 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'GET']>
2025-04-22 15:06:29.595 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:06:29.595 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:06:29.595 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:06:29.595 | INFO     | app.core.llm_client:check_connection:48 - [Ollama 경량] 연결 확인 시간: 0.02초
2025-04-22 15:06:29.595 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:06:29.595 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:06:29.595 | INFO     | app.services.common.preprocessor:translate_query:55 - [Preprocess] Server connection check time: 0.02 seconds
2025-04-22 15:06:29.596 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:06:29.596 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:06:29.603 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=20 socket_options=None
2025-04-22 15:06:29.605 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31c4f9ee0>
2025-04-22 15:06:29.605 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 15:06:29.605 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:06:29.605 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 15:06:29.605 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:06:29.605 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 15:06:30.860 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:06:30 GMT'), (b'Content-Length', b'1102')])
2025-04-22 15:06:30.861 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 15:06:30.861 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 15:06:30.862 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:06:30.862 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:06:30.862 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:06:30.862 | INFO     | app.core.llm_client:generate:72 - [Ollama 경량] API 요청 시간: 1.26초
2025-04-22 15:06:30.862 | INFO     | app.core.llm_client:generate:78 - [Ollama 경량] 전체 생성 시간: 1.27초
2025-04-22 15:06:30.863 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:06:30.863 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:06:30.863 | INFO     | app.services.common.preprocessor:translate_query:63 - [Preprocess] LLM generation time: 1.27 seconds
2025-04-22 15:06:30.863 | DEBUG    | app.services.common.preprocessor:translate_query:68 - [Preprocess] Translation response: {
  "translated_query": "I want to study in Korea abroad. Please tell me what grades and qualifications I need.",
  "lang_code": "es"
}
2025-04-22 15:06:30.863 | INFO     | app.services.common.preprocessor:translate_query:72 - [Preprocess] JSON parsing time: 0.00 seconds
2025-04-22 15:06:30.863 | INFO     | app.services.common.preprocessor:translate_query:75 - [PREPROCESS] Translated query: I want to study in Korea abroad. Please tell me what grades and qualifications I need.
2025-04-22 15:06:30.863 | INFO     | app.services.common.preprocessor:translate_query:76 - [PREPROCESS] Detected language: es
2025-04-22 15:06:30.864 | INFO     | app.services.common.preprocessor:translate_query:79 - [Preprocess] Total execution time: 1.28 seconds
2025-04-22 15:06:30.864 | INFO     | app.services.chatbot.chatbot:get_response:33 - [챗봇] 언어 감지 완료 - 소스 언어: es, 영어 번역: I want to study in Korea abroad. Please tell me what grades and qualifications I need.
2025-04-22 15:06:30.864 | INFO     | app.services.chatbot.chatbot:get_response:34 - [WORKFLOW] Preprocessing complete: source_lang=es, english_query='I want to study in Korea abroad. Please tell me what grades and qualifications I need.'
2025-04-22 15:06:30.864 | INFO     | app.services.chatbot.chatbot:get_response:37 - [WORKFLOW] Step 2: Response generation
2025-04-22 15:06:30.864 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:34 - [RESPONSE] Input query (English): I want to study in Korea abroad. Please tell me what grades and qualifications I need.
2025-04-22 15:06:30.864 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:35 - [RESPONSE] Query type: general
2025-04-22 15:06:30.864 | INFO     | app.services.chatbot.chatbot_response_generator:generate_response:36 - [RESPONSE] RAG type: none
2025-04-22 15:06:30.864 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:66 - [응답 생성기] 프롬프트 생성 완료
2025-04-22 15:06:30.865 | DEBUG    | app.services.chatbot.chatbot_response_generator:_generate_general_response:67 - [RESPONSE] Generated prompt: 
        Please provide a helpful response to the following query:
        Query: I want to study in Korea abroad. Please tell me what grades and qualifications I need.
        
        
        Please provide a clear and concise response in English.
        
2025-04-22 15:06:30.865 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:70 - [응답 생성기] 응답 생성 시작 (타임아웃: 60초)
2025-04-22 15:06:30.865 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:06:30.866 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:06:30.873 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=60 socket_options=None
2025-04-22 15:06:30.876 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31a11ab10>
2025-04-22 15:06:30.876 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 15:06:30.876 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:06:30.876 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 15:06:30.876 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:06:30.876 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 15:06:45.626 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:06:45 GMT'), (b'Transfer-Encoding', b'chunked')])
2025-04-22 15:06:45.627 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 15:06:45.627 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 15:06:45.628 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:06:45.628 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:06:45.628 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:06:45.628 | INFO     | app.core.llm_client:generate:72 - [Ollama 고성능] API 요청 시간: 14.76초
2025-04-22 15:06:45.629 | INFO     | app.core.llm_client:generate:78 - [Ollama 고성능] 전체 생성 시간: 14.76초
2025-04-22 15:06:45.629 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:06:45.629 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:06:45.629 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:72 - [응답 생성기] 응답 생성 완료: 2889자
2025-04-22 15:06:45.629 | INFO     | app.services.chatbot.chatbot_response_generator:_generate_general_response:73 - [RESPONSE] Generated response: Okay, here’s a breakdown of what you need to study in Korea abroad, focusing on the most common pathways:

**1. Undergraduate Studies (Bachelor's Degree):**

* **High School Diploma:** You’ll need a high school diploma from a recognized educational institution.
* **Minimum GPA:** Generally, a GPA of 60% or higher is required. Some universities are more competitive and may require 70% or higher.
* **TOPIK (Test of Proficiency in Korean):** This is *essential*. The level you need depends on the university and program.
    * **TOPIK Level 3 or 4:**  This is generally the minimum required for most undergraduate programs.
    * **TOPIK Level 5 or 6:**  Needed for more competitive programs, particularly in prestigious universities.
* **English Proficiency Test (e.g., TOEFL or IELTS):**  While not always required, many universities, especially those offering English-taught programs, will also require proof of English language proficiency.
* **Specific Program Requirements:** Each university and program will have its own specific requirements, such as subject prerequisites, portfolio requirements (for art or design programs), or specific entrance exams.

**2. Postgraduate Studies (Master's or Doctoral Degrees):**

* **Bachelor's Degree:**  A bachelor’s degree is mandatory.
* **GPA:** Generally, a GPA of 70% or higher is required.
* **TOPIK:**  Level 3 or 4 is often the minimum, but higher levels are strongly recommended, particularly for doctoral programs.
* **GRE (Graduate Record Examinations):** Many universities require the GRE, especially for competitive programs. Check the specific university's requirements.
* **Specific Program Requirements:** Similar to undergraduate programs, each program will have its own specific requirements.


**Key Resources & Websites:**

* **Study in Korea:** [https://studyinkorea.go.kr/](https://studyinkorea.go.kr/) - This is the official website of the Korean government for international students.  It's the best place to start and find detailed information on visa requirements, scholarships, and university programs.
* **University Websites:** Once you identify universities you're interested in, visit their international student websites for specific program details and admission requirements. (e.g., Seoul National University, Korea University, Yonsei University, etc.)

**Important Notes:**

* **Visa Requirements:** You’ll need a student visa to study in Korea.  The Study in Korea website has information on the application process.
* **Scholarships:** Explore scholarship opportunities through Study in Korea and individual universities.

**To help me give you more tailored advice, could you tell me:**

*   What level of education are you interested in (undergraduate, postgraduate)?
*   What field of study are you considering?
*   What is your current educational background (high school diploma, university degree)?
2025-04-22 15:06:45.630 | INFO     | app.services.chatbot.chatbot:get_response:39 - [챗봇] 응답 생성 완료
2025-04-22 15:06:45.630 | INFO     | app.services.chatbot.chatbot:get_response:40 - [WORKFLOW] Response generation complete: 'Okay, here’s a breakdown of what you need to study in Korea abroad, focusing on the most common pathways:

**1. Undergraduate Studies (Bachelor's Degree):**

* **High School Diploma:** You’ll need a high school diploma from a recognized educational institution.
* **Minimum GPA:** Generally, a GPA of 60% or higher is required. Some universities are more competitive and may require 70% or higher.
* **TOPIK (Test of Proficiency in Korean):** This is *essential*. The level you need depends on the university and program.
    * **TOPIK Level 3 or 4:**  This is generally the minimum required for most undergraduate programs.
    * **TOPIK Level 5 or 6:**  Needed for more competitive programs, particularly in prestigious universities.
* **English Proficiency Test (e.g., TOEFL or IELTS):**  While not always required, many universities, especially those offering English-taught programs, will also require proof of English language proficiency.
* **Specific Program Requirements:** Each university and program will have its own specific requirements, such as subject prerequisites, portfolio requirements (for art or design programs), or specific entrance exams.

**2. Postgraduate Studies (Master's or Doctoral Degrees):**

* **Bachelor's Degree:**  A bachelor’s degree is mandatory.
* **GPA:** Generally, a GPA of 70% or higher is required.
* **TOPIK:**  Level 3 or 4 is often the minimum, but higher levels are strongly recommended, particularly for doctoral programs.
* **GRE (Graduate Record Examinations):** Many universities require the GRE, especially for competitive programs. Check the specific university's requirements.
* **Specific Program Requirements:** Similar to undergraduate programs, each program will have its own specific requirements.


**Key Resources & Websites:**

* **Study in Korea:** [https://studyinkorea.go.kr/](https://studyinkorea.go.kr/) - This is the official website of the Korean government for international students.  It's the best place to start and find detailed information on visa requirements, scholarships, and university programs.
* **University Websites:** Once you identify universities you're interested in, visit their international student websites for specific program details and admission requirements. (e.g., Seoul National University, Korea University, Yonsei University, etc.)

**Important Notes:**

* **Visa Requirements:** You’ll need a student visa to study in Korea.  The Study in Korea website has information on the application process.
* **Scholarships:** Explore scholarship opportunities through Study in Korea and individual universities.

**To help me give you more tailored advice, could you tell me:**

*   What level of education are you interested in (undergraduate, postgraduate)?
*   What field of study are you considering?
*   What is your current educational background (high school diploma, university degree)?'
2025-04-22 15:06:45.630 | INFO     | app.services.chatbot.chatbot:get_response:43 - [WORKFLOW] Step 3: Postprocessing (translation back to original language)
2025-04-22 15:06:45.630 | INFO     | app.services.common.postprocessor:postprocess:43 - [Postprocess] Starting response post-processing - Source language: es, RAG type: none
2025-04-22 15:06:45.630 | INFO     | app.services.common.postprocessor:postprocess:44 - [POSTPROCESS] Input English response: Okay, here’s a breakdown of what you need to study in Korea abroad, focusing on the most common pathways:

**1. Undergraduate Studies (Bachelor's Degree):**

* **High School Diploma:** You’ll need a high school diploma from a recognized educational institution.
* **Minimum GPA:** Generally, a GPA of 60% or higher is required. Some universities are more competitive and may require 70% or higher.
* **TOPIK (Test of Proficiency in Korean):** This is *essential*. The level you need depends on the university and program.
    * **TOPIK Level 3 or 4:**  This is generally the minimum required for most undergraduate programs.
    * **TOPIK Level 5 or 6:**  Needed for more competitive programs, particularly in prestigious universities.
* **English Proficiency Test (e.g., TOEFL or IELTS):**  While not always required, many universities, especially those offering English-taught programs, will also require proof of English language proficiency.
* **Specific Program Requirements:** Each university and program will have its own specific requirements, such as subject prerequisites, portfolio requirements (for art or design programs), or specific entrance exams.

**2. Postgraduate Studies (Master's or Doctoral Degrees):**

* **Bachelor's Degree:**  A bachelor’s degree is mandatory.
* **GPA:** Generally, a GPA of 70% or higher is required.
* **TOPIK:**  Level 3 or 4 is often the minimum, but higher levels are strongly recommended, particularly for doctoral programs.
* **GRE (Graduate Record Examinations):** Many universities require the GRE, especially for competitive programs. Check the specific university's requirements.
* **Specific Program Requirements:** Similar to undergraduate programs, each program will have its own specific requirements.


**Key Resources & Websites:**

* **Study in Korea:** [https://studyinkorea.go.kr/](https://studyinkorea.go.kr/) - This is the official website of the Korean government for international students.  It's the best place to start and find detailed information on visa requirements, scholarships, and university programs.
* **University Websites:** Once you identify universities you're interested in, visit their international student websites for specific program details and admission requirements. (e.g., Seoul National University, Korea University, Yonsei University, etc.)

**Important Notes:**

* **Visa Requirements:** You’ll need a student visa to study in Korea.  The Study in Korea website has information on the application process.
* **Scholarships:** Explore scholarship opportunities through Study in Korea and individual universities.

**To help me give you more tailored advice, could you tell me:**

*   What level of education are you interested in (undergraduate, postgraduate)?
*   What field of study are you considering?
*   What is your current educational background (high school diploma, university degree)?
2025-04-22 15:06:45.630 | INFO     | app.services.common.postprocessor:postprocess:50 - [Postprocess] Translating to Spanish (code: es)
2025-04-22 15:06:45.631 | DEBUG    | app.services.common.postprocessor:postprocess:61 - [POSTPROCESS] Translation prompt: 
                Translate the following English text to Spanish. 
                Keep the meaning and tone exactly the same.
                Only return the translated text without any additional explanation.
                
                Text to translate:
                Okay, here’s a breakdown of what you need to study in Korea abroad, focusing on the most common pathways:

**1. Undergraduate Studies (Bachelor's Degree):**

* **High School Diploma:** You’ll need a high school diploma from a recognized educational institution.
* **Minimum GPA:** Generally, a GPA of 60% or higher is required. Some universities are more competitive and may require 70% or higher.
* **TOPIK (Test of Proficiency in Korean):** This is *essential*. The level you need depends on the university and program.
    * **TOPIK Level 3 or 4:**  This is generally the minimum required for most undergraduate programs.
    * **TOPIK Level 5 or 6:**  Needed for more competitive programs, particularly in prestigious universities.
* **English Proficiency Test (e.g., TOEFL or IELTS):**  While not always required, many universities, especially those offering English-taught programs, will also require proof of English language proficiency.
* **Specific Program Requirements:** Each university and program will have its own specific requirements, such as subject prerequisites, portfolio requirements (for art or design programs), or specific entrance exams.

**2. Postgraduate Studies (Master's or Doctoral Degrees):**

* **Bachelor's Degree:**  A bachelor’s degree is mandatory.
* **GPA:** Generally, a GPA of 70% or higher is required.
* **TOPIK:**  Level 3 or 4 is often the minimum, but higher levels are strongly recommended, particularly for doctoral programs.
* **GRE (Graduate Record Examinations):** Many universities require the GRE, especially for competitive programs. Check the specific university's requirements.
* **Specific Program Requirements:** Similar to undergraduate programs, each program will have its own specific requirements.


**Key Resources & Websites:**

* **Study in Korea:** [https://studyinkorea.go.kr/](https://studyinkorea.go.kr/) - This is the official website of the Korean government for international students.  It's the best place to start and find detailed information on visa requirements, scholarships, and university programs.
* **University Websites:** Once you identify universities you're interested in, visit their international student websites for specific program details and admission requirements. (e.g., Seoul National University, Korea University, Yonsei University, etc.)

**Important Notes:**

* **Visa Requirements:** You’ll need a student visa to study in Korea.  The Study in Korea website has information on the application process.
* **Scholarships:** Explore scholarship opportunities through Study in Korea and individual universities.

**To help me give you more tailored advice, could you tell me:**

*   What level of education are you interested in (undergraduate, postgraduate)?
*   What field of study are you considering?
*   What is your current educational background (high school diploma, university degree)?
                
2025-04-22 15:06:45.631 | DEBUG    | logging:callHandlers:1762 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-04-22 15:06:45.632 | DEBUG    | logging:callHandlers:1762 - load_verify_locations cafile='/Users/songkyubeen/Desktop/FinalProject/eum-chatbot/.venv/lib/python3.12/site-packages/certifi/cacert.pem'
2025-04-22 15:06:45.646 | DEBUG    | logging:callHandlers:1762 - connect_tcp.started host='localhost' port=11434 local_address=None timeout=20 socket_options=None
2025-04-22 15:06:45.647 | DEBUG    | logging:callHandlers:1762 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x31c426210>
2025-04-22 15:06:45.647 | DEBUG    | logging:callHandlers:1762 - send_request_headers.started request=<Request [b'POST']>
2025-04-22 15:06:45.648 | DEBUG    | logging:callHandlers:1762 - send_request_headers.complete
2025-04-22 15:06:45.648 | DEBUG    | logging:callHandlers:1762 - send_request_body.started request=<Request [b'POST']>
2025-04-22 15:06:45.648 | DEBUG    | logging:callHandlers:1762 - send_request_body.complete
2025-04-22 15:06:45.648 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.started request=<Request [b'POST']>
2025-04-22 15:07:05.436 | DEBUG    | logging:callHandlers:1762 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Content-Type', b'application/json; charset=utf-8'), (b'Date', b'Tue, 22 Apr 2025 06:07:05 GMT'), (b'Transfer-Encoding', b'chunked')])
2025-04-22 15:07:05.437 | INFO     | logging:callHandlers:1762 - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-22 15:07:05.438 | DEBUG    | logging:callHandlers:1762 - receive_response_body.started request=<Request [b'POST']>
2025-04-22 15:07:05.438 | DEBUG    | logging:callHandlers:1762 - receive_response_body.complete
2025-04-22 15:07:05.438 | DEBUG    | logging:callHandlers:1762 - response_closed.started
2025-04-22 15:07:05.438 | DEBUG    | logging:callHandlers:1762 - response_closed.complete
2025-04-22 15:07:05.438 | INFO     | app.core.llm_client:generate:72 - [Ollama 경량] API 요청 시간: 19.79초
2025-04-22 15:07:05.439 | INFO     | app.core.llm_client:generate:78 - [Ollama 경량] 전체 생성 시간: 19.81초
2025-04-22 15:07:05.439 | DEBUG    | logging:callHandlers:1762 - close.started
2025-04-22 15:07:05.439 | DEBUG    | logging:callHandlers:1762 - close.complete
2025-04-22 15:07:05.441 | INFO     | app.services.common.postprocessor:postprocess:64 - [Postprocess] Translation completed: Okay, aquí tienes un desglose de lo que necesitas estudiar en Corea del Sur en el extranjero, centrándonos en las vías más comunes:

**1. Estudios de Grado (Licenciatura):**

*   **Diploma de Bachillerato:** Necesitarás un diploma de bachillerato de una institución educativa reconocida.
*   **GPA Mínimo:** Generalmente, se requiere un GPA de 60% o superior. Algunas universidades son más competitivas y pueden requerir 70% o superior.
*   **TOPIK (Test de Competencia en Coreano):** Esto es *esencial*. El nivel que necesitas depende de la universidad y el programa.
    *   **TOPIK Nivel 3 o 4:** Este es generalmente el mínimo requerido para la mayoría de los programas de licenciatura.
    *   **TOPIK Nivel 5 o 6:** Necesario para programas más competitivos, particularmente en universidades prestigiosas.
*   **Prueba de Competencia en Inglés (p. ej., TOEFL o IELTS):** Si bien no siempre es necesario, muchas universidades, especialmente aquellas que ofrecen programas impartidos en inglés, también requerirán pruebas de competencia en inglés.
*   **Requisitos Específicos del Programa:** Cada universidad y programa tendrá sus propios requisitos específicos, como requisitos de asignaturas previas, requisitos de portafolio (para programas de arte o diseño) o exámenes de admisión específicos.

**2. Estudios de Postgrado (Máster o Doctorado):**

*   **Título de Grado:** Un título de grado es obligatorio.
*   **GPA:** Generalmente, se requiere un GPA de 70% o superior.
*   **TOPIK:** El Nivel 3 o 4 es a menudo el mínimo, pero los niveles más altos se recomiendan encarecidamente, particularmente para programas de doctorado.
*   **GRE (Exámenes de Registro de Estudios de Posgrado):** Muchas universidades requieren el GRE, especialmente para programas competitivos. Consulta los requisitos específicos de cada universidad.
*   **Requisitos Específicos del Programa:** Similar a los programas de grado, cada programa tendrá sus propios requisitos específicos.

**Recursos y Sitios Web Clave:**

*   **Study in Korea:** [https://studyinkorea.go.kr/](https://studyinkorea.go.kr/) - Este es el sitio web oficial del gobierno coreano para estudiantes internacionales. Es el mejor lugar para comenzar y encontrar información detallada sobre los requisitos de visado, becas y programas universitarios.
*   **Sitios Web de Universidades:** Una vez que identifiques universidades que te interesan, visita sus sitios web para estudiantes internacionales para obtener detalles específicos del programa y requisitos de admisión. (p. ej., Universidad Nacional de Seúl, Universidad Korea, Universidad Yonsei, etc.)

**Notas Importantes:**

*   **Requisitos de Visado:** Necesitarás un visado de estudiante para estudiar en Corea. El sitio web de Study in Korea tiene información sobre el proceso de solicitud.
*   **Becas:** Explora las oportunidades de becas a través de Study in Korea e instituciones individuales.

**Para ayudarme a darte consejos más adaptados, ¿podrías decirme:**

*   ¿Qué nivel de educación estás interesado en (grado, posgrado)?
*   ¿Qué campo de estudio estás considerando?
*   ¿Cuál es tu historial educativo actual (diploma de bachillerato, título universitario)?
2025-04-22 15:07:05.441 | INFO     | app.services.common.postprocessor:postprocess:65 - [POSTPROCESS] Translated response (Spanish): Okay, aquí tienes un desglose de lo que necesitas estudiar en Corea del Sur en el extranjero, centrándonos en las vías más comunes:

**1. Estudios de Grado (Licenciatura):**

*   **Diploma de Bachillerato:** Necesitarás un diploma de bachillerato de una institución educativa reconocida.
*   **GPA Mínimo:** Generalmente, se requiere un GPA de 60% o superior. Algunas universidades son más competitivas y pueden requerir 70% o superior.
*   **TOPIK (Test de Competencia en Coreano):** Esto es *esencial*. El nivel que necesitas depende de la universidad y el programa.
    *   **TOPIK Nivel 3 o 4:** Este es generalmente el mínimo requerido para la mayoría de los programas de licenciatura.
    *   **TOPIK Nivel 5 o 6:** Necesario para programas más competitivos, particularmente en universidades prestigiosas.
*   **Prueba de Competencia en Inglés (p. ej., TOEFL o IELTS):** Si bien no siempre es necesario, muchas universidades, especialmente aquellas que ofrecen programas impartidos en inglés, también requerirán pruebas de competencia en inglés.
*   **Requisitos Específicos del Programa:** Cada universidad y programa tendrá sus propios requisitos específicos, como requisitos de asignaturas previas, requisitos de portafolio (para programas de arte o diseño) o exámenes de admisión específicos.

**2. Estudios de Postgrado (Máster o Doctorado):**

*   **Título de Grado:** Un título de grado es obligatorio.
*   **GPA:** Generalmente, se requiere un GPA de 70% o superior.
*   **TOPIK:** El Nivel 3 o 4 es a menudo el mínimo, pero los niveles más altos se recomiendan encarecidamente, particularmente para programas de doctorado.
*   **GRE (Exámenes de Registro de Estudios de Posgrado):** Muchas universidades requieren el GRE, especialmente para programas competitivos. Consulta los requisitos específicos de cada universidad.
*   **Requisitos Específicos del Programa:** Similar a los programas de grado, cada programa tendrá sus propios requisitos específicos.

**Recursos y Sitios Web Clave:**

*   **Study in Korea:** [https://studyinkorea.go.kr/](https://studyinkorea.go.kr/) - Este es el sitio web oficial del gobierno coreano para estudiantes internacionales. Es el mejor lugar para comenzar y encontrar información detallada sobre los requisitos de visado, becas y programas universitarios.
*   **Sitios Web de Universidades:** Una vez que identifiques universidades que te interesan, visita sus sitios web para estudiantes internacionales para obtener detalles específicos del programa y requisitos de admisión. (p. ej., Universidad Nacional de Seúl, Universidad Korea, Universidad Yonsei, etc.)

**Notas Importantes:**

*   **Requisitos de Visado:** Necesitarás un visado de estudiante para estudiar en Corea. El sitio web de Study in Korea tiene información sobre el proceso de solicitud.
*   **Becas:** Explora las oportunidades de becas a través de Study in Korea e instituciones individuales.

**Para ayudarme a darte consejos más adaptados, ¿podrías decirme:**

*   ¿Qué nivel de educación estás interesado en (grado, posgrado)?
*   ¿Qué campo de estudio estás considerando?
*   ¿Cuál es tu historial educativo actual (diploma de bachillerato, título universitario)?
2025-04-22 15:07:05.441 | INFO     | app.services.common.postprocessor:postprocess:72 - [POSTPROCESS] RAG was used: False
2025-04-22 15:07:05.441 | INFO     | app.services.chatbot.chatbot:get_response:45 - [챗봇] 후처리 완료
2025-04-22 15:07:05.441 | INFO     | app.services.chatbot.chatbot:get_response:46 - [WORKFLOW] Postprocessing complete: 'Okay, aquí tienes un desglose de lo que necesitas estudiar en Corea del Sur en el extranjero, centrándonos en las vías más comunes:

**1. Estudios de Grado (Licenciatura):**

*   **Diploma de Bachillerato:** Necesitarás un diploma de bachillerato de una institución educativa reconocida.
*   **GPA Mínimo:** Generalmente, se requiere un GPA de 60% o superior. Algunas universidades son más competitivas y pueden requerir 70% o superior.
*   **TOPIK (Test de Competencia en Coreano):** Esto es *esencial*. El nivel que necesitas depende de la universidad y el programa.
    *   **TOPIK Nivel 3 o 4:** Este es generalmente el mínimo requerido para la mayoría de los programas de licenciatura.
    *   **TOPIK Nivel 5 o 6:** Necesario para programas más competitivos, particularmente en universidades prestigiosas.
*   **Prueba de Competencia en Inglés (p. ej., TOEFL o IELTS):** Si bien no siempre es necesario, muchas universidades, especialmente aquellas que ofrecen programas impartidos en inglés, también requerirán pruebas de competencia en inglés.
*   **Requisitos Específicos del Programa:** Cada universidad y programa tendrá sus propios requisitos específicos, como requisitos de asignaturas previas, requisitos de portafolio (para programas de arte o diseño) o exámenes de admisión específicos.

**2. Estudios de Postgrado (Máster o Doctorado):**

*   **Título de Grado:** Un título de grado es obligatorio.
*   **GPA:** Generalmente, se requiere un GPA de 70% o superior.
*   **TOPIK:** El Nivel 3 o 4 es a menudo el mínimo, pero los niveles más altos se recomiendan encarecidamente, particularmente para programas de doctorado.
*   **GRE (Exámenes de Registro de Estudios de Posgrado):** Muchas universidades requieren el GRE, especialmente para programas competitivos. Consulta los requisitos específicos de cada universidad.
*   **Requisitos Específicos del Programa:** Similar a los programas de grado, cada programa tendrá sus propios requisitos específicos.

**Recursos y Sitios Web Clave:**

*   **Study in Korea:** [https://studyinkorea.go.kr/](https://studyinkorea.go.kr/) - Este es el sitio web oficial del gobierno coreano para estudiantes internacionales. Es el mejor lugar para comenzar y encontrar información detallada sobre los requisitos de visado, becas y programas universitarios.
*   **Sitios Web de Universidades:** Una vez que identifiques universidades que te interesan, visita sus sitios web para estudiantes internacionales para obtener detalles específicos del programa y requisitos de admisión. (p. ej., Universidad Nacional de Seúl, Universidad Korea, Universidad Yonsei, etc.)

**Notas Importantes:**

*   **Requisitos de Visado:** Necesitarás un visado de estudiante para estudiar en Corea. El sitio web de Study in Korea tiene información sobre el proceso de solicitud.
*   **Becas:** Explora las oportunidades de becas a través de Study in Korea e instituciones individuales.

**Para ayudarme a darte consejos más adaptados, ¿podrías decirme:**

*   ¿Qué nivel de educación estás interesado en (grado, posgrado)?
*   ¿Qué campo de estudio estás considerando?
*   ¿Cuál es tu historial educativo actual (diploma de bachillerato, título universitario)?'
2025-04-22 15:07:05.442 | INFO     | app.services.chatbot.chatbot:get_response:61 - [WORKFLOW] ====== Chatbot workflow completed for user user_id ======
2025-04-22 15:24:03.642 | INFO     | app.main:shutdown_event:37 - [WORKFLOW] Server shutting down
2025-04-22 15:24:07.299 | INFO     | app.main:<module>:10 - Application starting up...
2025-04-22 15:24:07.300 | INFO     | app.main:startup_event:33 - [WORKFLOW] Server started successfully
